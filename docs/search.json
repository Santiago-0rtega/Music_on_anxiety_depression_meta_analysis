[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Music_meta_book",
    "section": "",
    "text": "Index\nThis is the only supplementary material for the study: Effects of music on anxiety- and depression-like behaviours in lab rodents",
    "crumbs": [
      "Index"
    ]
  },
  {
    "objectID": "lnRR.html",
    "href": "lnRR.html",
    "title": "Estimating effect sizes",
    "section": "",
    "text": "lnRR Effect Size Calculation Function\nThis function, calculate_lnRR(), is designed to calculate the Log Response Ratio (\\(\\text{lnRR}\\)) and its variance (\\(\\text{lnRR_var}\\)) for both continuous and percentage data, accounting for dependent (correlated) and independent comparison structures.\ncalculate_lnRR &lt;- function(dt) {\n\n  ## 1. Data Cleaning and Imputation (Handling Extreme Values)\n  # This section adjusts extreme boundary values (0, 100) and 0 standard deviations (SDs)\n  # to prevent mathematical errors (division by zero, log(0), or Inf values) \n  # during the lnRR and variance calculations.\n  dt &lt;- dt %&gt;%\n    mutate(\n      # Adjust means that are exactly 0 to a small, non-zero value (0.005) \n      C_mean = ifelse(C_mean == 0, 0.005, C_mean),\n      Ex_mean = ifelse(Ex_mean == 0, 0.005, Ex_mean),\n      \n      # Adjust means that are exactly 100 to a value just below 100 (99.5) \n      # (This is critical for percentages reported 0-100)\n      C_mean = ifelse(C_mean == 100, 99.5, C_mean), \n      Ex_mean = ifelse(Ex_mean == 100, 99.5, Ex_mean),\n\n      # Adjust SDs that are 0 to a small, non-zero value (0.01/0.05) to allow \n      # variance calculation (which relies on SDs).\n      Ex_SD = ifelse(Ex_SD == 0, 0.01, Ex_SD),\n      C_SD = ifelse(C_SD == 0, 0.05, C_SD),\n      \n      # Standardize the 'Data_type' variable to lowercase to ensure reliable matching \n      # in the subsequent 'if/else if' blocks, regardless of how it was typed in the source data.\n      Data_type = tolower(Data_type)\n    )\n\n  ## 2. Setup\n  dt1 &lt;- dt %&gt;%\n    mutate(\n      # Initialize the final effect size columns with numeric NA values.\n      lnRR = NA_real_, \n      lnRR_var = NA_real_\n    )\n    \n  # Define the arcsine square root transformation function: asin(sqrt(p)).\n  # This transformation is necessary for proportional data (percentages) to stabilize their variance.\n  asin_trans &lt;- function(proportion) {\n    trans &lt;- asin(sqrt(proportion))\n    return(trans)\n  }\n  \n  ## 3. Calculation Loop (Iterating through each row/effect size)\n  for (i in seq_len(nrow(dt1))) {\n    # Extract row-specific variables for the current row 'i'\n    Ex_n &lt;- dt1$Ex_n[i]\n    C_n &lt;- dt1$C_n[i]\n    Ex_mean &lt;- dt1$Ex_mean[i]\n    C_mean &lt;- dt1$C_mean[i]\n    Ex_SD &lt;- dt1$Ex_SD[i]\n    C_SD &lt;- dt1$C_SD[i]\n    Data_type &lt;- dt1$Data_type[i]\n    Comparison_structure &lt;- dt1$Comparison_structure[i]\n    Higher_better &lt;- dt1$Higher_better[i]\n    current_es_id &lt;- dt1$ES_ID[i] # Used for conditional scaling check below.\n    \n    \n    # --- A. Continuous Data (Time, Distance, Count, Latency, Index, etc.) ---\n    if (Data_type %in% c(\"time\", \"distance\", \"count\", \"latency\", \"index\")) {\n\n      # Calculate the Log Response Ratio (lnRR) using the metafor::escalc function.\n      if (Comparison_structure == \"Independent\") {\n        # 'ROM' (Ratio of Means) for independent groups.\n        effect &lt;- metafor::escalc(measure = \"ROM\", n1i = Ex_n, n2i = C_n,\n                                 m1i = Ex_mean, m2i = C_mean, sd1i = Ex_SD, sd2i = C_SD,\n                                 var.names = c(\"lnRR\", \"lnRR_var\"))\n      } else if (Comparison_structure == \"Dependent\") {\n        # 'ROMC' (Ratio of Means, Correlated) for dependent/repeated groups, \n        # using an assumed correlation (ri = 0.5).\n        effect &lt;- metafor::escalc(measure = \"ROMC\", ni = (Ex_n + C_n) / 2, \n                                 m1i = Ex_mean, m2i = C_mean, sd1i = Ex_SD, sd2i = C_SD,\n                                 ri = 0.5, var.names = c(\"lnRR\", \"lnRR_var\"))\n      }\n      \n      # Assign the calculated lnRR and its variance to the new columns.\n      dt1$lnRR[i] &lt;- effect$lnRR\n      dt1$lnRR_var[i] &lt;- effect$lnRR_var\n      \n      # 2. Outcome Direction Standardization (Sign Flip)\n      # If 'Higher_better' is \"No\" (e.g., lower anxiety is better), we flip the sign \n      # of lnRR so that a positive value always indicates a beneficial outcome.\n      if (Higher_better == \"No\") {\n        dt1$lnRR[i] &lt;- dt1$lnRR[i] * -1\n      }\n    }\n\n    # --- B. Proportion Data (Data_type is Percentage) ---\n    else if (Data_type %in% c(\"percentage\")) {\n      \n      # *** CRITICAL FIX: CONDITIONAL RESCALING ***\n      # Only rescale if the study is NOT \"es018,\" as \"es018\" reports 0-1 proportions.\n      # All other studies report 0-100 percentages and must be divided by 100.\n      if (current_es_id != \"es018\") {\n          Ex_mean &lt;- Ex_mean / 100\n          C_mean &lt;- C_mean / 100\n          Ex_SD &lt;- Ex_SD / 100 \n          C_SD &lt;- C_SD / 100\n      }\n\n      # 1. Standardization: Adjust means if \"Higher_better\" is \"No\"\n      # Flips the proportion (e.g., 80% success becomes 20% failure) to standardize direction.\n      if (Higher_better == \"No\") {\n        Ex_mean &lt;- 1 - Ex_mean\n        C_mean &lt;- 1 - C_mean\n      }\n\n      # 2. Transform SDs \n      # Calculate the standard deviation of the arcsin-transformed data (SD') based on the formula: \n      # SD' = sqrt(SD^2 / (4 * p * (1 - p)))\n      Ex_SD_trans &lt;- sqrt(Ex_SD^2 / (4 * Ex_mean * (1 - Ex_mean)))\n      C_SD_trans  &lt;- sqrt(C_SD^2 / (4 * C_mean * (1 - C_mean)))\n      \n      # 3. Transform Means (M') using the arcsin(sqrt(p)) function\n      Ex_mean_trans &lt;- asin_trans(Ex_mean)\n      C_mean_trans &lt;- asin_trans(C_mean)\n\n      # 4. lnRR Calculation (Using transformed means)\n      # lnRR = ln(M'ex / M'control)\n      lnRR_pro_calc &lt;- log(Ex_mean_trans / C_mean_trans)\n      \n      # 5. Variance Calculation (Using transformed SDs)\n      # Calculate the independent variance components (V_Ex, V_C) using the transformed values.\n      V_Ex &lt;- (Ex_SD_trans)^2 * (1 / (Ex_mean_trans^2 * Ex_n))\n      V_C  &lt;- (C_SD_trans)^2 * (1 / (C_mean_trans^2 * C_n))\n      \n      if (Comparison_structure == \"Independent\") {\n        # Variance for independent groups is simply the sum of individual variances.\n        lnRR_var_pro &lt;- V_Ex + V_C\n      } else if (Comparison_structure == \"Dependent\") {\n        # Variance for dependent groups includes a covariance term based on rho = 0.5.\n        # V_dep = V_Ex + V_C - 2 * rho * sqrt(V_Ex * V_C)\n        lnRR_var_pro &lt;- V_Ex + V_C - 2 * 0.5 * sqrt(V_Ex) * sqrt(V_C)\n      }\n      \n      # Final assignment of results for proportional data.\n      dt1$lnRR[i] &lt;- lnRR_pro_calc\n      dt1$lnRR_var[i] &lt;- lnRR_var_pro\n    }\n  }\n  return(dt1)\n}\nAfter defining the function, we proceed to load and clean the dataset.\ndb &lt;- readr::read_csv(here(\"..\",\"data\",\"db251124.csv\")) %&gt;%\n  \n  # Convert all columns required for lnRR calculation to numeric.\n  mutate(across(c(C_n, Ex_n, C_mean, Ex_mean, C_SE, Ex_SE, C_SD, Ex_SD), as.numeric)) %&gt;%\n  mutate(\n    # Calculate C_SD where it is missing but C_SE is present\n    C_SD = ifelse(\n      is.na(C_SD) & !is.na(C_SE),\n      C_SE * sqrt(C_n), \n      C_SD\n    ),\n    # Calculate Ex_SD where it is missing but Ex_SE is present\n    Ex_SD = ifelse(\n      is.na(Ex_SD) & !is.na(Ex_SE),\n      Ex_SE * sqrt(Ex_n), \n      Ex_SD\n    )\n  ) %&gt;%\n  \n  #\n  # This combines Study_ID and Ex_ID to uniquely identify the source cohort.\n  mutate(\n    Cohort_ID = paste(Study_ID, \"Ex-ID\", sep = \"_\")\n  ) %&gt;%\n  \n  \n  # Convert all remaining character columns to factors (for meta-regression)\n  mutate(across(where(is.character), as.factor))",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Estimating effect sizes</span>"
    ]
  },
  {
    "objectID": "lnRR.html#lnrr-effect-size-calculation-function",
    "href": "lnRR.html#lnrr-effect-size-calculation-function",
    "title": "Estimating effect sizes",
    "section": "",
    "text": "NoteVariable definitions\n\n\n\n\n\n\nVariable Name\nDefinition\n\n\n\n\nES_ID\nUnique identifier for each effect size.\n\n\n\n|Study_ID| Identifier for the study from which the data is drawn.\n|C_n, Ex_n| Sample sizes for Control and Experimental groups, respectively.\n|C_mean, Ex_mean*| Mean values for Control and Experimental groups, respectively.\n|C_SE, Ex_SE|Standard errors for Control and Experimental groups, respectively.\n|C_SD, Ex_SD| Standard deviations for Control and Experimental groups, respectively.\n|Data_type| Type of data (e.g., “time”, “distance”, “count”, “latency”, “percentage”, “index”).\n|Comparison_structure| Indicates whether the comparison is “Independent” (separate animals) or “Dependent” (same animals).\n|Higher_better| Indicates whether higher values are better (“Yes”) or not (“No”) for standardization purposes.",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Estimating effect sizes</span>"
    ]
  },
  {
    "objectID": "lnRR.html#calculate-inrr-effect-sizes",
    "href": "lnRR.html#calculate-inrr-effect-sizes",
    "title": "Estimating effect sizes",
    "section": "Calculate InRR Effect Sizes",
    "text": "Calculate InRR Effect Sizes\nNow, we apply the calculate_lnRR() function to the cleaned dataset to compute the effect sizes and their variances.\nThe resulting dataset, db_effect_sizes, is then saved as a CSV file for further analysis.\n\ndb_effect_sizes&lt;-calculate_lnRR(db)\nreadr::write_csv(\n  db_effect_sizes, \n  file = here(\"..\",\"data\", \"db_lnRR.csv\"),\n  na = \"\" \n)\n\n\nEffect Size TableEffect Size Distributions\n\n\n\n\n\n\n\n\n\n\n\nhist(db_effect_sizes$lnRR,xlim=c(-6.5,9),breaks = seq(-6.5,9,0.5))\n\n\n\n\n\n\n\nhist(db_effect_sizes$lnRR_var, xlim=c(0,13),breaks = seq(0,13,0.1))",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Estimating effect sizes</span>"
    ]
  },
  {
    "objectID": "overall_effect.html",
    "href": "overall_effect.html",
    "title": "Overall effect",
    "section": "",
    "text": "Variance-covariance matrix\nAfter estimating our effect sizes, we now run a multilevel, intercept-only meta-analysis using the \\(\\text{rma.mv}\\) function in the metafor package to estimate the overall mean effect of the experimental treatment (music exposure) across all independent cohorts and studies in the dataset.\nAfter loading the data containing our calculated effect sizes (lnRR and lnRR_var), we create a variance-covariance matrix to account for dependencies among effect sizes from the same cohort (i.e., correlated outcomes).\nVCV &lt;- metafor::vcalc(\n  vi = lnRR_var,\n  cluster = Cohort_ID, # The clustering variable (Study_ID + Ex_ID)\n  obs = ES_ID,         # The unique observation/effect size ID\n  rho = 0.5,           # Assumed correlation between outcomes from the same cohort\n  data = db \n)",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Overall effect</span>"
    ]
  },
  {
    "objectID": "overall_effect.html#variance-covariance-matrix",
    "href": "overall_effect.html#variance-covariance-matrix",
    "title": "Overall effect",
    "section": "",
    "text": "Tip\n\n\n\nWhen multiple effect sizes originate from the same source (e.g., several different outcomes measured on the same animals within one study cohort), they are inherently correlated. If we treat them as fully independent, our model would underestimate the true standard errors and potentially inflate the statistical significance of our findings. The \\(\\text{VCV}\\) matrix resolves this by explicitly modeling the covariance between these related effect sizes.",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Overall effect</span>"
    ]
  },
  {
    "objectID": "overall_effect.html#multilevel-intercept-only-meta-analytic-model",
    "href": "overall_effect.html#multilevel-intercept-only-meta-analytic-model",
    "title": "Overall effect",
    "section": "Multilevel “Intercept only” meta-analytic model",
    "text": "Multilevel “Intercept only” meta-analytic model\nWe then fit a multilevel meta-analytic model with random effects for Study_ID, Cohort_ID, and ES_ID to estimate the overall mean effect size.\n\nma_all &lt;- rma.mv(yi = lnRR,\n                  V = VCV, \n                  random = list(~1 | Study_ID,\n                                ~1 | Cohort_ID,\n                                ~1 | ES_ID,\n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db)\n\nsummary(ma_all)\n\n\nMultivariate Meta-Analysis Model (k = 299; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-250.0225   500.0450   510.0450   528.5304   510.2505   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed     factor \nsigma^2.1  0.0244  0.1562     20     no   Study_ID \nsigma^2.2  0.0244  0.1562     20     no  Cohort_ID \nsigma^2.3  0.2173  0.4662    299     no      ES_ID \nsigma^2.4  0.0000  0.0001      6     no     Strain \n\nTest for Heterogeneity:\nQ(df = 298) = 5722.0263, p-val &lt; .0001\n\nModel Results:\n\nestimate      se    tval   df    pval   ci.lb   ci.ub     \n  0.2058  0.0654  3.1485  298  0.0018  0.0772  0.3344  ** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nWe can extract the \\(I^2\\) statistic to quantify the proportion of total variability in effect sizes that is due to heterogeneity rather than sampling error.\n\norchaRd::i2_ml(ma_all)\n\n    I2_Total  I2_Study_ID I2_Cohort_ID     I2_ES_ID    I2_Strain \n9.634992e+01 8.828611e+00 8.828591e+00 7.869272e+01 1.133827e-06 \n\n\nWe can also extract the model’s \\(R^2\\) value to assess the proportion of variance explained by the model.\n\nr2 &lt;- round(r2_ml(ma_all), 4)\nr2\n\n   R2_marginal R2_conditional \n        0.0000         0.1833 \n\n\nInterestingly, Study_ID and Cohort_ID are accounting for a similar portion of the total variance. So, we drop Cohort_ID from the random effects structure and refit the model to see if it improves parsimony without sacrificing model fit.",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Overall effect</span>"
    ]
  },
  {
    "objectID": "overall_effect.html#model-simplification",
    "href": "overall_effect.html#model-simplification",
    "title": "Overall effect",
    "section": "Model simplification",
    "text": "Model simplification\n\nma_all &lt;- rma.mv(yi = lnRR,\n                  V = VCV, \n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID,\n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db)\n\nsummary(ma_all)\n\n\nMultivariate Meta-Analysis Model (k = 299; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-250.0225   500.0450   508.0450   522.8333   508.1815   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0488  0.2208     20     no  Study_ID \nsigma^2.2  0.2173  0.4662    299     no     ES_ID \nsigma^2.3  0.0000  0.0001      6     no    Strain \n\nTest for Heterogeneity:\nQ(df = 298) = 5722.0263, p-val &lt; .0001\n\nModel Results:\n\nestimate      se    tval   df    pval   ci.lb   ci.ub     \n  0.2058  0.0654  3.1485  298  0.0018  0.0772  0.3344  ** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\norchaRd::i2_ml(ma_all)\n\n    I2_Total  I2_Study_ID     I2_ES_ID    I2_Strain \n9.634992e+01 1.765720e+01 7.869272e+01 9.689733e-07 \n\n\n\nr2 &lt;- round(r2_ml(ma_all), 4)\nr2\n\n   R2_marginal R2_conditional \n        0.0000         0.1833 \n\n\nAs we can see, we achieve a similar fit with a more parsimonious model.\nFinally, we can visualize the overall effect size estimate using an orchard plot from the orchaRd package.\n\noverall_lnRR&lt;-orchard_plot(ma_all,\n              group = \"Study_ID\",\n              xlab = \"lnRR\", \n              flip=FALSE) + \n              scale_x_discrete(labels = c(\"Overall effect\")) +\n                scale_y_continuous(breaks = seq(-8, 10, by = 2),\n                                   minor_breaks = seq(-8, 10, by = 1 ))\noverall_lnRR\n\n\n\n\n\n\n\n\n\nggsave(filename = here(\"..\",\"Plots\", \"overall_lnRR.pdf\"),\n       plot = overall_lnRR,\n       dpi = 300, device = cairo_pdf)\n\nggsave(filename = here(\"..\",\"Plots\", \"overall_lnRR.jpg\"),\n       plot = overall_lnRR,\n       width = 7,  \n       height = 9,  \n       dpi = 300)",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Overall effect</span>"
    ]
  },
  {
    "objectID": "uni_moderators.html",
    "href": "uni_moderators.html",
    "title": "Uni-moderators",
    "section": "",
    "text": "Functions for pairwise contrasts\nGeneral Explanation This set of functions automates a common but tedious task in meta-analysis: calculating all pairwise comparisons between groups.",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Uni-moderators</span>"
    ]
  },
  {
    "objectID": "uni_moderators.html#functions-for-pairwise-contrasts",
    "href": "uni_moderators.html#functions-for-pairwise-contrasts",
    "title": "Uni-moderators",
    "section": "",
    "text": "Function 1 (The Generator): Standard meta-regression usually compares all groups against a single “Reference” group. This function “hacks” that by re-running the model multiple times, rotating the reference group each time so that every group gets a turn as the baseline.\nFunction 2 (The Harvester): This extracts the statistical results (estimates, confidence intervals, p-values) from all those models and organizes them into a single, readable table.\nFunction 3 (The Cleaner): Because the first two steps calculate both “Group A vs B” and “Group B vs A” (which are mathematically identical), this function filters out the duplicates to leave you with a clean, unique list of comparisons.\n\n\n1. The Generator2. The Harvester3. The cleaner\n\n\n\ncontrast_fun &lt;- function(data, response, moderator, VCV){\n    \n    # --- 1. Setup Dynamic Names ---\n    # We grab the actual names of the columns so we can use them in the formulas below\n    mod  &lt;- deparse(substitute(moderator))\n    resp &lt;- deparse(substitute(response))\n    \n    # --- 2. Identify Groups ---\n    # Find all unique categories in the moderator and ensure it's a factor\n    names &lt;- levels(as.factor(data[[mod]]))\n    moderator &lt;- as.factor(data[[mod]])\n    \n    # --- 3. The Model Runner ---\n    # This internal function fits the meta-regression repeatedly.\n    # It changes the 'ref' (reference level) dynamically each time.\n    run_rma &lt;- function(name) {\n        rma.mv(yi = data[[resp]], \n               V = VCV, \n               # Here is the magic: we force the model to use 'name' as the baseline\n               mods = ~ relevel(moderator, ref = name), \n               random = list(~1|Study_ID, ~1|ES_ID, ~1|Strain), \n               test = \"t\", \n               data = data, \n               sparse = TRUE)\n    }\n    \n    # --- 4. Loop Through Groups ---\n    # We run the model n-1 times (we don't need the last one as it's covered by previous runs).\n    # map() iterates through the names and applies run_rma() to each.\n    contra &lt;- purrr::map(names[-length(names)], run_rma)\n    \n    return(contra)\n}\n\n\n\n\nget_estimate &lt;- function(model, contra, moderator) {\n    \n    mod &lt;- deparse(substitute(moderator))\n    \n    # Utility: Make text look nice (e.g., \"control\" -&gt; \"Control\")\n    capitalize_first &lt;- function(x) {\n        paste0(toupper(substring(x, 1, 1)), substring(x, 2))\n    }\n    \n    # --- Helper A: Get Group Means ---\n    # Extracts the estimated mean effect size for each group from the base model\n    get_pred1 &lt;- function (model, mod = mod) {\n        # Clean up row names to just get the group name\n        name_raw &lt;- as.character(stringr::str_replace(row.names(model$beta), mod, \"\"))\n        name &lt;- capitalize_first(name_raw)\n        len &lt;- length(name)\n        \n        # Create a dummy matrix to predict the mean for each group individually\n        newdata &lt;- matrix(NA, ncol = len, nrow = len)\n        for (i in 1:len) {\n            pos &lt;- which(model$X[, i] == 1)[[1]] \n            newdata[i, ] &lt;- model$X[pos, ]       \n        }\n        \n        # Predict values\n        pred &lt;- metafor::predict.rma(model, newmods = newdata)\n        \n        # Format into a tibble\n        tibble::tibble(\n            name = factor(name, levels = name, labels = name),\n            estimate = pred$pred,\n            lowerCL = pred$ci.lb, upperCL = pred$ci.ub,\n            pval = model$pval, \n            lowerPR = pred$cr.lb, upperPR = pred$cr.ub\n        )\n    }\n    \n    # --- Helper B: Get Pairwise Differences ---\n    # Extracts the \"contrasts\" (differences between groups) from the re-leveled models\n    get_pred2 &lt;- function (model) {\n        name &lt;- row.names(model$beta) \n        len &lt;- length(name)\n        newdata &lt;- diag(len)\n        \n        # 1. Get the Intercept (The Reference Group Mean)\n        pred1 &lt;- data.frame(metafor::predict.rma(model, newmods = newdata[1,-1]))\n        names(pred1) &lt;- c(\"pred\", \"se\", \"ci.lb\", \"ci.ub\", \"cr.lb\", \"cr.ub\") \n        \n        # 2. Get the Contrasts (Difference from Reference)\n        pred2 &lt;- data.frame(metafor::predict.rma(model, intercept = FALSE, newmods = newdata[-1,-1]))\n        names(pred2) &lt;- c(\"pred\", \"se\", \"ci.lb\", \"ci.ub\", \"cr.lb\", \"cr.ub\") \n\n        pred &lt;- rbind(pred1, pred2)\n        \n        tibble::tibble(\n            name = factor(name, levels = name, labels = name),\n            estimate = pred$pred,\n            lowerCL = pred$ci.lb, upperCL = pred$ci.ub,\n            pval = model$pval,\n            lowerPR = pred$cr.lb, upperPR = pred$cr.ub\n        )\n    }\n    \n    # --- Helper C: Combine Everything ---\n    # Stitches the group means and the pairwise differences into one big table\n    mr_results &lt;- function(res1, res2) {\n    \n        # Logic to name the comparisons (e.g., \"Treatment-Control\") based on order\n        get_ordered_contrast_names &lt;- function(level_names) {\n            reference_levels &lt;- level_names[-length(level_names)] \n            ordered_names &lt;- c()\n            \n            for (ref in reference_levels) {\n                coefficient_levels &lt;- level_names[level_names != ref]\n                # Format: \"ComparisonGroup - ReferenceGroup\"\n                ordered_names &lt;- c(ordered_names, paste(coefficient_levels, ref, sep=\"-\"))\n            }\n            return(ordered_names)\n        }\n\n        level_names &lt;- as.character(res1$name)\n        new_contrast_names &lt;- get_ordered_contrast_names(level_names)\n        \n        tibble::tibble(\n            Levels = c(level_names, new_contrast_names),\n            Estimate = c(res1$estimate, res2$estimate),\n            Lower_CI = c(res1$lowerCL, res2$lowerCL),\n            Upper_CI = c(res1$upperCL, res2$upperCL),\n            P_value = c(res1$pval, res2$pval),\n            Lower_PI = c(res1$lowerPR, res2$lowerPR),\n            Upper_PI = c(res1$upperPR, res2$upperPR)\n        )\n    }\n    \n    # --- MAIN EXECUTION FLOW ---\n    \n    # 1. Calculate Group Means (Base Model)\n    res1 &lt;- get_pred1(model, mod = mod)\n    \n    # 2. Calculate Contrasts (Re-leveled Models)\n    estimates &lt;- purrr::map(contra, ~ get_pred2(.x))\n    \n    # 3. Drop intercepts from contrast models (we only want the differences)\n    res2 &lt;- purrr::map_dfr(estimates, ~.x[-1, ]) \n    \n    # 4. Final Polish\n    results &lt;- mr_results(res1, res2)\n    \n    return(results)\n}\n\n\n\n\nclean_unique_contrasts &lt;- function(full_results_table, level_count = 6) {\n  \n  # --- 1. Split Data ---\n  # Keep the single group means safe at the top\n  level_estimates &lt;- full_results_table[1:level_count, ]\n  # Isolate the pairwise comparisons\n  contrast_estimates &lt;- full_results_table[-(1:level_count), ]\n  \n  # --- 2. Clean Names ---\n  # Parse \"GroupA-GroupB\" into separate columns\n  contrast_estimates &lt;- contrast_estimates %&gt;%\n    mutate(\n      Level1 = str_extract(Levels, \"^(.*?)-\"),\n      Level2 = str_extract(Levels, \"-(.*?)$\")\n    ) %&gt;%\n    mutate(\n      Level1 = str_replace_all(Level1, \"-\", \"\"),\n      Level2 = str_replace_all(Level2, \"-\", \"\")\n    )\n  \n  # --- 3. Deduplicate ---\n  # Create a sorted key so \"A_B\" and \"B_A\" are treated as identical\n  unique_contrasts &lt;- contrast_estimates %&gt;%\n    mutate(\n      Unique_Pair_Key = paste(pmin(Level1, Level2), pmax(Level1, Level2), sep = \"_\")\n    ) %&gt;%\n    # Keep only the first instance of each unique pair\n    distinct(Unique_Pair_Key, .keep_all = TRUE) %&gt;%\n    select(-Level1, -Level2, -Unique_Pair_Key)\n  \n  # --- 4. Recombine ---\n  final_table &lt;- bind_rows(level_estimates, unique_contrasts)\n  \n  return(final_table)\n}",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Uni-moderators</span>"
    ]
  },
  {
    "objectID": "uni_moderators.html#meta-regressions",
    "href": "uni_moderators.html#meta-regressions",
    "title": "Uni-moderators",
    "section": "Meta-regressions",
    "text": "Meta-regressions\n\n\n\n\n\n\nNoteData Filtering & Matrix Alignment\n\n\n\nThis snippet performs quality control before running your meta-analysis. It serves two critical functions:\nEnsures Reliability: It removes specific levels of your moderator (groups) that have too little data to be trusted (in this case, fewer than 5 effect sizes).\nPrevents Errors: Crucially, it subsets the Variance-Covariance (VCV) matrix to match your filtered data. Since the VCV matrix is a square grid where every row/column corresponds to a row in your data, filtering the data without “cropping” the matrix correspondingly will cause your model to crash due to a dimension mismatch.\n\n# 1. Identify and Filter Low-K Levels\n# (Replace 'Outcome_type' with the specific moderator column name)\n\n# Calculate the count of ES_ID (k) for each level of the moderator\nk_counts &lt;- db %&gt;%\n  group_by(Outcome_type) %&gt;%\n  summarise(k_es = n())\n\n# Identify the levels to keep (where k_es &gt;= 5)\nlevels_to_keep &lt;- k_counts %&gt;%\n  filter(k_es &gt;= 5) %&gt;%\n  pull(Outcome_type)\n\n# 2. Create the Filtered Data Frame\ndb_filtered &lt;- db %&gt;%\n  filter(Outcome_type %in% levels_to_keep)\n\n# 3. Subset the VCV Matrix (CRITICAL STEP)\n# Assumes VCV matrix rows/columns match the original 'db' data frame indices.\nindices_to_keep &lt;- which(db$Outcome_type %in% levels_to_keep)\nVCV_filtered &lt;- VCV[indices_to_keep, indices_to_keep]\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nManual Reference Rotation for SubsetsThe automated contrast functions are designed for full datasets. When you filter for data availability (e.g., keeping only levels with \\(k \\ge 5\\)) and are left with more than 2 levels, it is often safer to manually “rotate” the reference level. How it works:In meta-regression with an intercept, the Intercept represents the mean of the Reference Level. The other coefficients represent the difference between the reference and the other groups.By manually changing the reference (ref = …) and re-running the model for each level, you mathematically force the model to calculate every possible pairwise comparison (e.g., A vs B, B vs C, A vs C) and their specific p-values.\n\n2 Levels remaining? You only need one model (Intercept = Group A, Coefficient = Difference).\n3+ Levels remaining? Use the rotation method below.\n\n\n# 0. Define your levels of interest\nLEVELS &lt;- c(\"Acute\", \"Medium\", \"Short\")\n# (Optional) Store moderator name for clarity\nMOD_NAME &lt;- \"Music_exposure_duration\"\n\n# --- Model A: Reference = Acute ---\n# Intercept = Acute Mean\n# Coefficients = (Medium - Acute) and (Short - Acute)\ndb_filtered$moderator_relevel_A &lt;- relevel(db_filtered$Music_exposure_duration, ref = LEVELS[1])\nmodel_A &lt;- rma.mv(yi = lnRR,\n                  V = VCV_filtered, \n                  mods = ~ moderator_relevel_A,\n                  random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                  test = \"t\", method = \"REML\", sparse = TRUE,\n                  data = db_filtered)\nmodel_A\n\n# --- Model B: Reference = Medium ---\n# Intercept = Medium Mean\n# Coefficients = (Acute - Medium) and (Short - Medium)\n# *Key Gain: This gives us the specific P-value for Short vs Medium*\ndb_filtered$moderator_relevel_B &lt;- relevel(db_filtered$Music_exposure_duration, ref = LEVELS[2])\nmodel_B &lt;- rma.mv(yi = lnRR,\n                  V = VCV_filtered, \n                  mods = ~ moderator_relevel_B,\n                  random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                  test = \"t\", method = \"REML\", sparse = TRUE,\n                  data = db_filtered)\nmodel_B\n\n# --- Model C: Reference = Short ---\n# Intercept = Short Mean\n# Coefficients = (Acute - Short) and (Medium - Short)\n# *Useful for: Getting the direct estimate/CI for the \"Short\" group mean*\ndb_filtered$moderator_relevel_C &lt;- relevel(db_filtered$Music_exposure_duration, ref = LEVELS[3])\nmodel_C &lt;- rma.mv(yi = lnRR,\n                  V = VCV_filtered, \n                  mods = ~ moderator_relevel_C,\n                  random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                  test = \"t\", method = \"REML\", sparse = TRUE,\n                  data = db_filtered)\nmodel_C\n\n\n\n\n1. Outcome type: Anxiety and Depression2. Lifestage of exposure3. Sex4. Music genre5. Music exposure duration6. Experimental design7. Induced behaviour8. Relative timing9. Experimental procedures10. Control condition11. Assay type\n\n\n\nk_counts &lt;- db %&gt;%\n  group_by(Outcome_type) %&gt;%\n  summarise(k_es = n())\n\n\nlevels_to_keep &lt;- k_counts %&gt;%\n  filter(k_es &gt;= 5) %&gt;%\n  pull(Outcome_type)\n\n\ndb_filtered &lt;- db %&gt;%\n  filter(Outcome_type %in% levels_to_keep)\n\nindices_to_keep &lt;- which(db$Outcome_type %in% levels_to_keep)\nVCV_filtered &lt;- VCV[indices_to_keep, indices_to_keep]\n\n\nmOT &lt;- rma.mv(yi = lnRR,\n                  V = VCV_filtered, \n              mods = ~ Outcome_type-1,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID,\n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db_filtered)\n\nsummary(mOT)\n\n\nMultivariate Meta-Analysis Model (k = 296; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-248.3277   496.6555   506.6555   525.0734   506.8638   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0489  0.2211     20     no  Study_ID \nsigma^2.2  0.2202  0.4692    296     no     ES_ID \nsigma^2.3  0.0000  0.0001      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 294) = 5619.0059, p-val &lt; .0001\n\nTest of Moderators (coefficients 1:2):\nF(df1 = 2, df2 = 294) = 4.8897, p-val = 0.0081\n\nModel Results:\n\n                        estimate      se    tval   df    pval   ci.lb   ci.ub \nOutcome_typeAnxiety       0.2066  0.0704  2.9335  294  0.0036  0.0680  0.3453 \nOutcome_typeDepression    0.2023  0.0912  2.2179  294  0.0273  0.0228  0.3817 \n                           \nOutcome_typeAnxiety     ** \nOutcome_typeDepression   * \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nr2OT &lt;- round(r2_ml(mOT), 4)\nr2OT\n\n   R2_marginal R2_conditional \n        0.0000         0.1817 \n\n\n\norchard_outcome&lt;-orchard_plot(mOT,\n             mod = \"Outcome_type\",\n              group = \"Study_ID\",\n              xlab = \"lnRR\", \n             flip = FALSE) +\n            scale_colour_brewer(palette = \"Set1\") +\n            scale_fill_brewer(palette = \"Dark2\")+scale_y_continuous(breaks = seq(-8, 10, by = 2),\n                                                                    minor_breaks = seq(-8, 10, by = 1 ))\norchard_outcome\n\n\n\n\n\n\n\n\n\nggsave(filename = here(\"..\",\"Plots\", \"orchard_outcome_lnRR.pdf\"),\n       plot = orchard_outcome,\n       dpi = 300, device = cairo_pdf)\n\nggsave(filename = here(\"..\",\"Plots\", \"orchard_outcome_lnRR.jpg\"),\n       plot = orchard_outcome,\n       width = 7,  \n       height = 9,  \n       dpi = 300)\n\nContrast between levels (Anxiety as reference level)\n\nmOT &lt;- rma.mv(yi = lnRR,\n                  V = VCV_filtered, \n              mods = ~ Outcome_type,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID,\n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db_filtered)\n\nsummary(mOT)\n\n\nMultivariate Meta-Analysis Model (k = 296; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-248.3277   496.6555   506.6555   525.0734   506.8638   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0489  0.2211     20     no  Study_ID \nsigma^2.2  0.2202  0.4692    296     no     ES_ID \nsigma^2.3  0.0000  0.0001      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 294) = 5619.0059, p-val &lt; .0001\n\nTest of Moderators (coefficient 2):\nF(df1 = 1, df2 = 294) = 0.0024, p-val = 0.9607\n\nModel Results:\n\n                        estimate      se     tval   df    pval    ci.lb   ci.ub \nintrcpt                   0.2066  0.0704   2.9335  294  0.0036   0.0680  0.3453 \nOutcome_typeDepression   -0.0044  0.0887  -0.0493  294  0.9607  -0.1790  0.1702 \n                           \nintrcpt                 ** \nOutcome_typeDepression     \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\n\nmLE &lt;- rma.mv(yi = lnRR,\n                  V = VCV, \n              mods = ~ Lifestage_exposure-1,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID,\n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db)\n\nsummary(mLE)\n\n\nMultivariate Meta-Analysis Model (k = 299; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-245.3307   490.6614   508.6614   541.7830   509.2975   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0392  0.1980     20     no  Study_ID \nsigma^2.2  0.2201  0.4692    299     no     ES_ID \nsigma^2.3  0.0039  0.0624      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 293) = 5545.8559, p-val &lt; .0001\n\nTest of Moderators (coefficients 1:6):\nF(df1 = 6, df2 = 293) = 2.0358, p-val = 0.0609\n\nModel Results:\n\n                               estimate      se    tval   df    pval    ci.lb \nLifestage_exposureAdolescent     0.2231  0.1597  1.3963  293  0.1637  -0.0913 \nLifestage_exposureAdult          0.1354  0.1423  0.9515  293  0.3421  -0.1447 \nLifestage_exposureJuvenile       0.1296  0.1899  0.6826  293  0.4954  -0.2441 \nLifestage_exposureMixed          0.0556  0.1166  0.4766  293  0.6340  -0.1739 \nLifestage_exposureUnclear        0.3436  0.1640  2.0945  293  0.0371   0.0207 \nLifestage_exposureYoung adult    0.3014  0.0894  3.3708  293  0.0009   0.1254 \n                                ci.ub      \nLifestage_exposureAdolescent   0.5375      \nLifestage_exposureAdult        0.4156      \nLifestage_exposureJuvenile     0.5034      \nLifestage_exposureMixed        0.2850      \nLifestage_exposureUnclear      0.6665    * \nLifestage_exposureYoung adult  0.4773  *** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nr2LE &lt;- round(r2_ml(mLE), 4)\nr2LE\n\n   R2_marginal R2_conditional \n        0.0420         0.1988 \n\n\n\norchard_lifestage&lt;-orchard_plot(mLE,\n             mod = \"Lifestage_exposure\",\n              group = \"Study_ID\",\n               xlab = \"lnRR\", \n             flip = FALSE) +\n            scale_colour_brewer(palette = \"Set1\") +\n            scale_fill_brewer(palette = \"Dark2\")+scale_y_continuous(breaks = seq(-8, 10, by = 2),\n                                                                    minor_breaks = seq(-8, 10, by = 1 ))\norchard_lifestage\n\n\n\n\n\n\n\n\n\nggsave(filename = here(\"..\",\"Plots\", \"orchard_lifestage_lnRR.pdf\"),\n       plot = orchard_lifestage,\n       dpi = 300, device = cairo_pdf)\n\nggsave(filename = here(\"..\",\"Plots\", \"orchard_lifestage_lnRR.jpg\"),\n       plot = orchard_lifestage,\n       width = 9,  \n       height = 7,  \n       dpi = 300)\n\nContrasts between levels (Adolescent as reference level)\n\n# Here we apply our custum functions\n# The Generator\ncontra_LE &lt;- contrast_fun(data = db, \n                          response = lnRR, \n                          moderator = Lifestage_exposure, \n                          VCV = VCV)\n\n#The Harvester\nt1&lt;-get_estimate(model = mLE, contra = contra_LE, moderator = Lifestage_exposure)\n\n#The Cleaner\nt2 &lt;- clean_unique_contrasts(full_results_table = t1, level_count = 6)\n\n\nt2\n\n# A tibble: 21 × 7\n   Levels              Estimate Lower_CI Upper_CI  P_value Lower_PI Upper_PI\n   &lt;chr&gt;                  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;\n 1 Adolescent            0.223   -0.0913    0.537 0.164      -0.834    1.28 \n 2 Adult                 0.135   -0.145     0.416 0.342      -0.912    1.18 \n 3 Juvenile              0.130   -0.244     0.503 0.495      -0.947    1.21 \n 4 Mixed                 0.0556  -0.174     0.285 0.634      -0.980    1.09 \n 5 Unclear               0.344    0.0207    0.666 0.0371     -0.716    1.40 \n 6 Young adult           0.301    0.125     0.477 0.000850   -0.724    1.33 \n 7 Adult-Adolescent     -0.0876  -0.446     0.271 0.631      -1.16     0.984\n 8 Juvenile-Adolescent  -0.0934  -0.494     0.307 0.646      -1.18     0.993\n 9 Mixed-Adolescent     -0.167   -0.549     0.214 0.389      -1.25     0.912\n10 Unclear-Adolescent    0.121   -0.303     0.544 0.576      -0.974    1.22 \n# ℹ 11 more rows\n\n\n\n\n\nk_counts &lt;- db %&gt;%\n  group_by(Sex) %&gt;%\n  summarise(k_es = n())\n\nlevels_to_keep &lt;- k_counts %&gt;%\n  filter(k_es &gt;= 5) %&gt;%\n  pull(Sex)\n\ndb_filtered &lt;- db %&gt;%\n  filter(Sex %in% levels_to_keep)\n\n\nindices_to_keep &lt;- which(db$Sex %in% levels_to_keep)\nVCV_filtered &lt;- VCV[indices_to_keep, indices_to_keep]\n\n\nmSX &lt;- rma.mv(yi = lnRR,\n                  V = VCV_filtered, \n              mods = ~ Sex-1,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID,\n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db_filtered)\n\nsummary(mSX)\n\n\nMultivariate Meta-Analysis Model (k = 296; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-246.0821   492.1642   502.1642   520.5821   502.3725   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0416  0.2038     19     no  Study_ID \nsigma^2.2  0.2171  0.4660    296     no     ES_ID \nsigma^2.3  0.0092  0.0958      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 294) = 5665.9939, p-val &lt; .0001\n\nTest of Moderators (coefficients 1:2):\nF(df1 = 2, df2 = 294) = 4.7417, p-val = 0.0094\n\nModel Results:\n\n           estimate      se    tval   df    pval    ci.lb   ci.ub     \nSexFemale    0.3055  0.0996  3.0678  294  0.0024   0.1095  0.5015  ** \nSexMale      0.1516  0.0828  1.8306  294  0.0682  -0.0114  0.3145   . \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nr2SX &lt;- round(r2_ml(mSX), 4)\nr2SX\n\n   R2_marginal R2_conditional \n        0.0207         0.2062 \n\n\n\norchard_sex&lt;-orchard_plot(mSX,\n             mod = \"Sex\",\n              group = \"Study_ID\",\n             xlab = \"lnRR\", \n             flip = FALSE) +\n            scale_colour_brewer(palette = \"Dark2\") +\n            scale_fill_brewer(palette = \"Set1\")+scale_y_continuous(breaks = seq(-5, 10, by = 2),\n                                                                    minor_breaks = seq(-5, 10, by = 1 ))\norchard_sex\n\n\n\n\n\n\n\n\n\nggsave(filename = here(\"..\",\"Plots\", \"orchard_sex_lnRR.pdf\"),\n       plot = orchard_sex,\n       dpi = 300, device = cairo_pdf)\n\nggsave(filename = here(\"..\",\"Plots\", \"orchard_sex_lnRR.jpg\"),\n       plot = orchard_sex,\n       width = 7,  \n       height = 9,  \n       dpi = 300)\n\nContrast between levels (Female as reference level)\n\nmSX &lt;- rma.mv(yi = lnRR,\n                  V = VCV_filtered, \n              mods = ~ Sex,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID,\n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db_filtered)\n\nsummary(mSX)\n\n\nMultivariate Meta-Analysis Model (k = 296; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-246.0821   492.1642   502.1642   520.5821   502.3725   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0416  0.2038     19     no  Study_ID \nsigma^2.2  0.2171  0.4660    296     no     ES_ID \nsigma^2.3  0.0092  0.0958      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 294) = 5665.9939, p-val &lt; .0001\n\nTest of Moderators (coefficient 2):\nF(df1 = 1, df2 = 294) = 2.9038, p-val = 0.0894\n\nModel Results:\n\n         estimate      se     tval   df    pval    ci.lb   ci.ub     \nintrcpt    0.3055  0.0996   3.0678  294  0.0024   0.1095  0.5015  ** \nSexMale   -0.1539  0.0903  -1.7041  294  0.0894  -0.3317  0.0238   . \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\nMeta_genre\n\nmMG &lt;- rma.mv(yi = lnRR,\n                  V = VCV, \n              mods = ~ Meta_genre-1,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID,\n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db)\n\nsummary(mMG)\n\n\nMultivariate Meta-Analysis Model (k = 299; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-246.5479   493.0958   507.0958   532.9047   507.4861   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0503  0.2242     20     no  Study_ID \nsigma^2.2  0.2169  0.4657    299     no     ES_ID \nsigma^2.3  0.0000  0.0000      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 295) = 5629.8481, p-val &lt; .0001\n\nTest of Moderators (coefficients 1:4):\nF(df1 = 4, df2 = 295) = 3.0367, p-val = 0.0178\n\nModel Results:\n\n                                            estimate      se    tval   df \nMeta_genreMixed                               0.2102  0.1446  1.4534  295 \nMeta_genrePopular Contemporary Music          0.0928  0.1887  0.4921  295 \nMeta_genreTraditional Music / Folk / World    0.5706  0.2606  2.1897  295 \nMeta_genreWestern Art Music / Orchestral      0.1861  0.0762  2.4436  295 \n                                              pval    ci.lb   ci.ub    \nMeta_genreMixed                             0.1472  -0.0744  0.4947    \nMeta_genrePopular Contemporary Music        0.6230  -0.2785  0.4642    \nMeta_genreTraditional Music / Folk / World  0.0293   0.0578  1.0834  * \nMeta_genreWestern Art Music / Orchestral    0.0151   0.0362  0.3360  * \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nr2MG &lt;- round(r2_ml(mMG), 4)\nr2MG\n\n   R2_marginal R2_conditional \n        0.0221         0.2060 \n\n\n\norchard_genre&lt;-orchard_plot(mMG,\n             mod = \"Meta_genre\",\n              group = \"Study_ID\",\n             xlab = \"lnRR\", \n             flip = FALSE) +\n            scale_colour_brewer(palette = \"Dark2\") +\n            scale_fill_brewer(palette = \"Set1\")+scale_y_continuous(breaks = seq(-5, 10, by = 2),\n                                                                    minor_breaks = seq(-5, 10, by = 1 ))\norchard_genre\n\n\n\n\n\n\n\n\n\nggsave(filename = here(\"..\",\"Plots\", \"orchard_genre_lnRR.pdf\"),\n       plot = orchard_genre,\n       dpi = 300, device = cairo_pdf)\n\nggsave(filename = here(\"..\",\"Plots\", \"orchard_genre_lnRR.jpg\"),\n       plot = orchard_genre,\n       width = 9,  \n       height = 7,  \n       dpi = 300)\n\nContrasts between levels\n\n# The Generator\ncontra_mMG &lt;- contrast_fun(data = db, \n                          response = lnRR, \n                          moderator = Meta_genre, \n                          VCV = VCV)\n# The Harvester\nt1&lt;-get_estimate(model = mMG, contra = contra_mMG, moderator = Meta_genre)\n# The Cleaner\nt2 &lt;- clean_unique_contrasts(full_results_table = t1, level_count = 4)\n\n\nt2\n\n# A tibble: 10 × 7\n   Levels                   Estimate Lower_CI Upper_CI P_value Lower_PI Upper_PI\n   &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;\n 1 Mixed                      0.210   -0.0744    0.495  0.147    -0.846    1.27 \n 2 Popular Contemporary Mu…   0.0928  -0.278     0.464  0.623    -0.990    1.18 \n 3 Traditional Music / Fol…   0.571    0.0578    1.08   0.0293   -0.569    1.71 \n 4 Western Art Music / Orc…   0.186    0.0362    0.336  0.0151   -0.842    1.21 \n 5 Popular Contemporary Mu…  -0.117   -0.562     0.328  0.604    -1.23     0.993\n 6 Traditional Music / Fol…   0.360   -0.225     0.946  0.227    -0.813    1.53 \n 7 Western Art Music / Orc…  -0.0241  -0.334     0.286  0.879    -1.09     1.04 \n 8 Traditional Music / Fol…   0.478   -0.145     1.10   0.132    -0.715    1.67 \n 9 Western Art Music / Orc…   0.0933  -0.291     0.478  0.633    -0.994    1.18 \n10 Western Art Music / Orc…  -0.384   -0.916     0.147  0.156    -1.53     0.763\n\n\n\n\nMusic_exposure_duration\n\nk_counts &lt;- db %&gt;%\n  group_by(Music_exposure_duration) %&gt;%\n  summarise(k_es = n())\n\nlevels_to_keep &lt;- k_counts %&gt;%\n  filter(k_es &gt;= 5) %&gt;%\n  pull(Music_exposure_duration)\n\ndb_filtered &lt;- db %&gt;%\n  filter(Music_exposure_duration %in% levels_to_keep)\n\nindices_to_keep &lt;- which(db$Music_exposure_duration %in% levels_to_keep)\nVCV_filtered &lt;- VCV[indices_to_keep, indices_to_keep]\n\n\nmMED &lt;- rma.mv(yi = lnRR,\n                  V = VCV_filtered, \n              mods = ~ Music_exposure_duration-1,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID, \n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db_filtered)\n\nsummary(mMED)\n\n\nMultivariate Meta-Analysis Model (k = 298; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-246.8335   493.6669   505.6669   527.7888   505.9586   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0511  0.2261     20     no  Study_ID \nsigma^2.2  0.2189  0.4678    298     no     ES_ID \nsigma^2.3  0.0000  0.0000      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 295) = 5690.1544, p-val &lt; .0001\n\nTest of Moderators (coefficients 1:3):\nF(df1 = 3, df2 = 295) = 3.6483, p-val = 0.0131\n\nModel Results:\n\n                               estimate      se    tval   df    pval    ci.lb \nMusic_exposure_durationAcute     0.2579  0.1109  2.3262  295  0.0207   0.0397 \nMusic_exposure_durationMedium    0.0657  0.1385  0.4743  295  0.6357  -0.2069 \nMusic_exposure_durationShort     0.2402  0.1043  2.3041  295  0.0219   0.0350 \n                                ci.ub    \nMusic_exposure_durationAcute   0.4760  * \nMusic_exposure_durationMedium  0.3383    \nMusic_exposure_durationShort   0.4454  * \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nr2MED &lt;- round(r2_ml(mMED), 4)\nr2MED\n\n   R2_marginal R2_conditional \n        0.0204         0.2059 \n\n\n\norchard_exposure&lt;-orchard_plot(mMED,\n             mod = \"Music_exposure_duration\",\n              group = \"Study_ID\",\n              xlab = \"log response ratio (lnRR)\", \n              flip = FALSE)  +\n            scale_colour_brewer(palette = \"Dark2\") +\n            scale_fill_brewer(palette = \"Set1\")+scale_y_continuous(breaks = seq(-5, 10, by = 2),\n                                                                   minor_breaks = seq(-5, 10, by = 1 ))\norchard_exposure\n\n\n\n\n\n\n\n\n\nggsave(filename = here(\"..\",\"Plots\", \"orchard_exposure_lnRR.pdf\"),\n       plot = orchard_exposure,\n       dpi = 300, device = cairo_pdf)\n\nggsave(filename = here(\"..\",\"Plots\", \"orchard_exposure_lnRR.jpg\"),\n       plot = orchard_exposure,\n       width = 9,  \n       height = 7,  \n       dpi = 300)\n\nContrasts between levels\n\nLEVELS &lt;- c(\"Acute\", \"Medium\", \"Short\")\nMOD_NAME &lt;- \"Music_exposure_duration\"\n\n\n# Model A: Reference = Acute (A vs B, A vs C)\ndb_filtered$moderator_relevel_A &lt;- relevel(db_filtered$Music_exposure_duration, ref = LEVELS[1])\nmodel_A &lt;- rma.mv(yi = lnRR,\n                  V = VCV_filtered, \n                  mods = ~ moderator_relevel_A,\n                  random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                  test = \"t\", method = \"REML\", sparse = TRUE,\n                  data = db_filtered)\nmodel_A\n\n\nMultivariate Meta-Analysis Model (k = 298; method: REML)\n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0511  0.2261     20     no  Study_ID \nsigma^2.2  0.2189  0.4678    298     no     ES_ID \nsigma^2.3  0.0000  0.0000      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 295) = 5690.1544, p-val &lt; .0001\n\nTest of Moderators (coefficients 2:3):\nF(df1 = 2, df2 = 295) = 0.6764, p-val = 0.5092\n\nModel Results:\n\n                           estimate      se     tval   df    pval    ci.lb \nintrcpt                      0.2579  0.1109   2.3262  295  0.0207   0.0397 \nmoderator_relevel_AMedium   -0.1922  0.1774  -1.0832  295  0.2796  -0.5413 \nmoderator_relevel_AShort    -0.0177  0.1522  -0.1160  295  0.9077  -0.3172 \n                            ci.ub    \nintrcpt                    0.4760  * \nmoderator_relevel_AMedium  0.1570    \nmoderator_relevel_AShort   0.2818    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n# Model B: Reference = Medium (B vs C)\ndb_filtered$moderator_relevel_B &lt;- relevel(db_filtered$Music_exposure_duration, ref = LEVELS[2])\nmodel_B &lt;- rma.mv(yi = lnRR,\n                  V = VCV_filtered, \n                  mods = ~ moderator_relevel_B,\n                  random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                  test = \"t\", method = \"REML\", sparse = TRUE,\n                  data = db_filtered)\nmodel_B\n\n\nMultivariate Meta-Analysis Model (k = 298; method: REML)\n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0511  0.2261     20     no  Study_ID \nsigma^2.2  0.2189  0.4678    298     no     ES_ID \nsigma^2.3  0.0000  0.0000      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 295) = 5690.1544, p-val &lt; .0001\n\nTest of Moderators (coefficients 2:3):\nF(df1 = 2, df2 = 295) = 0.6764, p-val = 0.5092\n\nModel Results:\n\n                          estimate      se    tval   df    pval    ci.lb \nintrcpt                     0.0657  0.1385  0.4743  295  0.6357  -0.2069 \nmoderator_relevel_BAcute    0.1922  0.1774  1.0832  295  0.2796  -0.1570 \nmoderator_relevel_BShort    0.1745  0.1734  1.0067  295  0.3149  -0.1667 \n                           ci.ub    \nintrcpt                   0.3383    \nmoderator_relevel_BAcute  0.5413    \nmoderator_relevel_BShort  0.5157    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n# Model C: Reference = Short (C estimate)\ndb_filtered$moderator_relevel_C &lt;- relevel(db_filtered$Music_exposure_duration, ref = LEVELS[3])\nmodel_C &lt;- rma.mv(yi = lnRR,\n                  V = VCV_filtered, \n                  mods = ~ moderator_relevel_C,\n                  random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                  test = \"t\", method = \"REML\", sparse = TRUE,\n                  data = db_filtered)\nmodel_C\n\n\nMultivariate Meta-Analysis Model (k = 298; method: REML)\n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0511  0.2261     20     no  Study_ID \nsigma^2.2  0.2189  0.4678    298     no     ES_ID \nsigma^2.3  0.0000  0.0000      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 295) = 5690.1544, p-val &lt; .0001\n\nTest of Moderators (coefficients 2:3):\nF(df1 = 2, df2 = 295) = 0.6764, p-val = 0.5092\n\nModel Results:\n\n                           estimate      se     tval   df    pval    ci.lb \nintrcpt                      0.2402  0.1043   2.3041  295  0.0219   0.0350 \nmoderator_relevel_CAcute     0.0177  0.1522   0.1160  295  0.9077  -0.2818 \nmoderator_relevel_CMedium   -0.1745  0.1734  -1.0067  295  0.3149  -0.5157 \n                            ci.ub    \nintrcpt                    0.4454  * \nmoderator_relevel_CAcute   0.3172    \nmoderator_relevel_CMedium  0.1667    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\n\nmEXD &lt;- rma.mv(yi = lnRR,\n                  V = VCV, \n              mods = ~ Experimental_design-1,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID, \n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db)\n\nsummary(mEXD)\n\n\nMultivariate Meta-Analysis Model (k = 299; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-246.4081   492.8162   504.8162   526.9584   505.1069   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0445  0.2109     20     no  Study_ID \nsigma^2.2  0.2164  0.4652    299     no     ES_ID \nsigma^2.3  0.0000  0.0000      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 296) = 5576.1338, p-val &lt; .0001\n\nTest of Moderators (coefficients 1:3):\nF(df1 = 3, df2 = 296) = 4.8125, p-val = 0.0027\n\nModel Results:\n\n                                                estimate      se    tval   df \nExperimental_designFactorial                      0.1711  0.0698  2.4519  296 \nExperimental_designPosttest-Only Control Group    0.3699  0.1051  3.5189  296 \nExperimental_designRepeated Measures              0.1651  0.2040  0.8096  296 \n                                                  pval    ci.lb   ci.ub      \nExperimental_designFactorial                    0.0148   0.0338  0.3084    * \nExperimental_designPosttest-Only Control Group  0.0005   0.1630  0.5768  *** \nExperimental_designRepeated Measures            0.4188  -0.2363  0.5665      \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nr2EXD &lt;- round(r2_ml(mEXD), 4)\nr2EXD\n\n   R2_marginal R2_conditional \n        0.0219         0.1888 \n\n\n\norchard_design&lt;-orchard_plot(mEXD,\n             mod = \"Experimental_design\",\n              group = \"Study_ID\",\n              xlab = \"log response ratio (lnRR)\", \n              flip=FALSE) +scale_y_continuous(breaks = seq(-5, 10, by = 2),\n                                                                  minor_breaks = seq(-5, 10, by = 1 ))\norchard_design\n\n\n\n\n\n\n\n\n\nggsave(filename = here(\"..\",\"Plots\", \"orchard_design_lnRR.pdf\"),\n       plot = orchard_design,\n       dpi = 300, device = cairo_pdf)\n\nggsave(filename = here(\"..\",\"Plots\", \"orchard_design_lnRR.jpg\"),\n       plot = orchard_design,\n       width = 9,  \n       height = 7,  \n       dpi = 300)\n\nContrasts between levels\n\n# The Generator\ncontra_mEXD &lt;- contrast_fun(data = db, \n                          response = lnRR, \n                          moderator = Experimental_design, \n                          VCV = VCV)\n# The Harvester\nt1&lt;-get_estimate(model = mEXD, contra = contra_mEXD, moderator = Experimental_design)\n# The Cleaner\nt2 &lt;- clean_unique_contrasts(full_results_table = t1, level_count = 3)\n\n\nt2\n\n# A tibble: 7 × 7\n  Levels                    Estimate Lower_CI Upper_CI P_value Lower_PI Upper_PI\n  &lt;chr&gt;                        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;\n1 Factorial                  0.171    3.38e-2 0.308    1.48e-2   -0.843    1.19 \n2 Posttest-Only Control Gr…  0.370    1.63e-1 0.577    5.01e-4   -0.656    1.40 \n3 Repeated Measures          0.165   -2.36e-1 0.567    4.19e-1   -0.917    1.25 \n4 Posttest-Only Control Gr…  0.199   -3.80e-4 0.398    5.04e-2   -0.826    1.22 \n5 Repeated Measures-Factor… -0.00597 -4.30e-1 0.418    9.78e-1   -1.10     1.09 \n6 Factorial-Posttest-Only … -0.199   -3.98e-1 0.000380 5.04e-2   -1.22     0.826\n7 Repeated Measures-Postte… -0.205   -6.56e-1 0.247    3.73e-1   -1.31     0.897\n\n\n\n\n\nmIB &lt;- rma.mv(yi = lnRR,\n                  V = VCV, \n              mods = ~ `Induced behaviour`-1,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID, \n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db)\n\nsummary(mIB)\n\n\nMultivariate Meta-Analysis Model (k = 299; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-245.0936   490.1871   500.1871   518.6558   500.3933   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0482  0.2195     20     no  Study_ID \nsigma^2.2  0.2094  0.4576    299     no     ES_ID \nsigma^2.3  0.0000  0.0000      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 297) = 5340.7378, p-val &lt; .0001\n\nTest of Moderators (coefficients 1:2):\nF(df1 = 2, df2 = 297) = 9.4196, p-val = 0.0001\n\nModel Results:\n\n                            estimate      se    tval   df    pval    ci.lb \n`Induced behaviour`Induced    0.4524  0.1055  4.2890  297  &lt;.0001   0.2448 \n`Induced behaviour`Innate     0.1300  0.0695  1.8697  297  0.0625  -0.0068 \n                             ci.ub      \n`Induced behaviour`Induced  0.6600  *** \n`Induced behaviour`Innate   0.2668    . \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nr2IB &lt;- round(r2_ml(mIB), 4)\nr2IB\n\n   R2_marginal R2_conditional \n        0.0550         0.2317 \n\n\n\norchard_behaviour&lt;-orchard_plot(mIB,\n             mod = \"Induced behaviour\",\n              group = \"Study_ID\",\n              xlab = \"log response ratio (lnRR)\", \n              flip = FALSE) +scale_y_continuous(breaks = seq(-5, 10, by = 2),\n                                                                 minor_breaks = seq(-5, 10, by = 1 ))\norchard_behaviour\n\n\n\n\n\n\n\n\n\nggsave(filename = here(\"..\",\"Plots\", \"orchard_behaviour_lnRR.pdf\"),\n       plot = orchard_behaviour,\n       dpi = 300, device = cairo_pdf)\n\nggsave(filename = here(\"..\",\"Plots\", \"orchard_behaviour_lnRR.jpg\"),\n       plot = orchard_behaviour,\n       width = 9,  \n       height = 7,  \n       dpi = 300)\n\n\nmIB &lt;- rma.mv(yi = lnRR,\n                  V = VCV, \n              mods = ~ `Induced behaviour`,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID, \n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db)\n\nsummary(mIB)\n\n\nMultivariate Meta-Analysis Model (k = 299; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-245.0936   490.1871   500.1871   518.6558   500.3933   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0482  0.2195     20     no  Study_ID \nsigma^2.2  0.2094  0.4576    299     no     ES_ID \nsigma^2.3  0.0000  0.0000      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 297) = 5340.7378, p-val &lt; .0001\n\nTest of Moderators (coefficient 2):\nF(df1 = 1, df2 = 297) = 8.8507, p-val = 0.0032\n\nModel Results:\n\n                           estimate      se     tval   df    pval    ci.lb \nintrcpt                      0.4524  0.1055   4.2890  297  &lt;.0001   0.2448 \n`Induced behaviour`Innate   -0.3225  0.1084  -2.9750  297  0.0032  -0.5358 \n                             ci.ub      \nintrcpt                     0.6600  *** \n`Induced behaviour`Innate  -0.1092   ** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\n\nmRT &lt;- rma.mv(yi = lnRR,\n                  V = VCV, \n              mods = ~ Relative_timing-1,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID, \n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db)\n\nsummary(mRT)\n\n\nMultivariate Meta-Analysis Model (k = 299; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-245.9058   491.8116   503.8116   525.9537   504.1022   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0486  0.2205     20     no  Study_ID \nsigma^2.2  0.2145  0.4631    299     no     ES_ID \nsigma^2.3  0.0000  0.0000      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 296) = 5658.5329, p-val &lt; .0001\n\nTest of Moderators (coefficients 1:3):\nF(df1 = 3, df2 = 296) = 5.1444, p-val = 0.0018\n\nModel Results:\n\n                           estimate      se     tval   df    pval    ci.lb \nRelative_timingBefore        0.2226  0.0711   3.1296  296  0.0019   0.0826 \nRelative_timingBoth          0.1856  0.1364   1.3605  296  0.1747  -0.0829 \nRelative_timingConcurrent   -0.3384  0.2410  -1.4041  296  0.1614  -0.8126 \n                            ci.ub     \nRelative_timingBefore      0.3626  ** \nRelative_timingBoth        0.4541     \nRelative_timingConcurrent  0.1359     \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nr2RT &lt;- round(r2_ml(mRT), 4)\nr2RT\n\n   R2_marginal R2_conditional \n        0.0232         0.2038 \n\n\n\norchard_plot(mRT,\n             mod = \"Relative_timing\",\n              group = \"Study_ID\",\n              xlab = \"log response ratio (lnRR)\", \n              angle = 30) \n\n\n\n\n\n\n\n\n\nmRT &lt;- rma.mv(yi = lnRR,\n                  V = VCV, \n              mods = ~ Relative_timing,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID, \n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db)\n\nsummary(mRT)\n\n\nMultivariate Meta-Analysis Model (k = 299; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-245.9058   491.8116   503.8116   525.9537   504.1022   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0486  0.2205     20     no  Study_ID \nsigma^2.2  0.2145  0.4631    299     no     ES_ID \nsigma^2.3  0.0000  0.0000      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 296) = 5658.5329, p-val &lt; .0001\n\nTest of Moderators (coefficients 2:3):\nF(df1 = 2, df2 = 296) = 2.7521, p-val = 0.0654\n\nModel Results:\n\n                           estimate      se     tval   df    pval    ci.lb \nintrcpt                      0.2226  0.0711   3.1296  296  0.0019   0.0826 \nRelative_timingBoth         -0.0370  0.1479  -0.2503  296  0.8026  -0.3280 \nRelative_timingConcurrent   -0.5610  0.2420  -2.3176  296  0.0212  -1.0373 \n                             ci.ub     \nintrcpt                     0.3626  ** \nRelative_timingBoth         0.2540     \nRelative_timingConcurrent  -0.0846   * \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\n\nmEXP &lt;- rma.mv(yi = lnRR,\n                  V = VCV, \n              mods = ~ Experimental_procedures-1,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID, \n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db)\n\nsummary(mEXP)\n\n\nMultivariate Meta-Analysis Model (k = 299; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-249.0385   498.0770   508.0770   526.5456   508.2832   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0541  0.2326     20     no  Study_ID \nsigma^2.2  0.2160  0.4648    299     no     ES_ID \nsigma^2.3  0.0000  0.0000      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 297) = 5655.8740, p-val &lt; .0001\n\nTest of Moderators (coefficients 1:2):\nF(df1 = 2, df2 = 297) = 5.0008, p-val = 0.0073\n\nModel Results:\n\n                             estimate      se    tval   df    pval    ci.lb \nExperimental_proceduresNone    0.2171  0.0689  3.1523  297  0.0018   0.0816 \nExperimental_proceduresSham    0.1236  0.1149  1.0749  297  0.2833  -0.1027 \n                              ci.ub     \nExperimental_proceduresNone  0.3527  ** \nExperimental_proceduresSham  0.3498     \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nr2EXP &lt;- round(r2_ml(mEXP), 4)\nr2EXP\n\n   R2_marginal R2_conditional \n        0.0053         0.2045 \n\n\n\norchard_plot(mEXP,\n             mod = \"Experimental_procedures\",\n              group = \"Study_ID\",\n              xlab = \"log response ratio (lnRR)\", \n              angle = 30) \n\n\n\n\n\n\n\n\n\nmEXP &lt;- rma.mv(yi = lnRR,\n                  V = VCV, \n              mods = ~ Experimental_procedures,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID, \n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db)\n\nsummary(mEXP)\n\n\nMultivariate Meta-Analysis Model (k = 299; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-249.0385   498.0770   508.0770   526.5456   508.2832   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0541  0.2326     20     no  Study_ID \nsigma^2.2  0.2160  0.4648    299     no     ES_ID \nsigma^2.3  0.0000  0.0000      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 297) = 5655.8740, p-val &lt; .0001\n\nTest of Moderators (coefficient 2):\nF(df1 = 1, df2 = 297) = 0.7682, p-val = 0.3815\n\nModel Results:\n\n                             estimate      se     tval   df    pval    ci.lb \nintrcpt                        0.2171  0.0689   3.1523  297  0.0018   0.0816 \nExperimental_proceduresSham   -0.0936  0.1068  -0.8765  297  0.3815  -0.3037 \n                              ci.ub     \nintrcpt                      0.3527  ** \nExperimental_proceduresSham  0.1165     \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\n\nmCC &lt;- rma.mv(yi = lnRR,\n                  V = VCV, \n              mods = ~ Control_conditions-1,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID, \n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db)\n\nsummary(mCC)\n\n\nMultivariate Meta-Analysis Model (k = 299; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-246.1763   492.3527   502.3527   520.8214   502.5589   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0448  0.2116     20     no  Study_ID \nsigma^2.2  0.2131  0.4617    299     no     ES_ID \nsigma^2.3  0.0000  0.0001      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 297) = 5322.2027, p-val &lt; .0001\n\nTest of Moderators (coefficients 1:2):\nF(df1 = 2, df2 = 297) = 8.6904, p-val = 0.0002\n\nModel Results:\n\n                                estimate      se    tval   df    pval   ci.lb \nControl_conditionsambiet sound    0.1811  0.0642  2.8215  297  0.0051  0.0548 \nControl_conditionswhite noise     0.4433  0.1106  4.0088  297  &lt;.0001  0.2257 \n                                 ci.ub      \nControl_conditionsambiet sound  0.3074   ** \nControl_conditionswhite noise   0.6609  *** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nr2CC &lt;- round(r2_ml(mCC), 4)\nr2CC\n\n   R2_marginal R2_conditional \n        0.0331         0.2009 \n\n\n\norchard_plot(mCC,\n             mod = \"Control_conditions\",\n              group = \"Study_ID\",\n              xlab = \"log response ratio (lnRR)\", \n              angle = 30) \n\n\n\n\n\n\n\n\n\nmCC &lt;- rma.mv(yi = lnRR,\n                  V = VCV, \n              mods = ~ Control_conditions,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID, \n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db)\n\nsummary(mCC)\n\n\nMultivariate Meta-Analysis Model (k = 299; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-246.1763   492.3527   502.3527   520.8214   502.5589   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0448  0.2116     20     no  Study_ID \nsigma^2.2  0.2131  0.4617    299     no     ES_ID \nsigma^2.3  0.0000  0.0001      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 297) = 5322.2027, p-val &lt; .0001\n\nTest of Moderators (coefficient 2):\nF(df1 = 1, df2 = 297) = 6.8896, p-val = 0.0091\n\nModel Results:\n\n                               estimate      se    tval   df    pval   ci.lb \nintrcpt                          0.1811  0.0642  2.8215  297  0.0051  0.0548 \nControl_conditionswhite noise    0.2622  0.0999  2.6248  297  0.0091  0.0656 \n                                ci.ub     \nintrcpt                        0.3074  ** \nControl_conditionswhite noise  0.4588  ** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\n\n# 1. Identify and Filter Low-K Levels\n\n\nk_counts &lt;- db %&gt;%\n  group_by(Assay_type) %&gt;%\n  summarise(k_es = n())\n\n# Identify the levels to keep (where k_es &gt;= 5)\nlevels_to_keep &lt;- k_counts %&gt;%\n  filter(k_es &gt;= 5) %&gt;%\n  pull(Assay_type)\n\n# 2. Create the Filtered Data Frame\ndb_filtered &lt;- db %&gt;%\n  filter(Assay_type %in% levels_to_keep)\n\n# 3. Subset the VCV Matrix (CRITICAL STEP)\n# Assumes VCV matrix rows/columns match the original 'db' data frame indices.\nindices_to_keep &lt;- which(db$Assay_type %in% levels_to_keep)\nVCV_filtered &lt;- VCV[indices_to_keep, indices_to_keep]\n\n\nmAT &lt;- rma.mv(yi = lnRR,\n                  V = VCV_filtered, \n              mods = ~ Assay_type-1,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID, \n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db_filtered)\n\nsummary(mAT)\n\n\nMultivariate Meta-Analysis Model (k = 290; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-234.3518   468.7035   486.7035   519.5443   487.3605   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0309  0.1758     20     no  Study_ID \nsigma^2.2  0.2134  0.4620    290     no     ES_ID \nsigma^2.3  0.0040  0.0634      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 284) = 5402.4612, p-val &lt; .0001\n\nTest of Moderators (coefficients 1:6):\nF(df1 = 6, df2 = 284) = 3.8363, p-val = 0.0011\n\nModel Results:\n\n                                         estimate      se    tval   df    pval \nAssay_typeElevated Plus Maze               0.2817  0.0799  3.5271  284  0.0005 \nAssay_typeForced Swim Test (FST)           0.3137  0.1102  2.8469  284  0.0047 \nAssay_typeLight-Dark Box                   0.5529  0.1487  3.7195  284  0.0002 \nAssay_typeOpen Field Test                  0.0662  0.0826  0.8012  284  0.4237 \nAssay_typeSucrose Preference Test (SPT)    0.0790  0.1486  0.5318  284  0.5953 \nAssay_typeTail Suspension Test (TST)       0.0939  0.1977  0.4750  284  0.6352 \n                                           ci.lb   ci.ub      \nAssay_typeElevated Plus Maze              0.1245  0.4388  *** \nAssay_typeForced Swim Test (FST)          0.0968  0.5307   ** \nAssay_typeLight-Dark Box                  0.2603  0.8455  *** \nAssay_typeOpen Field Test                -0.0964  0.2287      \nAssay_typeSucrose Preference Test (SPT)  -0.2135  0.3715      \nAssay_typeTail Suspension Test (TST)     -0.2952  0.4830      \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nr2AT &lt;- round(r2_ml(mAT), 4)\nr2AT\n\n   R2_marginal R2_conditional \n        0.0728         0.2031 \n\n\n\norchard_plot(mAT,\n             mod = \"Assay_type\",\n              group = \"Study_ID\",\n              xlab = \"log response ratio (lnRR)\", \n              angle = 30) \n\n\n\n\n\n\n\n\n\nmAT &lt;- rma.mv(yi = lnRR,\n                  V = VCV_filtered, \n              mods = ~ Assay_type,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID, \n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db_filtered)\n\nsummary(mAT)\n\n\nMultivariate Meta-Analysis Model (k = 290; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-234.3518   468.7035   486.7035   519.5443   487.3605   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0309  0.1758     20     no  Study_ID \nsigma^2.2  0.2134  0.4620    290     no     ES_ID \nsigma^2.3  0.0040  0.0634      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 284) = 5402.4612, p-val &lt; .0001\n\nTest of Moderators (coefficients 2:6):\nF(df1 = 5, df2 = 284) = 2.8417, p-val = 0.0160\n\nModel Results:\n\n                                         estimate      se     tval   df    pval \nintrcpt                                    0.2817  0.0799   3.5271  284  0.0005 \nAssay_typeForced Swim Test (FST)           0.0321  0.1096   0.2928  284  0.7699 \nAssay_typeLight-Dark Box                   0.2712  0.1333   2.0348  284  0.0428 \nAssay_typeOpen Field Test                 -0.2155  0.0812  -2.6528  284  0.0084 \nAssay_typeSucrose Preference Test (SPT)   -0.2026  0.1553  -1.3044  284  0.1932 \nAssay_typeTail Suspension Test (TST)      -0.1878  0.2024  -0.9278  284  0.3543 \n                                           ci.lb    ci.ub      \nintrcpt                                   0.1245   0.4388  *** \nAssay_typeForced Swim Test (FST)         -0.1837   0.2478      \nAssay_typeLight-Dark Box                  0.0089   0.5336    * \nAssay_typeOpen Field Test                -0.3754  -0.0556   ** \nAssay_typeSucrose Preference Test (SPT)  -0.5084   0.1031      \nAssay_typeTail Suspension Test (TST)     -0.5861   0.2106      \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Uni-moderators</span>"
    ]
  },
  {
    "objectID": "multi_moderator.html",
    "href": "multi_moderator.html",
    "title": "Multi_moderator",
    "section": "",
    "text": "Setup and Collinearity Check\nIn this chapter, we move from single-variable analysis to a Multi-Moderator Meta-Regression. This allows us to determine which factors drive the effect size when controlling for others, helping us disentangle overlapping influences\nFirst, we check if our moderators are too similar to each other (multicollinearity). Since our variables are categorical, we use Goodman-Kruskal’s Tau instead of standard correlations.\n# Load libraries and data\npacman::p_load(DT, dtplyr, here, knitr, tidyverse, patchwork, metafor, orchaRd, GoodmanKruskal)\n\ndb &lt;- readr::read_csv(here(\"..\",\"data\",\"db_lnRR.csv\")) %&gt;%\n  mutate(across(c(C_n, Ex_n, C_mean, Ex_mean, C_SE, Ex_SE, C_SD, Ex_SD), as.numeric)) %&gt;%\n  mutate(across(where(is.character), as.factor))\n\n# Define the list of moderators we want to test\nmoderators_to_check &lt;- c(\n  \"Outcome_type\", \"Lifestage_exposure\", \"Sex\", \"Meta_genre\", \n  \"Music_exposure_duration\", \"Experimental_design\", \"Induced behaviour\", \n  \"Relative_timing\", \"Experimental_procedures\", \"Control_conditions\", \"Assay_type\"\n)\n\n# Subset data to just these columns\ndat_mods &lt;- db %&gt;% dplyr::select(all_of(moderators_to_check))\n\n# Calculate categorical association (GK Tau)\ncorr_cat &lt;- GKtauDataframe(dat_mods)\n\n# Plot the association heatmap\nplot(corr_cat)",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Multi_moderator</span>"
    ]
  },
  {
    "objectID": "multi_moderator.html#matrix-calculation-sequential-filtering",
    "href": "multi_moderator.html#matrix-calculation-sequential-filtering",
    "title": "Multi_moderator",
    "section": "Matrix Calculation & Sequential Filtering",
    "text": "Matrix Calculation & Sequential Filtering\n\n\n\n\n\n\nImportant\n\n\n\nRunning a multi-moderator model requires a dataset where every included study has valid data for every moderator in the model.The code below performs a strict filter:It iterates through all intended moderators.It removes any level with \\(k &lt; 5\\).It updates the dataset, meaning a study is only kept if it survives the filter for all variables simultaneously.Finally, it subsets the VCV matrix to match this reduced dataset perfectly.\n\n\n\n# 1. Calculate the initial Variance-Covariance Matrix\nVCV &lt;- metafor::vcalc(\n  vi = lnRR_var,\n  cluster = Cohort_ID, \n  obs = ES_ID,         \n  rho = 0.5,            \n  data = db \n)\n\n# Moderators to include in the final model\nmoderators &lt;- c(\"Lifestage_exposure\", \"Sex\", \"Meta_genre\", \n  \"Music_exposure_duration\", \"Experimental_design\", \n  \"Induced behaviour\", \"Relative_timing\", \"Experimental_procedures\", \n  \"Control_conditions\", \"Assay_type\")\n\n# Initialize filtered dataset\ndb_final &lt;- db\n\n# --- Strict Sequential Filtering Loop ---\nfor (mod in moderators) {\n  \n  mod_sym &lt;- sym(mod) \n  \n  # Count k per level in the CURRENTLY filtered dataframe\n  k_counts &lt;- db_final %&gt;%\n    group_by(!!mod_sym) %&gt;%\n    summarise(k_es = n(), .groups = 'drop')\n\n  # Keep levels with sufficient data (k &gt;= 5)\n  levels_to_keep_mod &lt;- k_counts %&gt;%\n    filter(k_es &gt;= 5) %&gt;%\n    pull(!!mod_sym)\n\n  # Update the dataframe\n  db_final &lt;- db_final %&gt;%\n    filter(!!mod_sym %in% levels_to_keep_mod)\n}\n\n# --- Final Cleanup ---\n\n# Drop unused factor levels\ndb_final &lt;- db_final %&gt;% mutate(across(all_of(moderators), droplevels))\n\n# Match the VCV matrix to the new data indices\nindices_to_keep &lt;- which(db$ES_ID %in% db_final$ES_ID) \nVCV_final &lt;- VCV[indices_to_keep, indices_to_keep]\n\nprint(paste(\"Final dataset size:\", nrow(db_final), \"ES_IDs\"))\n\n[1] \"Final dataset size: 286 ES_IDs\"",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Multi_moderator</span>"
    ]
  },
  {
    "objectID": "multi_moderator.html#model-selection-backward-elimination",
    "href": "multi_moderator.html#model-selection-backward-elimination",
    "title": "Multi_moderator",
    "section": "Model Selection (Backward Elimination)",
    "text": "Model Selection (Backward Elimination)\n\n\n\n\n\n\nTip\n\n\n\nThe code below follows a manual Backward Elimination process:\n\nFull Model: We run the model with all predictors.\nAssess: We check the results (AIC, \\(R^2\\), p-values).\nDrop Weakest: We identify the variable contributing the least (highest p-value or negligible \\(R^2\\) contribution) and remove it.\nRepeat: We re-run the model and repeat until we have the “Best” parsimonious model.\n\n\n\n\nStep 1: the full model\n\n#| label: model_full\n\nmMULTI &lt;- rma.mv(yi = lnRR, V = VCV_final, \n                 mods = ~ Lifestage_exposure + Assay_type + `Induced behaviour` +\n                          Sex + Meta_genre + Music_exposure_duration +\n                          Experimental_design + Relative_timing +\n                          Experimental_procedures + Control_conditions,\n                 random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                 test = \"t\", method = \"REML\", sparse = TRUE, data = db_final)\n\nsummary(mMULTI)\n\n\nMultivariate Meta-Analysis Model (k = 286; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-203.7786   407.5572   461.5572   557.9025   468.0188   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0000  0.0000     19     no  Study_ID \nsigma^2.2  0.1976  0.4445    286     no     ES_ID \nsigma^2.3  0.0339  0.1841      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 262) = 4102.9661, p-val &lt; .0001\n\nTest of Moderators (coefficients 2:24):\nF(df1 = 23, df2 = 262) = 3.3166, p-val &lt; .0001\n\nModel Results:\n\n                                                estimate      se     tval   df \nintrcpt                                           0.4535  0.3166   1.4324  262 \nLifestage_exposureAdult                          -0.0305  0.1917  -0.1593  262 \nLifestage_exposureJuvenile                       -0.0855  0.1991  -0.4293  262 \nLifestage_exposureMixed                          -0.1331  0.2267  -0.5871  262 \nLifestage_exposureUnclear                        -0.3543  0.2722  -1.3017  262 \nLifestage_exposureYoung adult                    -0.0297  0.1744  -0.1705  262 \nAssay_typeForced Swim Test (FST)                  0.1189  0.1098   1.0828  262 \nAssay_typeLight-Dark Box                          0.2431  0.1349   1.8012  262 \nAssay_typeOpen Field Test                        -0.2019  0.0806  -2.5058  262 \nAssay_typeSucrose Preference Test (SPT)          -0.2968  0.1594  -1.8626  262 \nAssay_typeTail Suspension Test (TST)             -0.0780  0.2292  -0.3405  262 \n`Induced behaviour`Innate                        -0.3696  0.1146  -3.2255  262 \nSexMale                                          -0.1766  0.0987  -1.7892  262 \nMeta_genrePopular Contemporary Music             -0.1979  0.2455  -0.8063  262 \nMeta_genreTraditional Music / Folk / World       -0.5482  0.3458  -1.5854  262 \nMeta_genreWestern Art Music / Orchestral          0.0661  0.1935   0.3415  262 \nMusic_exposure_durationMedium                     0.1211  0.1958   0.6185  262 \nMusic_exposure_durationShort                      0.2443  0.1781   1.3720  262 \nExperimental_designPosttest-Only Control Group    0.5775  0.2299   2.5119  262 \nExperimental_designRepeated Measures             -0.1358  0.1992  -0.6815  262 \nRelative_timingBoth                              -0.0112  0.1420  -0.0789  262 \nRelative_timingConcurrent                        -0.4952  0.2321  -2.1338  262 \nExperimental_proceduresSham                       0.0914  0.2117   0.4317  262 \nControl_conditionswhite noise                     0.2410  0.0998   2.4144  262 \n                                                  pval    ci.lb    ci.ub     \nintrcpt                                         0.1532  -0.1699   1.0769     \nLifestage_exposureAdult                         0.8735  -0.4079   0.3469     \nLifestage_exposureJuvenile                      0.6681  -0.4776   0.3066     \nLifestage_exposureMixed                         0.5576  -0.5795   0.3133     \nLifestage_exposureUnclear                       0.1942  -0.8902   0.1816     \nLifestage_exposureYoung adult                   0.8648  -0.3731   0.3136     \nAssay_typeForced Swim Test (FST)                0.2799  -0.0973   0.3351     \nAssay_typeLight-Dark Box                        0.0728  -0.0226   0.5088   . \nAssay_typeOpen Field Test                       0.0128  -0.3605  -0.0432   * \nAssay_typeSucrose Preference Test (SPT)         0.0636  -0.6106   0.0170   . \nAssay_typeTail Suspension Test (TST)            0.7337  -0.5292   0.3732     \n`Induced behaviour`Innate                       0.0014  -0.5953  -0.1440  ** \nSexMale                                         0.0747  -0.3710   0.0178   . \nMeta_genrePopular Contemporary Music            0.4208  -0.6813   0.2854     \nMeta_genreTraditional Music / Folk / World      0.1141  -1.2291   0.1327     \nMeta_genreWestern Art Music / Orchestral        0.7330  -0.3149   0.4470     \nMusic_exposure_durationMedium                   0.5368  -0.2644   0.5066     \nMusic_exposure_durationShort                    0.1712  -0.1063   0.5949     \nExperimental_designPosttest-Only Control Group  0.0126   0.1248   1.0302   * \nExperimental_designRepeated Measures            0.4961  -0.5281   0.2565     \nRelative_timingBoth                             0.9372  -0.2908   0.2684     \nRelative_timingConcurrent                       0.0338  -0.9522  -0.0382   * \nExperimental_proceduresSham                     0.6663  -0.3255   0.5083     \nControl_conditionswhite noise                   0.0164   0.0444   0.4375   * \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nround(r2_ml(mMULTI), 4)\n\n   R2_marginal R2_conditional \n        0.2790         0.3845 \n\n\n\n\nStep 2: Testing Removals\nWe now re-run the model removing one variable at a time to see how it affects model fit.\n\n\nTest: Removing Sex\n# Removed: Sex\nmMULTI &lt;- rma.mv(yi = lnRR, V = VCV_final, \n                 mods = ~ Lifestage_exposure + \n                   Assay_type + \n                   `Induced behaviour` +\n                          # Sex +  &lt;-- REMOVED\n                          Meta_genre +\n                   Music_exposure_duration +\n                          Experimental_design +\n                   Relative_timing +\n                          Experimental_procedures +\n                   Control_conditions,\n                 random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                 test = \"t\", method = \"REML\", sparse = TRUE, data = db_final)\n\nround(r2_ml(mMULTI), 4)\n\n\n   R2_marginal R2_conditional \n        0.2745         0.3469 \n\n\n\n\nTest: Removing Meta_genre\n# Removed:  Meta_genre\nmMULTI &lt;- rma.mv(yi = lnRR, V = VCV_final, \n                 mods = ~ Lifestage_exposure + \n                   Assay_type + \n                   `Induced behaviour` +\n                          Sex +\n                          # Meta_genre + &lt;-- REMOVED\n                          Music_exposure_duration +\n                          Experimental_design +\n                   Relative_timing +\n                          Experimental_procedures + \n                   Control_conditions,\n                 random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                 test = \"t\", method = \"REML\", sparse = TRUE, data = db_final)\n\nround(r2_ml(mMULTI), 4)\n\n\n   R2_marginal R2_conditional \n        0.2562         0.3573 \n\n\n\n\nTest: Removing Music Duration\n# Removed: Music_exposure_duration\nmMULTI &lt;- rma.mv(yi = lnRR, V = VCV_final, \n                 mods = ~ Lifestage_exposure +\n                   Assay_type +\n                   `Induced behaviour` +\n                          Sex +\n                   Meta_genre + \n                          # Music_exposure_duration + &lt;-- REMOVED\n                          Experimental_design + \n                   Relative_timing +\n                          Experimental_procedures + \n                   Control_conditions,\n                 random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                 test = \"t\", method = \"REML\", sparse = TRUE, data = db_final)\n\nround(r2_ml(mMULTI), 4)\n\n\n   R2_marginal R2_conditional \n        0.2806         0.3626 \n\n\n\n\nTest: Removing Experimental_design\n# Removed: Experimental_design\nmMULTI &lt;- rma.mv(yi = lnRR, V = VCV_final, \n                 mods = ~ Lifestage_exposure +\n                   Assay_type +\n                   `Induced behaviour` +\n                          Sex +\n                   Meta_genre + \n                           Music_exposure_duration + \n                          #Experimental_design + &lt;-- REMOVED\n                   Relative_timing +\n                          Experimental_procedures + \n                   Control_conditions,\n                 random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                 test = \"t\", method = \"REML\", sparse = TRUE, data = db_final)\n\nround(r2_ml(mMULTI), 4)\n\n\n   R2_marginal R2_conditional \n        0.2136         0.3626 \n\n\n\n\nTest: Removing relative_timing\n# Removed: relative_timing\nmMULTI &lt;- rma.mv(yi = lnRR, V = VCV_final, \n                 mods = ~ Lifestage_exposure +\n                   Assay_type +\n                   `Induced behaviour` +\n                          Sex +\n                   Meta_genre + \n                           Music_exposure_duration + \n                          Experimental_design + \n                   #Relative_timing + &lt;-- REMOVED\n                          Experimental_procedures + \n                   Control_conditions,\n                 random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                 test = \"t\", method = \"REML\", sparse = TRUE, data = db_final)\n\nround(r2_ml(mMULTI), 4)\n\n\n   R2_marginal R2_conditional \n        0.2681         0.3822 \n\n\n\n\nTest: Removing Experimental_procedures\n# Removed: Experimental_procedures\nmMULTI &lt;- rma.mv(yi = lnRR, V = VCV_final, \n                 mods = ~ Lifestage_exposure +\n                   Assay_type +\n                   `Induced behaviour` +\n                          Sex +\n                   Meta_genre + \n                           Music_exposure_duration + \n                          Experimental_design + \n                   Relative_timing + \n                          #Experimental_procedures + &lt;-- REMOVED\n                   Control_conditions,\n                 random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                 test = \"t\", method = \"REML\", sparse = TRUE, data = db_final)\n\nround(r2_ml(mMULTI), 4)\n\n\n   R2_marginal R2_conditional \n        0.2792         0.3734 \n\n\n\n\nTest: Removing control_conditions\n# Removed: control_conditions\nmMULTI &lt;- rma.mv(yi = lnRR, V = VCV_final, \n                 mods = ~ Lifestage_exposure +\n                   Assay_type +\n                   `Induced behaviour` +\n                          Sex +\n                   Meta_genre + \n                           Music_exposure_duration + \n                          Experimental_design + \n                   Relative_timing + \n                          Experimental_procedures, \n                   #Control_conditions&lt;-- REMOVED,\n                 random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                 test = \"t\", method = \"REML\", sparse = TRUE, data = db_final)\n\nround(r2_ml(mMULTI), 4)\n\n\n   R2_marginal R2_conditional \n        0.2531         0.3490",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Multi_moderator</span>"
    ]
  },
  {
    "objectID": "multi_moderator.html#round-2",
    "href": "multi_moderator.html#round-2",
    "title": "Multi_moderator",
    "section": "Round 2",
    "text": "Round 2\nFirst, let’s establish our new “Current Best” model and record its \\(R^2\\) and AIC\n\n# BASELINE ROUND 2: Everything EXCEPT Music_exposure_duration\nmMULTI_R2 &lt;- rma.mv(yi = lnRR, V = VCV_final, \n                 mods = ~ Lifestage_exposure + \n                   Assay_type + \n                   `Induced behaviour` +\n                          Sex + Meta_genre + \n                          # Music_exposure_duration +  &lt;-- CONFIRMED REMOVED\n                          Experimental_design +\n                   Relative_timing +\n                          Experimental_procedures + \n                   Control_conditions,\n                 random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                 test = \"t\", method = \"REML\", sparse = TRUE, data = db_final)\n\nprint(\"--- Baseline Round 2 Stats ---\")\n\n[1] \"--- Baseline Round 2 Stats ---\"\n\nround(r2_ml(mMULTI_R2), 4)\n\n   R2_marginal R2_conditional \n        0.2806         0.3626",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Multi_moderator</span>"
    ]
  },
  {
    "objectID": "multi_moderator.html#test-2.1-remove-sex",
    "href": "multi_moderator.html#test-2.1-remove-sex",
    "title": "Multi_moderator",
    "section": "Test 2.1: Remove Sex",
    "text": "Test 2.1: Remove Sex\nDoes removing Sex improve the model further?\n\nmodel_no_sex &lt;- rma.mv(yi = lnRR, V = VCV_final, \n                 mods = ~ Lifestage_exposure + Assay_type + `Induced behaviour` +\n                          # Sex +  &lt;-- REMOVING THIS\n                          Meta_genre + \n                          Experimental_design + Relative_timing +\n                          Experimental_procedures + Control_conditions,\n                 random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                 test = \"t\", method = \"REML\", sparse = TRUE, data = db_final)\n\n# Compare to Baseline Round 2\nround(r2_ml(model_no_sex), 4)\n\n   R2_marginal R2_conditional \n        0.2760         0.3372",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Multi_moderator</span>"
    ]
  },
  {
    "objectID": "multi_moderator.html#test-2.2-remove-meta_genre",
    "href": "multi_moderator.html#test-2.2-remove-meta_genre",
    "title": "Multi_moderator",
    "section": "Test 2.2: Remove Meta_genre",
    "text": "Test 2.2: Remove Meta_genre\n\nmodel_no_genre &lt;- rma.mv(yi = lnRR, V = VCV_final, \n                 mods = ~ Lifestage_exposure + Assay_type + `Induced behaviour` +\n                          Sex + \n                          # Meta_genre + &lt;-- REMOVING THIS\n                          Experimental_design + Relative_timing +\n                          Experimental_procedures + Control_conditions,\n                 random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                 test = \"t\", method = \"REML\", sparse = TRUE, data = db_final)\n\nround(r2_ml(model_no_genre), 4)\n\n   R2_marginal R2_conditional \n        0.2667         0.3519",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Multi_moderator</span>"
    ]
  },
  {
    "objectID": "multi_moderator.html#test-2.3-remove-experimental_design",
    "href": "multi_moderator.html#test-2.3-remove-experimental_design",
    "title": "Multi_moderator",
    "section": "Test 2.3: Remove Experimental_design",
    "text": "Test 2.3: Remove Experimental_design\n\nmodel_no_design &lt;- rma.mv(yi = lnRR, V = VCV_final, \n                 mods = ~ Lifestage_exposure + Assay_type + `Induced behaviour` +\n                          Sex + Meta_genre + \n                          # Experimental_design + &lt;-- REMOVING THIS\n                          Relative_timing +\n                          Experimental_procedures + Control_conditions,\n                 random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                 test = \"t\", method = \"REML\", sparse = TRUE, data = db_final)\n\nround(r2_ml(model_no_design), 4)\n\n   R2_marginal R2_conditional \n        0.2087         0.3483",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Multi_moderator</span>"
    ]
  },
  {
    "objectID": "multi_moderator.html#test-2.4-remove-relative_timing",
    "href": "multi_moderator.html#test-2.4-remove-relative_timing",
    "title": "Multi_moderator",
    "section": "Test 2.4: Remove Relative_timing",
    "text": "Test 2.4: Remove Relative_timing\n\nmodel_no_timing &lt;- rma.mv(yi = lnRR, V = VCV_final, \n                 mods = ~ Lifestage_exposure + Assay_type + `Induced behaviour` +\n                          Sex + Meta_genre + \n                          Experimental_design + \n                          # Relative_timing + &lt;-- REMOVING THIS\n                          Experimental_procedures + Control_conditions,\n                 random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                 test = \"t\", method = \"REML\", sparse = TRUE, data = db_final)\n\nround(r2_ml(model_no_timing), 4)\n\n   R2_marginal R2_conditional \n        0.2730         0.3696",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Multi_moderator</span>"
    ]
  },
  {
    "objectID": "multi_moderator.html#test-2.5-remove-control_conditions",
    "href": "multi_moderator.html#test-2.5-remove-control_conditions",
    "title": "Multi_moderator",
    "section": "Test 2.5: Remove Control_conditions",
    "text": "Test 2.5: Remove Control_conditions\n\nmodel_no_control &lt;- rma.mv(yi = lnRR, V = VCV_final, \n                 mods = ~ Lifestage_exposure + Assay_type + `Induced behaviour` +\n                          Sex + Meta_genre + \n                          Experimental_design + Relative_timing +\n                          Experimental_procedures, \n                          # Control_conditions + &lt;-- REMOVING THIS\n                 random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                 test = \"t\", method = \"REML\", sparse = TRUE, data = db_final)\n\nround(r2_ml(model_no_control), 4)\n\n   R2_marginal R2_conditional \n        0.2570         0.3277",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Multi_moderator</span>"
    ]
  },
  {
    "objectID": "multi_moderator.html#step-3-the-best-model",
    "href": "multi_moderator.html#step-3-the-best-model",
    "title": "Multi_moderator",
    "section": "Step 3: The “Best” Model",
    "text": "Step 3: The “Best” Model\nAfter comparing the models above, we settle on this final specification.\n\n#| label: best_model_minus_duration\n#| code-fold: true\n#| code-summary: \"Test: Removing Music Duration\"\n\n# Removed: Music_exposure_duration\nmMULTI &lt;- rma.mv(yi = lnRR, V = VCV_final, \n                 mods = ~ Lifestage_exposure +\n                   Assay_type +\n                   `Induced behaviour` +\n                          Sex +\n                   Meta_genre + \n                          # Music_exposure_duration + &lt;-- REMOVED\n                          Experimental_design + \n                   Relative_timing +\n                          Experimental_procedures + \n                   Control_conditions,\n                 random = list(~1 | Study_ID, ~1 | ES_ID, ~1 | Strain),\n                 test = \"t\", method = \"REML\", sparse = TRUE, data = db_final)\n\nround(r2_ml(mMULTI), 4)\n\n   R2_marginal R2_conditional \n        0.2806         0.3626 \n\n\n\nsummary(mMULTI)\n\n\nMultivariate Meta-Analysis Model (k = 286; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-205.7153   411.4305   461.4305   550.8292   466.8927   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0020  0.0447     19     no  Study_ID \nsigma^2.2  0.1965  0.4433    286     no     ES_ID \nsigma^2.3  0.0233  0.1525      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 264) = 4166.4606, p-val &lt; .0001\n\nTest of Moderators (coefficients 2:22):\nF(df1 = 21, df2 = 264) = 3.3567, p-val &lt; .0001\n\nModel Results:\n\n                                                estimate      se     tval   df \nintrcpt                                           0.6595  0.2733   2.4130  264 \nLifestage_exposureAdult                          -0.0367  0.1904  -0.1930  264 \nLifestage_exposureJuvenile                       -0.0785  0.1985  -0.3954  264 \nLifestage_exposureMixed                          -0.0679  0.2206  -0.3076  264 \nLifestage_exposureUnclear                        -0.2959  0.2647  -1.1178  264 \nLifestage_exposureYoung adult                     0.0187  0.1695   0.1102  264 \nAssay_typeForced Swim Test (FST)                  0.1209  0.1079   1.1205  264 \nAssay_typeLight-Dark Box                          0.2394  0.1344   1.7808  264 \nAssay_typeOpen Field Test                        -0.1909  0.0794  -2.4042  264 \nAssay_typeSucrose Preference Test (SPT)          -0.2641  0.1567  -1.6856  264 \nAssay_typeTail Suspension Test (TST)             -0.0580  0.2283  -0.2540  264 \n`Induced behaviour`Innate                        -0.3708  0.1124  -3.2976  264 \nSexMale                                          -0.1646  0.0978  -1.6832  264 \nMeta_genrePopular Contemporary Music             -0.2952  0.2353  -1.2548  264 \nMeta_genreTraditional Music / Folk / World       -0.4405  0.3293  -1.3375  264 \nMeta_genreWestern Art Music / Orchestral         -0.0574  0.1639  -0.3504  264 \nExperimental_designPosttest-Only Control Group    0.4801  0.2086   2.3019  264 \nExperimental_designRepeated Measures             -0.1798  0.1869  -0.9621  264 \nRelative_timingBoth                              -0.0625  0.1340  -0.4665  264 \nRelative_timingConcurrent                        -0.5085  0.2315  -2.1962  264 \nExperimental_proceduresSham                       0.0149  0.1943   0.0769  264 \nControl_conditionswhite noise                     0.2387  0.0996   2.3974  264 \n                                                  pval    ci.lb    ci.ub     \nintrcpt                                         0.0165   0.1213   1.1976   * \nLifestage_exposureAdult                         0.8471  -0.4115   0.3381     \nLifestage_exposureJuvenile                      0.6929  -0.4693   0.3123     \nLifestage_exposureMixed                         0.7586  -0.5021   0.3664     \nLifestage_exposureUnclear                       0.2647  -0.8171   0.2253     \nLifestage_exposureYoung adult                   0.9124  -0.3151   0.3524     \nAssay_typeForced Swim Test (FST)                0.2635  -0.0915   0.3333     \nAssay_typeLight-Dark Box                        0.0761  -0.0253   0.5041   . \nAssay_typeOpen Field Test                       0.0169  -0.3473  -0.0346   * \nAssay_typeSucrose Preference Test (SPT)         0.0931  -0.5725   0.0444   . \nAssay_typeTail Suspension Test (TST)            0.7997  -0.5074   0.3915     \n`Induced behaviour`Innate                       0.0011  -0.5921  -0.1494  ** \nSexMale                                         0.0935  -0.3571   0.0279   . \nMeta_genrePopular Contemporary Music            0.2107  -0.7584   0.1680     \nMeta_genreTraditional Music / Folk / World      0.1822  -1.0889   0.2080     \nMeta_genreWestern Art Music / Orchestral        0.7263  -0.3801   0.2653     \nExperimental_designPosttest-Only Control Group  0.0221   0.0694   0.8907   * \nExperimental_designRepeated Measures            0.3369  -0.5478   0.1882     \nRelative_timingBoth                             0.6412  -0.3265   0.2014     \nRelative_timingConcurrent                       0.0289  -0.9643  -0.0526   * \nExperimental_proceduresSham                     0.9388  -0.3677   0.3976     \nControl_conditionswhite noise                   0.0172   0.0427   0.4348   * \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Multi_moderator</span>"
    ]
  },
  {
    "objectID": "publication_bias.html",
    "href": "publication_bias.html",
    "title": "Publication bias",
    "section": "",
    "text": "Visual inspection: funnel plots\nFirst, we reload the data and run a simple intercept-only model (ma_all) to establish the overall mean effect size, which acts as the centerline for our funnel plots.\n# funnel plot - standard error\nfunnel(ma_all, yaxis = \"sei\",\n      xlab = \"Standarised residuals\",\n      ylab = \"Precision (inverse of SE)\" )\n# funnel plot - inverse of standard error\nfunnel(ma_all, yaxis = \"seinv\",\n      xlab = \"Standarised residuals\",\n      ylab = \"Precision (inverse of SE)\",  col = c(alpha(\"orange\", 0.5)))",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Publication bias</span>"
    ]
  },
  {
    "objectID": "publication_bias.html#eggers-regression-testing-small-study-effects",
    "href": "publication_bias.html#eggers-regression-testing-small-study-effects",
    "title": "Publication bias",
    "section": "Egger’s Regression (Testing Small-Study Effects)",
    "text": "Egger’s Regression (Testing Small-Study Effects)\nVisual inspection is subjective. Egger’s Regression formally tests if the effect size depends on the sample size (or precision). If the slope is significant, it means small studies are systematically different from large ones (often due to bias).\n\n# 1. Calculate the effective sample size term (sqrt_inv_e_n)\n# Formula: sqrt(2/Ex_n + 2/C_n) approximates the standard error based on N\ndt_egger_full &lt;- db %&gt;%\n  mutate(sqrt_inv_e_n = sqrt((2 / Ex_n) + (2 / C_n)))\n\n# 2. Run the Meta-Regression\n# If 'sqrt_inv_e_n' is significant (p &lt; 0.05), we have evidence of small-study effects.\negger_model_full &lt;- rma.mv(yi = lnRR,\n                           V = VCV, \n                           mods = ~ 1 + sqrt_inv_e_n, # The 'Egger' predictor\n                           random = list(~1 | Study_ID, ~1 | ES_ID), \n                           test = \"z\",       \n                           method = \"REML\",\n                           sparse = TRUE,\n                           data = dt_egger_full)\n\nsummary(egger_model_full)\n\n\nMultivariate Meta-Analysis Model (k = 299; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-248.8676   497.7352   505.7352   520.5101   505.8721   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0425  0.2061     20     no  Study_ID \nsigma^2.2  0.2193  0.4683    299     no     ES_ID \n\nTest for Residual Heterogeneity:\nQE(df = 297) = 5720.8055, p-val &lt; .0001\n\nTest of Moderators (coefficient 2):\nQM(df = 1) = 0.5982, p-val = 0.4393\n\nModel Results:\n\n              estimate      se     zval    pval    ci.lb   ci.ub    \nintrcpt        -0.1114  0.4161  -0.2677  0.7889  -0.9269  0.7041    \nsqrt_inv_e_n    0.4777  0.6177   0.7735  0.4393  -0.7329  1.6884    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nbubble_plot(egger_model_full,\n            mod = \"sqrt_inv_e_n\",\n            group = \"Study_ID\",\n            xlab = \"Square root of inverse of effective sample size\")",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Publication bias</span>"
    ]
  },
  {
    "objectID": "publication_bias.html#decline-effect-time-lag-bias",
    "href": "publication_bias.html#decline-effect-time-lag-bias",
    "title": "Publication bias",
    "section": "Decline Effect (Time-Lag Bias)",
    "text": "Decline Effect (Time-Lag Bias)\nOften in science, early studies show large effects (novelty bias), but as time goes on and methods improve (or replication attempts increase), the effect size shrinks. This is called the Decline Effect or Time-Lag Bias.\nWe test this by adding Publication Year to the model. A significant negative slope indicates the effect is shrinking over time.\n\n# 1. Mean-Center the Year (Interpretation: Intercept = Effect in average year)\ndb_decline &lt;- dt_egger_full %&gt;%\n  mutate(Year_c = Year - mean(Year, na.rm = TRUE))\n\n# 2. Run model: Controlling for Precision (Egger) AND Year simultaneously\nyear_lag_model &lt;- rma.mv(yi = lnRR,\n                         V = VCV, \n                         mods = ~ 1 + Year_c + sqrt_inv_e_n, \n                         random = list(~1 | Study_ID, ~1 | ES_ID), \n                         test = \"t\", \n                         method = \"REML\",\n                         sparse = TRUE,\n                         data = db_decline)\n\nsummary(year_lag_model)\n\n\nMultivariate Meta-Analysis Model (k = 299; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-247.7272   495.4544   505.4544   523.9061   505.6612   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0471  0.2169     20     no  Study_ID \nsigma^2.2  0.2191  0.4681    299     no     ES_ID \n\nTest for Residual Heterogeneity:\nQE(df = 296) = 5707.4822, p-val &lt; .0001\n\nTest of Moderators (coefficients 2:3):\nF(df1 = 2, df2 = 296) = 0.2994, p-val = 0.7415\n\nModel Results:\n\n              estimate      se     tval   df    pval    ci.lb   ci.ub    \nintrcpt        -0.0871  0.4254  -0.2047  296  0.8380  -0.9242  0.7501    \nYear_c          0.0046  0.0122   0.3763  296  0.7070  -0.0195  0.0287    \nsqrt_inv_e_n    0.4299  0.6303   0.6821  296  0.4957  -0.8105  1.6704    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nbubble_plot(year_lag_model,\n            mod = \"Year_c\",\n            group = \"Study_ID\",\n            xlab = \"Year of publication\")",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Publication bias</span>"
    ]
  },
  {
    "objectID": "publication_bias.html#reporting-quality-as-a-moderator-of-decline-effect",
    "href": "publication_bias.html#reporting-quality-as-a-moderator-of-decline-effect",
    "title": "Publication bias",
    "section": "Reporting Quality as a Moderator of Decline Effect",
    "text": "Reporting Quality as a Moderator of Decline Effect\n\n# 1. Center the Quality Score\ndb_decline &lt;- db_decline %&gt;%\n  mutate(quality_c = Reporting_quality - mean(Reporting_quality, na.rm = TRUE))\n\n# 2. Run the comprehensive bias model\n# Controls for: Precision (Egger), Time (Year), and Quality all at once.\nreporting_model &lt;- rma.mv(yi = lnRR,\n                          V = VCV, \n                          mods = ~ 1 + quality_c + sqrt_inv_e_n + Year_c, \n                          random = list(~1 | Study_ID, ~1 | ES_ID), \n                          test = \"t\", \n                          method = \"REML\",\n                          sparse = TRUE,\n                          data = db_decline)\n\nsummary(reporting_model)\n\n\nMultivariate Meta-Analysis Model (k = 299; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-246.3465   492.6931   504.6931   526.8149   504.9847   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0478  0.2185     20     no  Study_ID \nsigma^2.2  0.2184  0.4674    299     no     ES_ID \n\nTest for Residual Heterogeneity:\nQE(df = 295) = 5626.1570, p-val &lt; .0001\n\nTest of Moderators (coefficients 2:4):\nF(df1 = 3, df2 = 295) = 0.4953, p-val = 0.6858\n\nModel Results:\n\n              estimate      se    tval   df    pval    ci.lb   ci.ub    \nintrcpt         0.0469  0.4469  0.1048  295  0.9166  -0.8327  0.9264    \nquality_c       0.0387  0.0406  0.9531  295  0.3413  -0.0412  0.1187    \nsqrt_inv_e_n    0.2020  0.6720  0.3006  295  0.7639  -1.1205  1.5245    \nYear_c          0.0156  0.0168  0.9254  295  0.3555  -0.0175  0.0486    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nbubble_plot(reporting_model,\n            mod = \"quality_c\",\n            group = \"Study_ID\",\n            xlab = \"Reporting quality\")",
    "crumbs": [
      "lnRR",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Publication bias</span>"
    ]
  },
  {
    "objectID": "lnVR.html",
    "href": "lnVR.html",
    "title": "lnVR",
    "section": "",
    "text": "db &lt;- readr::read_csv(here(\"..\",\"data\",\"db251124.csv\")) %&gt;%\n  \n  # Convert all columns required for calculation to numeric.\n  mutate(across(c(C_n, Ex_n, C_mean, Ex_mean, C_SE, Ex_SE, C_SD, Ex_SD), as.numeric)) %&gt;%\n  \n  # Calculate SD where it is missing but SE is present\n  # Formula: SD = SE * sqrt(n)\n  mutate(\n    C_SD = ifelse(\n      is.na(C_SD) & !is.na(C_SE),\n      C_SE * sqrt(C_n), \n      C_SD\n    ),\n    Ex_SD = ifelse(\n      is.na(Ex_SD) & !is.na(Ex_SE),\n      Ex_SE * sqrt(Ex_n), \n      Ex_SD\n    )\n  ) %&gt;%\n  \n  # Create Cohort_ID to uniquely identify the source cohort\n  mutate(\n    Cohort_ID = paste(Study_ID, \"Ex-ID\", sep = \"_\")\n  ) %&gt;%\n  \n  # Convert all remaining character columns to factors\n  mutate(across(where(is.character), as.factor))\n\n\ncalculate_lnVR &lt;- function(dt) {\n\n  ## 1. Filter out Proportional Data\n  dt &lt;- dt %&gt;%\n    mutate(Data_type = tolower(Data_type)) %&gt;% \n    filter(!Data_type %in% c(\"percentage\")) \n  \n  if (nrow(dt) == 0) {\n    message(\"No non-percentage data remaining for lnVR calculation.\")\n    return(dt)\n  }\n\n  ## 2. Data Cleaning and Imputation\n  dt &lt;- dt %&gt;%\n    mutate(\n      # Adjust means (for consistency)\n      C_mean = ifelse(C_mean == 0, 0.005, C_mean),\n      Ex_mean = ifelse(Ex_mean == 0, 0.005, Ex_mean),\n      C_mean = ifelse(C_mean == 100, 99.5, C_mean), \n      Ex_mean = ifelse(Ex_mean == 100, 99.5, Ex_mean),\n\n      # Adjust SDs that are 0 (Critical for lnVR)\n      Ex_SD = ifelse(Ex_SD == 0, 0.01, Ex_SD),\n      C_SD = ifelse(C_SD == 0, 0.05, C_SD)\n    )\n\n  ## 3. Setup\n  dt$lnVR &lt;- NA_real_\n  dt$lnVR_var &lt;- NA_real_\n\n  ## 4. Calculation Loop\n  for (i in seq_len(nrow(dt))) {\n    \n    # Extract variables\n    Ex_n &lt;- dt$Ex_n[i]\n    C_n &lt;- dt$C_n[i]\n    Ex_SD &lt;- dt$Ex_SD[i]\n    C_SD &lt;- dt$C_SD[i]\n    Data_type &lt;- dt$Data_type[i]\n    Comparison_structure &lt;- dt$Comparison_structure[i]\n    \n    # --- Continuous Data ---\n    if (Data_type %in% c(\"time\", \"distance\", \"count\", \"latency\", \"index\")) {\n      \n      # A. INDEPENDENT GROUPS\n      if (Comparison_structure == \"Independent\") {\n        \n        # measure = \"VR\" (Variability Ratio for independent groups)\n        # Requires n1i, n2i, sd1i, sd2i\n        effect &lt;- metafor::escalc(\n          measure = \"VR\", \n          n1i = Ex_n, n2i = C_n,\n          sd1i = Ex_SD, sd2i = C_SD,\n          var.names = c(\"lnVR\", \"lnVR_var\")\n        )\n        \n      # B. DEPENDENT GROUPS\n      } else if (Comparison_structure == \"Dependent\") {\n        \n        # measure = \"VRC\" (Variability Ratio for Correlated/Dependent groups)\n        # Requires 'ni' (sample size of pairs) and 'ri' (correlation)\n        # We assume ri = 0.5 (consistent with your lnRR approach)\n        effect &lt;- metafor::escalc(\n          measure = \"VRC\", \n          ni = (Ex_n + C_n) / 2, # Use average N for the pair\n          sd1i = Ex_SD, sd2i = C_SD,\n          ri = 0.5, \n          var.names = c(\"lnVR\", \"lnVR_var\")\n        )\n      }\n      \n      # Assign results\n      dt$lnVR[i] &lt;- effect$lnVR\n      dt$lnVR_var[i] &lt;- effect$lnVR_var\n      \n      # Note: Sign flip (Higher_better == \"No\") removed as discussed.\n      # lnVR is interpreted strictly as variance expansion (+) or compression (-).\n    }\n  }\n  \n  return(dt)\n}\n\n\ndb_lnVR &lt;- calculate_lnVR(db)\n\nreadr::write_csv(\n  db_lnVR, \n  file = here(\"..\",\"data\", \"db_lnVR.csv\"),\n  na = \"\" \n)",
    "crumbs": [
      "lnVR",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>lnVR</span>"
    ]
  },
  {
    "objectID": "overall_effect_lnVR.html",
    "href": "overall_effect_lnVR.html",
    "title": "overall_effect_lnVR",
    "section": "",
    "text": "mOV &lt;- rma.mv(yi = lnVR, \n                  V = VCV, \n              mods = ~ 1,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID,\n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db)\n\nsummary(mOV)\n\n\nMultivariate Meta-Analysis Model (k = 222; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-348.0396   696.0792   704.0792   717.6718   704.2644   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0843  0.2903     16     no  Study_ID \nsigma^2.2  1.2242  1.1064    222     no     ES_ID \nsigma^2.3  0.0000  0.0001      6     no    Strain \n\nTest for Heterogeneity:\nQ(df = 221) = 4392.5021, p-val &lt; .0001\n\nModel Results:\n\nestimate      se    tval   df    pval    ci.lb   ci.ub    \n  0.1346  0.1283  1.0490  221  0.2953  -0.1183  0.3875    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\norchaRd::i2_ml(mOV)\n\n    I2_Total  I2_Study_ID     I2_ES_ID    I2_Strain \n9.227147e+01 5.944073e+00 8.632740e+01 2.435885e-07 \n\n\n\nr2OV &lt;- round(r2_ml(mOV), 4)\nr2OV\n\n   R2_marginal R2_conditional \n        0.0000         0.0644 \n\n\n\norchard_overall&lt;-orchard_plot(mOV,\n               group = \"Study_ID\",\n               xlab = \"lnVR\", \n              flip = FALSE) +\n            scale_colour_brewer(palette = \"Set1\") +\n            scale_fill_brewer(palette = \"Dark2\")+scale_y_continuous(limits = c(-6,11),breaks = seq(-6, 10, by = 2),\n                                                                    minor_breaks = seq(-6, 11, by = 1 ))\norchard_overall\n\n\n\n\n\n\n\n\n\nggsave(filename = here(\"..\",\"Plots\", \"overall_lnVR.pdf\"),\n       plot = orchard_overall,\n       dpi = 300, device = cairo_pdf)\n\nggsave(filename = here(\"..\",\"Plots\", \"overall_lnVR.jpg\"),\n       plot = orchard_overall,\n       width = 7,  \n       height = 9,  \n       dpi = 300)",
    "crumbs": [
      "lnVR",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>overall_effect_lnVR</span>"
    ]
  },
  {
    "objectID": "uni_moderators_lnVR.html",
    "href": "uni_moderators_lnVR.html",
    "title": "Uni-moderator (lnVR)",
    "section": "",
    "text": "Meta-regressions\n\nOutcome type: Anxiety and DepressionLifestage of exposure\n\n\n\nk_counts &lt;- db %&gt;%\n  group_by(Outcome_type) %&gt;%\n  summarise(k_es = n())\n\n\nlevels_to_keep &lt;- k_counts %&gt;%\n  filter(k_es &gt;= 5) %&gt;%\n  pull(Outcome_type)\n\n\ndb_filtered &lt;- db %&gt;%\n  filter(Outcome_type %in% levels_to_keep)\n\nindices_to_keep &lt;- which(db$Outcome_type %in% levels_to_keep)\nVCV_filtered &lt;- VCV[indices_to_keep, indices_to_keep]\n\n\nmOT &lt;- rma.mv(yi = lnVR, \n                  V = VCV_filtered, \n              mods = ~ Outcome_type-1,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID,\n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db_filtered)\n\nsummary(mOT)\n\n\nMultivariate Meta-Analysis Model (k = 219; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-339.3184   678.6368   688.6368   705.5363   688.9211   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.1310  0.3620     16     no  Study_ID \nsigma^2.2  1.1825  1.0874    219     no     ES_ID \nsigma^2.3  0.0000  0.0001      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 217) = 4218.8132, p-val &lt; .0001\n\nTest of Moderators (coefficients 1:2):\nF(df1 = 2, df2 = 217) = 4.6636, p-val = 0.0104\n\nModel Results:\n\n                        estimate      se     tval   df    pval    ci.lb   ci.ub \nOutcome_typeAnxiety       0.3112  0.1520   2.0473  217  0.0418   0.0116  0.6107 \nOutcome_typeDepression   -0.3290  0.2151  -1.5292  217  0.1277  -0.7530  0.0950 \n                          \nOutcome_typeAnxiety     * \nOutcome_typeDepression    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nr2OT &lt;- round(r2_ml(mOT), 4)\nr2OT\n\n   R2_marginal R2_conditional \n        0.0537         0.1481 \n\n\n\norchard_outcome&lt;-orchard_plot(mOT,\n              mod = \"Outcome_type\",\n               group = \"Study_ID\",\n               xlab = \"log variability ratio (lnVR)\", # Changed Label\n              flip = FALSE) +\n            scale_colour_brewer(palette = \"Set1\") +\n            scale_fill_brewer(palette = \"Dark2\")+scale_y_continuous(limits = c(-6,11),breaks = seq(-6, 10, by = 2),\n                                                                    minor_breaks = seq(-6, 11, by = 1 ))\norchard_outcome\n\n\n\n\n\n\n\n\n\nggsave(filename = here(\"..\",\"Plots\", \"orchard_outcome_lnVR.pdf\"),\n       plot = orchard_outcome,\n       dpi = 300, device = cairo_pdf)\n\nggsave(filename = here(\"..\",\"Plots\", \"orchard_outcome_lnVR.jpg\"), \n       plot = orchard_outcome,\n       width = 7,  \n       height = 9,  \n       dpi = 300)\n\nContrast between levels (Anxiety as reference level)\n\nmOT &lt;- rma.mv(yi = lnVR, # Changed to lnVR\n                  V = VCV_filtered, \n              mods = ~ Outcome_type,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID,\n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db_filtered)\n\nsummary(mOT)\n\n\nMultivariate Meta-Analysis Model (k = 219; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-339.3184   678.6368   688.6368   705.5363   688.9211   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.1310  0.3620     16     no  Study_ID \nsigma^2.2  1.1825  1.0874    219     no     ES_ID \nsigma^2.3  0.0000  0.0001      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 217) = 4218.8132, p-val &lt; .0001\n\nTest of Moderators (coefficient 2):\nF(df1 = 1, df2 = 217) = 8.3073, p-val = 0.0043\n\nModel Results:\n\n                        estimate      se     tval   df    pval    ci.lb \nintrcpt                   0.3112  0.1520   2.0473  217  0.0418   0.0116 \nOutcome_typeDepression   -0.6401  0.2221  -2.8822  217  0.0043  -1.0779 \n                          ci.ub     \nintrcpt                  0.6107   * \nOutcome_typeDepression  -0.2024  ** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\n\nmLE &lt;- rma.mv(yi = lnVR, # Changed to lnVR\n                  V = VCV, \n              mods = ~ Lifestage_exposure-1,\n                  random = list(~1 | Study_ID,\n                                ~1 | ES_ID,\n                                ~1 | Strain),\n                  test = \"t\",\n                  method = \"REML\", \n                  sparse = TRUE,\n                  data = db)\n\nsummary(mLE)\n\n\nMultivariate Meta-Analysis Model (k = 222; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-339.3525   678.7050   696.7050   727.0825   697.5788   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed    factor \nsigma^2.1  0.0263  0.1621     16     no  Study_ID \nsigma^2.2  1.2491  1.1176    222     no     ES_ID \nsigma^2.3  0.0000  0.0000      6     no    Strain \n\nTest for Residual Heterogeneity:\nQE(df = 216) = 4359.9557, p-val &lt; .0001\n\nTest of Moderators (coefficients 1:6):\nF(df1 = 6, df2 = 216) = 1.1160, p-val = 0.3539\n\nModel Results:\n\n                               estimate      se     tval   df    pval    ci.lb \nLifestage_exposureAdolescent     0.7391  0.3236   2.2844  216  0.0233   0.1014 \nLifestage_exposureAdult         -0.0508  0.2667  -0.1903  216  0.8492  -0.5764 \nLifestage_exposureJuvenile       0.0347  0.5057   0.0685  216  0.9454  -0.9621 \nLifestage_exposureMixed         -0.1120  0.2389  -0.4687  216  0.6398  -0.5829 \nLifestage_exposureUnclear        0.1922  0.3773   0.5094  216  0.6110  -0.5515 \nLifestage_exposureYoung adult    0.1715  0.1561   1.0988  216  0.2731  -0.1361 \n                                ci.ub    \nLifestage_exposureAdolescent   1.3768  * \nLifestage_exposureAdult        0.4749    \nLifestage_exposureJuvenile     1.0315    \nLifestage_exposureMixed        0.3589    \nLifestage_exposureUnclear      0.9359    \nLifestage_exposureYoung adult  0.4791    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nr2LE &lt;- round(r2_ml(mLE), 4)\nr2LE\n\n   R2_marginal R2_conditional \n        0.0388         0.0586 \n\n\n\norchard_lifestage&lt;-orchard_plot(mLE,\n              mod = \"Lifestage_exposure\",\n               group = \"Study_ID\",\n                xlab = \"log variability ratio (lnVR)\", # Changed Label\n              flip = FALSE) +\n            scale_colour_brewer(palette = \"Set1\") +\n            scale_fill_brewer(palette = \"Dark2\")+scale_y_continuous(limits=c(-6,11),breaks = seq(-6, 10, by = 2),\n                                                                    minor_breaks = seq(-6, 10, by = 1 ))\norchard_lifestage\n\n\n\n\n\n\n\n\n\nggsave(filename = here(\"..\",\"Plots\", \"orchard_lifestage_lnVR.pdf\"), \n       plot = orchard_lifestage,\n       dpi = 300, device = cairo_pdf)\n\nggsave(filename = here(\"..\",\"Plots\", \"orchard_lifestage_lnVR.jpg\"),\n       plot = orchard_lifestage,\n       width = 9,  \n       height = 7,  \n       dpi = 300)\n\nContrasts between levels\n\n# Here we apply our custum functions\n# The Generator\ncontra_LE &lt;- contrast_fun(data = db, \n                          response = lnVR, \n                          moderator = Lifestage_exposure, \n                          VCV = VCV)\n\n#The Harvester\nt1&lt;-get_estimate(model = mLE, contra = contra_LE, moderator = Lifestage_exposure)\n\n#The Cleaner\nt2 &lt;- clean_unique_contrasts(full_results_table = t1, level_count = 6)\n\n\nt2\n\n# A tibble: 21 × 7\n   Levels              Estimate Lower_CI Upper_CI P_value Lower_PI Upper_PI\n   &lt;chr&gt;                  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;\n 1 Adolescent            0.739     0.101  1.38     0.0233    -1.58     3.05\n 2 Adult                -0.0508   -0.576  0.475    0.849     -2.34     2.24\n 3 Juvenile              0.0347   -0.962  1.03     0.945     -2.40     2.47\n 4 Mixed                -0.112    -0.583  0.359    0.640     -2.39     2.16\n 5 Unclear               0.192    -0.551  0.936    0.611     -2.15     2.54\n 6 Young adult           0.171    -0.136  0.479    0.273     -2.08     2.42\n 7 Adult-Adolescent     -0.790    -1.59   0.00935  0.0527    -3.15     1.58\n 8 Juvenile-Adolescent  -0.704    -1.83   0.417    0.217     -3.20     1.79\n 9 Mixed-Adolescent     -0.851    -1.64  -0.0584   0.0355    -3.21     1.51\n10 Unclear-Adolescent   -0.547    -1.52   0.428    0.270     -2.98     1.88\n# ℹ 11 more rows",
    "crumbs": [
      "lnVR",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Uni-moderator (lnVR)</span>"
    ]
  }
]