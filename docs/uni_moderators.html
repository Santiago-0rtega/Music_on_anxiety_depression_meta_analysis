<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Uni-moderators – Music_meta_book</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./multi_moderator.html" rel="next">
<link href="./overall_effect.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2a9c7f2eac7477c13d2e63a94091d553.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-01bf8df9ada13ca47d1832082656cd9b.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-2a9c7f2eac7477c13d2e63a94091d553.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lnRR.html">lnRR</a></li><li class="breadcrumb-item"><a href="./uni_moderators.html"><span class="chapter-title">Uni-moderators</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Music_meta_book</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Index</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">lnRR</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lnRR.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Estimating effect sizes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./overall_effect.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Overall effect</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./uni_moderators.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Uni-moderators</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multi_moderator.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Multi_moderator</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./publication_bias.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Publication bias</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#functions-for-pairwise-contrasts" id="toc-functions-for-pairwise-contrasts" class="nav-link active" data-scroll-target="#functions-for-pairwise-contrasts">Functions for pairwise contrasts</a></li>
  <li><a href="#meta-regressions" id="toc-meta-regressions" class="nav-link" data-scroll-target="#meta-regressions">Meta-regressions</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lnRR.html">lnRR</a></li><li class="breadcrumb-item"><a href="./uni_moderators.html"><span class="chapter-title">Uni-moderators</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-title">Uni-moderators</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Variable definitions:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable Name</th>
<th style="text-align: left;">Definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong><code>ES_ID</code></strong></td>
<td style="text-align: left;">Unique row identifier for each <span class="math inline">\(\text{lnRR}\)</span> effect size.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>Study_ID</code></strong></td>
<td style="text-align: left;">Identifier for the primary research paper.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>Cohort_ID</code></strong></td>
<td style="text-align: left;">Identifier for specific experimental groups within a study.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>Outcome_type</code></strong></td>
<td style="text-align: left;">The behavioral construct measured. Levels: <strong>Anxiety</strong>, <strong>Depression</strong>, <strong>both</strong>, <strong>unclear</strong>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>Lifestage_exposure</code></strong></td>
<td style="text-align: left;">Animal’s developmental stage during music exposure. Levels: <strong>Adolescent</strong>, <strong>Juvenile</strong>, <strong>Young adult</strong>, <strong>Adult</strong>, <strong>Mixed</strong>, <strong>Unclear</strong>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>Sex</code></strong></td>
<td style="text-align: left;">Sex of the subjects. Levels: <strong>Male</strong>, <strong>Female</strong>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>Strain</code></strong></td>
<td style="text-align: left;">Specific animal strain or species used.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>Meta_genre</code></strong></td>
<td style="text-align: left;">Categorization of the music stimulus. Levels: <strong>Western Art Music / Orchestral</strong>, <strong>Popular Contemporary Music</strong>, <strong>Traditional Music / Folk / World</strong>, <strong>Mixed</strong>, <strong>Unclear</strong>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>Music_exposure_duration</code></strong></td>
<td style="text-align: left;">Total time subjects were exposed to music. Levels: <strong>Acute</strong>, <strong>short</strong>, <strong>medium</strong>, <strong>long</strong>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>Experimental_design</code></strong></td>
<td style="text-align: left;">Study’s methodological setup. Levels: <strong>Posttest-Only Control Group</strong>, <strong>Randomized Block</strong>, <strong>Factorial</strong>, <strong>Repeated Measures</strong>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>Induced behaviour</code></strong></td>
<td style="text-align: left;">Whether the tested behavior was innate or experimentally induced.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>Relative_timing</code></strong></td>
<td style="text-align: left;">When music was administered relative to the behavioral test. Levels: <strong>before</strong>, <strong>concurrent</strong>, <strong>both</strong>, <strong>not specified</strong>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>Experimental_procedures</code></strong></td>
<td style="text-align: left;">Identifies non-treatment controls for interventions. Levels: <strong>sham</strong>, <strong>none</strong>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>Control_condition</code></strong></td>
<td style="text-align: left;">Description of the control group condition. Levels: <strong>white noise</strong>, <strong>ambient noise</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>Assay_type</code></strong></td>
<td style="text-align: left;">Type of behavioral test used.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>Overall_rob</code></strong></td>
<td style="text-align: left;">Overall risk of bias assessment for each study. Levels: <strong>2 (low)</strong>, <strong>1 (moderate)</strong>, <strong>0 (high)</strong>.</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="functions-for-pairwise-contrasts" class="level2">
<h2 class="anchored" data-anchor-id="functions-for-pairwise-contrasts">Functions for pairwise contrasts</h2>
<p>General Explanation This set of functions automates a common but tedious task in meta-analysis: calculating all pairwise comparisons between groups.</p>
<ul>
<li><p>Function 1 (The Generator): Standard meta-regression usually compares all groups against a single “Reference” group. This function “hacks” that by re-running the model multiple times, rotating the reference group each time so that every group gets a turn as the baseline.</p></li>
<li><p>Function 2 (The Harvester): This extracts the statistical results (estimates, confidence intervals, p-values) from all those models and organizes them into a single, readable table.</p></li>
<li><p>Function 3 (The Cleaner): Because the first two steps calculate both “Group A vs B” and “Group B vs A” (which are mathematically identical), this function filters out the duplicates to leave you with a clean, unique list of comparisons.</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">1. The Generator</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">2. The Harvester</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">3. The cleaner</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-fold="true">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>contrast_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(data, response, moderator, VCV){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 1. Setup Dynamic Names ---</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We grab the actual names of the columns so we can use them in the formulas below</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    mod  <span class="ot">&lt;-</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(moderator))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    resp <span class="ot">&lt;-</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(response))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 2. Identify Groups ---</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find all unique categories in the moderator and ensure it's a factor</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    names <span class="ot">&lt;-</span> <span class="fu">levels</span>(<span class="fu">as.factor</span>(data[[mod]]))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    moderator <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data[[mod]])</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 3. The Model Runner ---</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This internal function fits the meta-regression repeatedly.</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># It changes the 'ref' (reference level) dynamically each time.</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    run_rma <span class="ot">&lt;-</span> <span class="cf">function</span>(name) {</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rma.mv</span>(<span class="at">yi =</span> data[[resp]], </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">V =</span> VCV, </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>               <span class="co"># Here is the magic: we force the model to use 'name' as the baseline</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">mods =</span> <span class="sc">~</span> <span class="fu">relevel</span>(moderator, <span class="at">ref =</span> name), </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>Study_ID, <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>ES_ID, <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>Strain), </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">test =</span> <span class="st">"t"</span>, </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> data, </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">sparse =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 4. Loop Through Groups ---</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We run the model n-1 times (we don't need the last one as it's covered by previous runs).</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># map() iterates through the names and applies run_rma() to each.</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    contra <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(names[<span class="sc">-</span><span class="fu">length</span>(names)], run_rma)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(contra)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-fold="true">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>get_estimate <span class="ot">&lt;-</span> <span class="cf">function</span>(model, contra, moderator) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    mod <span class="ot">&lt;-</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(moderator))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Utility: Make text look nice (e.g., "control" -&gt; "Control")</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    capitalize_first <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">toupper</span>(<span class="fu">substring</span>(x, <span class="dv">1</span>, <span class="dv">1</span>)), <span class="fu">substring</span>(x, <span class="dv">2</span>))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- Helper A: Get Group Means ---</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extracts the estimated mean effect size for each group from the base model</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    get_pred1 <span class="ot">&lt;-</span> <span class="cf">function</span> (model, <span class="at">mod =</span> mod) {</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Clean up row names to just get the group name</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        name_raw <span class="ot">&lt;-</span> <span class="fu">as.character</span>(stringr<span class="sc">::</span><span class="fu">str_replace</span>(<span class="fu">row.names</span>(model<span class="sc">$</span>beta), mod, <span class="st">""</span>))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        name <span class="ot">&lt;-</span> <span class="fu">capitalize_first</span>(name_raw)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        len <span class="ot">&lt;-</span> <span class="fu">length</span>(name)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create a dummy matrix to predict the mean for each group individually</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        newdata <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> len, <span class="at">nrow =</span> len)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>len) {</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>            pos <span class="ot">&lt;-</span> <span class="fu">which</span>(model<span class="sc">$</span>X[, i] <span class="sc">==</span> <span class="dv">1</span>)[[<span class="dv">1</span>]] </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>            newdata[i, ] <span class="ot">&lt;-</span> model<span class="sc">$</span>X[pos, ]       </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Predict values</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>        pred <span class="ot">&lt;-</span> metafor<span class="sc">::</span><span class="fu">predict.rma</span>(model, <span class="at">newmods =</span> newdata)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Format into a tibble</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>        tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> name, <span class="at">labels =</span> name),</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">estimate =</span> pred<span class="sc">$</span>pred,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">lowerCL =</span> pred<span class="sc">$</span>ci.lb, <span class="at">upperCL =</span> pred<span class="sc">$</span>ci.ub,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">pval =</span> model<span class="sc">$</span>pval, </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">lowerPR =</span> pred<span class="sc">$</span>cr.lb, <span class="at">upperPR =</span> pred<span class="sc">$</span>cr.ub</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- Helper B: Get Pairwise Differences ---</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extracts the "contrasts" (differences between groups) from the re-leveled models</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>    get_pred2 <span class="ot">&lt;-</span> <span class="cf">function</span> (model) {</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>        name <span class="ot">&lt;-</span> <span class="fu">row.names</span>(model<span class="sc">$</span>beta) </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>        len <span class="ot">&lt;-</span> <span class="fu">length</span>(name)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>        newdata <span class="ot">&lt;-</span> <span class="fu">diag</span>(len)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1. Get the Intercept (The Reference Group Mean)</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>        pred1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(metafor<span class="sc">::</span><span class="fu">predict.rma</span>(model, <span class="at">newmods =</span> newdata[<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>        <span class="fu">names</span>(pred1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pred"</span>, <span class="st">"se"</span>, <span class="st">"ci.lb"</span>, <span class="st">"ci.ub"</span>, <span class="st">"cr.lb"</span>, <span class="st">"cr.ub"</span>) </span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2. Get the Contrasts (Difference from Reference)</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>        pred2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(metafor<span class="sc">::</span><span class="fu">predict.rma</span>(model, <span class="at">intercept =</span> <span class="cn">FALSE</span>, <span class="at">newmods =</span> newdata[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>        <span class="fu">names</span>(pred2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pred"</span>, <span class="st">"se"</span>, <span class="st">"ci.lb"</span>, <span class="st">"ci.ub"</span>, <span class="st">"cr.lb"</span>, <span class="st">"cr.ub"</span>) </span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>        pred <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pred1, pred2)</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>        tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>            <span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> name, <span class="at">labels =</span> name),</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>            <span class="at">estimate =</span> pred<span class="sc">$</span>pred,</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>            <span class="at">lowerCL =</span> pred<span class="sc">$</span>ci.lb, <span class="at">upperCL =</span> pred<span class="sc">$</span>ci.ub,</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">pval =</span> model<span class="sc">$</span>pval,</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>            <span class="at">lowerPR =</span> pred<span class="sc">$</span>cr.lb, <span class="at">upperPR =</span> pred<span class="sc">$</span>cr.ub</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- Helper C: Combine Everything ---</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Stitches the group means and the pairwise differences into one big table</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>    mr_results <span class="ot">&lt;-</span> <span class="cf">function</span>(res1, res2) {</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Logic to name the comparisons (e.g., "Treatment-Control") based on order</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>        get_ordered_contrast_names <span class="ot">&lt;-</span> <span class="cf">function</span>(level_names) {</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>            reference_levels <span class="ot">&lt;-</span> level_names[<span class="sc">-</span><span class="fu">length</span>(level_names)] </span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>            ordered_names <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (ref <span class="cf">in</span> reference_levels) {</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>                coefficient_levels <span class="ot">&lt;-</span> level_names[level_names <span class="sc">!=</span> ref]</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Format: "ComparisonGroup - ReferenceGroup"</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>                ordered_names <span class="ot">&lt;-</span> <span class="fu">c</span>(ordered_names, <span class="fu">paste</span>(coefficient_levels, ref, <span class="at">sep=</span><span class="st">"-"</span>))</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(ordered_names)</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>        level_names <span class="ot">&lt;-</span> <span class="fu">as.character</span>(res1<span class="sc">$</span>name)</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>        new_contrast_names <span class="ot">&lt;-</span> <span class="fu">get_ordered_contrast_names</span>(level_names)</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>        tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>            <span class="at">Levels =</span> <span class="fu">c</span>(level_names, new_contrast_names),</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>            <span class="at">Estimate =</span> <span class="fu">c</span>(res1<span class="sc">$</span>estimate, res2<span class="sc">$</span>estimate),</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>            <span class="at">Lower_CI =</span> <span class="fu">c</span>(res1<span class="sc">$</span>lowerCL, res2<span class="sc">$</span>lowerCL),</span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>            <span class="at">Upper_CI =</span> <span class="fu">c</span>(res1<span class="sc">$</span>upperCL, res2<span class="sc">$</span>upperCL),</span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>            <span class="at">P_value =</span> <span class="fu">c</span>(res1<span class="sc">$</span>pval, res2<span class="sc">$</span>pval),</span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>            <span class="at">Lower_PI =</span> <span class="fu">c</span>(res1<span class="sc">$</span>lowerPR, res2<span class="sc">$</span>lowerPR),</span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>            <span class="at">Upper_PI =</span> <span class="fu">c</span>(res1<span class="sc">$</span>upperPR, res2<span class="sc">$</span>upperPR)</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- MAIN EXECUTION FLOW ---</span></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. Calculate Group Means (Base Model)</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>    res1 <span class="ot">&lt;-</span> <span class="fu">get_pred1</span>(model, <span class="at">mod =</span> mod)</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. Calculate Contrasts (Re-leveled Models)</span></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>    estimates <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(contra, <span class="sc">~</span> <span class="fu">get_pred2</span>(.x))</span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3. Drop intercepts from contrast models (we only want the differences)</span></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>    res2 <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_dfr</span>(estimates, <span class="sc">~</span>.x[<span class="sc">-</span><span class="dv">1</span>, ]) </span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 4. Final Polish</span></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">mr_results</span>(res1, res2)</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(results)</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell" data-fold="true">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>clean_unique_contrasts <span class="ot">&lt;-</span> <span class="cf">function</span>(full_results_table, <span class="at">level_count =</span> <span class="dv">6</span>) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- 1. Split Data ---</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Keep the single group means safe at the top</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  level_estimates <span class="ot">&lt;-</span> full_results_table[<span class="dv">1</span><span class="sc">:</span>level_count, ]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Isolate the pairwise comparisons</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  contrast_estimates <span class="ot">&lt;-</span> full_results_table[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>level_count), ]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- 2. Clean Names ---</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Parse "GroupA-GroupB" into separate columns</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  contrast_estimates <span class="ot">&lt;-</span> contrast_estimates <span class="sc">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">Level1 =</span> <span class="fu">str_extract</span>(Levels, <span class="st">"^(.*?)-"</span>),</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">Level2 =</span> <span class="fu">str_extract</span>(Levels, <span class="st">"-(.*?)$"</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">Level1 =</span> <span class="fu">str_replace_all</span>(Level1, <span class="st">"-"</span>, <span class="st">""</span>),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">Level2 =</span> <span class="fu">str_replace_all</span>(Level2, <span class="st">"-"</span>, <span class="st">""</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- 3. Deduplicate ---</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a sorted key so "A_B" and "B_A" are treated as identical</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  unique_contrasts <span class="ot">&lt;-</span> contrast_estimates <span class="sc">%&gt;%</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">Unique_Pair_Key =</span> <span class="fu">paste</span>(<span class="fu">pmin</span>(Level1, Level2), <span class="fu">pmax</span>(Level1, Level2), <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep only the first instance of each unique pair</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(Unique_Pair_Key, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>Level1, <span class="sc">-</span>Level2, <span class="sc">-</span>Unique_Pair_Key)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- 4. Recombine ---</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  final_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(level_estimates, unique_contrasts)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(final_table)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="meta-regressions" class="level2">
<h2 class="anchored" data-anchor-id="meta-regressions">Meta-regressions</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data Filtering &amp; Matrix Alignment
</div>
</div>
<div class="callout-body-container callout-body">
<p>This snippet performs quality control before running your meta-analysis. It serves two critical functions:</p>
<p>Ensures Reliability: It removes specific levels of your moderator (groups) that have too little data to be trusted (in this case, fewer than 5 effect sizes).</p>
<p>Prevents Errors: Crucially, it subsets the Variance-Covariance (VCV) matrix to match your filtered data. Since the VCV matrix is a square grid where every row/column corresponds to a row in your data, filtering the data without “cropping” the matrix correspondingly will cause your model to crash due to a dimension mismatch.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Identify and Filter Low-K Levels</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (Replace 'Outcome_type' with the specific moderator column name)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the count of ES_ID (k) for each level of the moderator</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>k_counts <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Outcome_type) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">k_es =</span> <span class="fu">n</span>())</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the levels to keep (where k_es &gt;= 5)</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>levels_to_keep <span class="ot">&lt;-</span> k_counts <span class="sc">%&gt;%</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(k_es <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Outcome_type)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Create the Filtered Data Frame</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>db_filtered <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Outcome_type <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Subset the VCV Matrix (CRITICAL STEP)</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumes VCV matrix rows/columns match the original 'db' data frame indices.</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>indices_to_keep <span class="ot">&lt;-</span> <span class="fu">which</span>(db<span class="sc">$</span>Outcome_type <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>VCV_filtered <span class="ot">&lt;-</span> VCV[indices_to_keep, indices_to_keep]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Manual Reference Rotation for SubsetsThe automated contrast functions are designed for full datasets. When you filter for data availability (e.g., keeping only levels with <span class="math inline">\(k \ge 5\)</span>) and are left with more than 2 levels, it is often safer to manually “rotate” the reference level. How it works:In meta-regression with an intercept, the Intercept represents the mean of the Reference Level. The other coefficients represent the difference between the reference and the other groups.By manually changing the reference (ref = …) and re-running the model for each level, you mathematically force the model to calculate every possible pairwise comparison (e.g., A vs B, B vs C, A vs C) and their specific p-values.</p>
<ul>
<li>2 Levels remaining? You only need one model (Intercept = Group A, Coefficient = Difference).</li>
<li>3+ Levels remaining? Use the rotation method below.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0. Define your levels of interest</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LEVELS <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Acute"</span>, <span class="st">"Medium"</span>, <span class="st">"Short"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># (Optional) Store moderator name for clarity</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>MOD_NAME <span class="ot">&lt;-</span> <span class="st">"Music_exposure_duration"</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model A: Reference = Acute ---</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Intercept = Acute Mean</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients = (Medium - Acute) and (Short - Acute)</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>db_filtered<span class="sc">$</span>moderator_relevel_A <span class="ot">&lt;-</span> <span class="fu">relevel</span>(db_filtered<span class="sc">$</span>Music_exposure_duration, <span class="at">ref =</span> LEVELS[<span class="dv">1</span>])</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>model_A <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mods =</span> <span class="sc">~</span> moderator_relevel_A,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>, <span class="at">method =</span> <span class="st">"REML"</span>, <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>model_A</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model B: Reference = Medium ---</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Intercept = Medium Mean</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients = (Acute - Medium) and (Short - Medium)</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># *Key Gain: This gives us the specific P-value for Short vs Medium*</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>db_filtered<span class="sc">$</span>moderator_relevel_B <span class="ot">&lt;-</span> <span class="fu">relevel</span>(db_filtered<span class="sc">$</span>Music_exposure_duration, <span class="at">ref =</span> LEVELS[<span class="dv">2</span>])</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>model_B <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mods =</span> <span class="sc">~</span> moderator_relevel_B,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>, <span class="at">method =</span> <span class="st">"REML"</span>, <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>model_B</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model C: Reference = Short ---</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Intercept = Short Mean</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients = (Acute - Short) and (Medium - Short)</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="co"># *Useful for: Getting the direct estimate/CI for the "Short" group mean*</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>db_filtered<span class="sc">$</span>moderator_relevel_C <span class="ot">&lt;-</span> <span class="fu">relevel</span>(db_filtered<span class="sc">$</span>Music_exposure_duration, <span class="at">ref =</span> LEVELS[<span class="dv">3</span>])</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>model_C <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mods =</span> <span class="sc">~</span> moderator_relevel_C,</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>, <span class="at">method =</span> <span class="st">"REML"</span>, <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>model_C</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">1. Outcome type: Anxiety and Depression</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">2. Lifestage of exposure</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">3. Sex</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">4. Music genre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">5. Music exposure duration</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">6. Experimental design</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-7" role="tab" aria-controls="tabset-2-7" aria-selected="false">7. Induced behaviour</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-8" role="tab" aria-controls="tabset-2-8" aria-selected="false">8. Relative timing</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-9" role="tab" aria-controls="tabset-2-9" aria-selected="false">9. Experimental procedures</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-10-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-10" role="tab" aria-controls="tabset-2-10" aria-selected="false">10. Control condition</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-11-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-11" role="tab" aria-controls="tabset-2-11" aria-selected="false">11. Assay type</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell" data-fold="true">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>k_counts <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Outcome_type) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">k_es =</span> <span class="fu">n</span>())</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>levels_to_keep <span class="ot">&lt;-</span> k_counts <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(k_es <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Outcome_type)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>db_filtered <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Outcome_type <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>indices_to_keep <span class="ot">&lt;-</span> <span class="fu">which</span>(db<span class="sc">$</span>Outcome_type <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>VCV_filtered <span class="ot">&lt;-</span> VCV[indices_to_keep, indices_to_keep]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mOT <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Outcome_type<span class="dv">-1</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mOT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 296; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-248.3277   496.6555   506.6555   525.0734   506.8638   

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0489  0.2211     20     no  Study_ID 
sigma^2.2  0.2202  0.4692    296     no     ES_ID 
sigma^2.3  0.0000  0.0001      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 294) = 5619.0059, p-val &lt; .0001

Test of Moderators (coefficients 1:2):
F(df1 = 2, df2 = 294) = 4.8897, p-val = 0.0081

Model Results:

                        estimate      se    tval   df    pval   ci.lb   ci.ub 
Outcome_typeAnxiety       0.2066  0.0704  2.9335  294  0.0036  0.0680  0.3453 
Outcome_typeDepression    0.2023  0.0912  2.2179  294  0.0273  0.0228  0.3817 
                           
Outcome_typeAnxiety     ** 
Outcome_typeDepression   * 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>r2OT <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mOT), <span class="dv">4</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>r2OT</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
        0.0000         0.1817 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>orchard_outcome<span class="ot">&lt;-</span><span class="fu">orchard_plot</span>(mOT,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Outcome_type"</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span> <span class="st">"lnRR"</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">flip =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>)<span class="sc">+</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                                                                    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span> ))</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>orchard_outcome</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="uni_moderators_files/figure-html/orchard_outcome_type-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_outcome_lnRR.pdf"</span>),</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_outcome,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_outcome_lnRR.jpg"</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_outcome,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">7</span>,  </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">9</span>,  </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Contrast between levels (Anxiety as reference level)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mOT <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Outcome_type,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mOT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 296; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-248.3277   496.6555   506.6555   525.0734   506.8638   

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0489  0.2211     20     no  Study_ID 
sigma^2.2  0.2202  0.4692    296     no     ES_ID 
sigma^2.3  0.0000  0.0001      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 294) = 5619.0059, p-val &lt; .0001

Test of Moderators (coefficient 2):
F(df1 = 1, df2 = 294) = 0.0024, p-val = 0.9607

Model Results:

                        estimate      se     tval   df    pval    ci.lb   ci.ub 
intrcpt                   0.2066  0.0704   2.9335  294  0.0036   0.0680  0.3453 
Outcome_typeDepression   -0.0044  0.0887  -0.0493  294  0.9607  -0.1790  0.1702 
                           
intrcpt                 ** 
Outcome_typeDepression     

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mLE <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Lifestage_exposure<span class="dv">-1</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mLE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 299; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-245.3307   490.6614   508.6614   541.7830   509.2975   

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0392  0.1980     20     no  Study_ID 
sigma^2.2  0.2201  0.4692    299     no     ES_ID 
sigma^2.3  0.0039  0.0624      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 293) = 5545.8559, p-val &lt; .0001

Test of Moderators (coefficients 1:6):
F(df1 = 6, df2 = 293) = 2.0358, p-val = 0.0609

Model Results:

                               estimate      se    tval   df    pval    ci.lb 
Lifestage_exposureAdolescent     0.2231  0.1597  1.3963  293  0.1637  -0.0913 
Lifestage_exposureAdult          0.1354  0.1423  0.9515  293  0.3421  -0.1447 
Lifestage_exposureJuvenile       0.1296  0.1899  0.6826  293  0.4954  -0.2441 
Lifestage_exposureMixed          0.0556  0.1166  0.4766  293  0.6340  -0.1739 
Lifestage_exposureUnclear        0.3436  0.1640  2.0945  293  0.0371   0.0207 
Lifestage_exposureYoung adult    0.3014  0.0894  3.3708  293  0.0009   0.1254 
                                ci.ub      
Lifestage_exposureAdolescent   0.5375      
Lifestage_exposureAdult        0.4156      
Lifestage_exposureJuvenile     0.5034      
Lifestage_exposureMixed        0.2850      
Lifestage_exposureUnclear      0.6665    * 
Lifestage_exposureYoung adult  0.4773  *** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>r2LE <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mLE), <span class="dv">4</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>r2LE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
        0.0420         0.1988 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>orchard_lifestage<span class="ot">&lt;-</span><span class="fu">orchard_plot</span>(mLE,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Lifestage_exposure"</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab =</span> <span class="st">"lnRR"</span>, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">flip =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>)<span class="sc">+</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>                                                                    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span> ))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>orchard_lifestage</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="uni_moderators_files/figure-html/orchard_lifestage_exp-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_lifestage_lnRR.pdf"</span>),</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_lifestage,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_lifestage_lnRR.jpg"</span>),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_lifestage,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">9</span>,  </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">7</span>,  </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Contrasts between levels (Adolescent as reference level)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we apply our custum functions</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The Generator</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>contra_LE <span class="ot">&lt;-</span> <span class="fu">contrast_fun</span>(<span class="at">data =</span> db, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">response =</span> lnRR, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">moderator =</span> Lifestage_exposure, </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">VCV =</span> VCV)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">#The Harvester</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>t1<span class="ot">&lt;-</span><span class="fu">get_estimate</span>(<span class="at">model =</span> mLE, <span class="at">contra =</span> contra_LE, <span class="at">moderator =</span> Lifestage_exposure)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">#The Cleaner</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">clean_unique_contrasts</span>(<span class="at">full_results_table =</span> t1, <span class="at">level_count =</span> <span class="dv">6</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>t2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21 × 7
   Levels              Estimate Lower_CI Upper_CI  P_value Lower_PI Upper_PI
   &lt;chr&gt;                  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 Adolescent            0.223   -0.0913    0.537 0.164      -0.834    1.28 
 2 Adult                 0.135   -0.145     0.416 0.342      -0.912    1.18 
 3 Juvenile              0.130   -0.244     0.503 0.495      -0.947    1.21 
 4 Mixed                 0.0556  -0.174     0.285 0.634      -0.980    1.09 
 5 Unclear               0.344    0.0207    0.666 0.0371     -0.716    1.40 
 6 Young adult           0.301    0.125     0.477 0.000850   -0.724    1.33 
 7 Adult-Adolescent     -0.0876  -0.446     0.271 0.631      -1.16     0.984
 8 Juvenile-Adolescent  -0.0934  -0.494     0.307 0.646      -1.18     0.993
 9 Mixed-Adolescent     -0.167   -0.549     0.214 0.389      -1.25     0.912
10 Unclear-Adolescent    0.121   -0.303     0.544 0.576      -0.974    1.22 
# ℹ 11 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell" data-fold="true">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>k_counts <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sex) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">k_es =</span> <span class="fu">n</span>())</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>levels_to_keep <span class="ot">&lt;-</span> k_counts <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(k_es <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Sex)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>db_filtered <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sex <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>indices_to_keep <span class="ot">&lt;-</span> <span class="fu">which</span>(db<span class="sc">$</span>Sex <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>VCV_filtered <span class="ot">&lt;-</span> VCV[indices_to_keep, indices_to_keep]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mSX <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Sex<span class="dv">-1</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mSX)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 296; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-246.0821   492.1642   502.1642   520.5821   502.3725   

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0416  0.2038     19     no  Study_ID 
sigma^2.2  0.2171  0.4660    296     no     ES_ID 
sigma^2.3  0.0092  0.0958      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 294) = 5665.9939, p-val &lt; .0001

Test of Moderators (coefficients 1:2):
F(df1 = 2, df2 = 294) = 4.7417, p-val = 0.0094

Model Results:

           estimate      se    tval   df    pval    ci.lb   ci.ub     
SexFemale    0.3055  0.0996  3.0678  294  0.0024   0.1095  0.5015  ** 
SexMale      0.1516  0.0828  1.8306  294  0.0682  -0.0114  0.3145   . 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>r2SX <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mSX), <span class="dv">4</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>r2SX</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
        0.0207         0.2062 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>orchard_sex<span class="ot">&lt;-</span><span class="fu">orchard_plot</span>(mSX,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Sex"</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">xlab =</span> <span class="st">"lnRR"</span>, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">flip =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)<span class="sc">+</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                                                                    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span> ))</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>orchard_sex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="uni_moderators_files/figure-html/orchard_sex-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_sex_lnRR.pdf"</span>),</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_sex,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_sex_lnRR.jpg"</span>),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_sex,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">7</span>,  </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">9</span>,  </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Contrast between levels (Female as reference level)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>mSX <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Sex,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mSX)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 296; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-246.0821   492.1642   502.1642   520.5821   502.3725   

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0416  0.2038     19     no  Study_ID 
sigma^2.2  0.2171  0.4660    296     no     ES_ID 
sigma^2.3  0.0092  0.0958      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 294) = 5665.9939, p-val &lt; .0001

Test of Moderators (coefficient 2):
F(df1 = 1, df2 = 294) = 2.9038, p-val = 0.0894

Model Results:

         estimate      se     tval   df    pval    ci.lb   ci.ub     
intrcpt    0.3055  0.0996   3.0678  294  0.0024   0.1095  0.5015  ** 
SexMale   -0.1539  0.0903  -1.7041  294  0.0894  -0.3317  0.0238   . 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>Meta_genre</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mMG <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Meta_genre<span class="dv">-1</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mMG)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 299; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-246.5479   493.0958   507.0958   532.9047   507.4861   

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0503  0.2242     20     no  Study_ID 
sigma^2.2  0.2169  0.4657    299     no     ES_ID 
sigma^2.3  0.0000  0.0000      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 295) = 5629.8481, p-val &lt; .0001

Test of Moderators (coefficients 1:4):
F(df1 = 4, df2 = 295) = 3.0367, p-val = 0.0178

Model Results:

                                            estimate      se    tval   df 
Meta_genreMixed                               0.2102  0.1446  1.4534  295 
Meta_genrePopular Contemporary Music          0.0928  0.1887  0.4921  295 
Meta_genreTraditional Music / Folk / World    0.5706  0.2606  2.1897  295 
Meta_genreWestern Art Music / Orchestral      0.1861  0.0762  2.4436  295 
                                              pval    ci.lb   ci.ub    
Meta_genreMixed                             0.1472  -0.0744  0.4947    
Meta_genrePopular Contemporary Music        0.6230  -0.2785  0.4642    
Meta_genreTraditional Music / Folk / World  0.0293   0.0578  1.0834  * 
Meta_genreWestern Art Music / Orchestral    0.0151   0.0362  0.3360  * 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>r2MG <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mMG), <span class="dv">4</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>r2MG</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
        0.0221         0.2060 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>orchard_genre<span class="ot">&lt;-</span><span class="fu">orchard_plot</span>(mMG,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Meta_genre"</span>,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">xlab =</span> <span class="st">"lnRR"</span>, </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">flip =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)<span class="sc">+</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>                                                                    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span> ))</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>orchard_genre</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="uni_moderators_files/figure-html/orchard_music_genre-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_genre_lnRR.pdf"</span>),</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_genre,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_genre_lnRR.jpg"</span>),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_genre,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">9</span>,  </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">7</span>,  </span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Contrasts between levels</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The Generator</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>contra_mMG <span class="ot">&lt;-</span> <span class="fu">contrast_fun</span>(<span class="at">data =</span> db, </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">response =</span> lnRR, </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">moderator =</span> Meta_genre, </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">VCV =</span> VCV)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The Harvester</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>t1<span class="ot">&lt;-</span><span class="fu">get_estimate</span>(<span class="at">model =</span> mMG, <span class="at">contra =</span> contra_mMG, <span class="at">moderator =</span> Meta_genre)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># The Cleaner</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">clean_unique_contrasts</span>(<span class="at">full_results_table =</span> t1, <span class="at">level_count =</span> <span class="dv">4</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>t2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 7
   Levels                   Estimate Lower_CI Upper_CI P_value Lower_PI Upper_PI
   &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 Mixed                      0.210   -0.0744    0.495  0.147    -0.846    1.27 
 2 Popular Contemporary Mu…   0.0928  -0.278     0.464  0.623    -0.990    1.18 
 3 Traditional Music / Fol…   0.571    0.0578    1.08   0.0293   -0.569    1.71 
 4 Western Art Music / Orc…   0.186    0.0362    0.336  0.0151   -0.842    1.21 
 5 Popular Contemporary Mu…  -0.117   -0.562     0.328  0.604    -1.23     0.993
 6 Traditional Music / Fol…   0.360   -0.225     0.946  0.227    -0.813    1.53 
 7 Western Art Music / Orc…  -0.0241  -0.334     0.286  0.879    -1.09     1.04 
 8 Traditional Music / Fol…   0.478   -0.145     1.10   0.132    -0.715    1.67 
 9 Western Art Music / Orc…   0.0933  -0.291     0.478  0.633    -0.994    1.18 
10 Western Art Music / Orc…  -0.384   -0.916     0.147  0.156    -1.53     0.763</code></pre>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<p>Music_exposure_duration</p>
<div class="cell" data-fold="true">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>k_counts <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Music_exposure_duration) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">k_es =</span> <span class="fu">n</span>())</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>levels_to_keep <span class="ot">&lt;-</span> k_counts <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(k_es <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Music_exposure_duration)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>db_filtered <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Music_exposure_duration <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>indices_to_keep <span class="ot">&lt;-</span> <span class="fu">which</span>(db<span class="sc">$</span>Music_exposure_duration <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>VCV_filtered <span class="ot">&lt;-</span> VCV[indices_to_keep, indices_to_keep]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>mMED <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Music_exposure_duration<span class="dv">-1</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mMED)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 298; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-246.8335   493.6669   505.6669   527.7888   505.9586   

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0511  0.2261     20     no  Study_ID 
sigma^2.2  0.2189  0.4678    298     no     ES_ID 
sigma^2.3  0.0000  0.0000      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 295) = 5690.1544, p-val &lt; .0001

Test of Moderators (coefficients 1:3):
F(df1 = 3, df2 = 295) = 3.6483, p-val = 0.0131

Model Results:

                               estimate      se    tval   df    pval    ci.lb 
Music_exposure_durationAcute     0.2579  0.1109  2.3262  295  0.0207   0.0397 
Music_exposure_durationMedium    0.0657  0.1385  0.4743  295  0.6357  -0.2069 
Music_exposure_durationShort     0.2402  0.1043  2.3041  295  0.0219   0.0350 
                                ci.ub    
Music_exposure_durationAcute   0.4760  * 
Music_exposure_durationMedium  0.3383    
Music_exposure_durationShort   0.4454  * 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>r2MED <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mMED), <span class="dv">4</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>r2MED</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
        0.0204         0.2059 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>orchard_exposure<span class="ot">&lt;-</span><span class="fu">orchard_plot</span>(mMED,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Music_exposure_duration"</span>,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span> <span class="st">"log response ratio (lnRR)"</span>, </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">flip =</span> <span class="cn">FALSE</span>)  <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)<span class="sc">+</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span> ))</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>orchard_exposure</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="uni_moderators_files/figure-html/orchard_music_exposure-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_exposure_lnRR.pdf"</span>),</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_exposure,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_exposure_lnRR.jpg"</span>),</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_exposure,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">9</span>,  </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">7</span>,  </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Contrasts between levels</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>LEVELS <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Acute"</span>, <span class="st">"Medium"</span>, <span class="st">"Short"</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>MOD_NAME <span class="ot">&lt;-</span> <span class="st">"Music_exposure_duration"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model A: Reference = Acute (A vs B, A vs C)</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>db_filtered<span class="sc">$</span>moderator_relevel_A <span class="ot">&lt;-</span> <span class="fu">relevel</span>(db_filtered<span class="sc">$</span>Music_exposure_duration, <span class="at">ref =</span> LEVELS[<span class="dv">1</span>])</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>model_A <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mods =</span> <span class="sc">~</span> moderator_relevel_A,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>, <span class="at">method =</span> <span class="st">"REML"</span>, <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>model_A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 298; method: REML)

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0511  0.2261     20     no  Study_ID 
sigma^2.2  0.2189  0.4678    298     no     ES_ID 
sigma^2.3  0.0000  0.0000      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 295) = 5690.1544, p-val &lt; .0001

Test of Moderators (coefficients 2:3):
F(df1 = 2, df2 = 295) = 0.6764, p-val = 0.5092

Model Results:

                           estimate      se     tval   df    pval    ci.lb 
intrcpt                      0.2579  0.1109   2.3262  295  0.0207   0.0397 
moderator_relevel_AMedium   -0.1922  0.1774  -1.0832  295  0.2796  -0.5413 
moderator_relevel_AShort    -0.0177  0.1522  -0.1160  295  0.9077  -0.3172 
                            ci.ub    
intrcpt                    0.4760  * 
moderator_relevel_AMedium  0.1570    
moderator_relevel_AShort   0.2818    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model B: Reference = Medium (B vs C)</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>db_filtered<span class="sc">$</span>moderator_relevel_B <span class="ot">&lt;-</span> <span class="fu">relevel</span>(db_filtered<span class="sc">$</span>Music_exposure_duration, <span class="at">ref =</span> LEVELS[<span class="dv">2</span>])</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>model_B <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mods =</span> <span class="sc">~</span> moderator_relevel_B,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>, <span class="at">method =</span> <span class="st">"REML"</span>, <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>model_B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 298; method: REML)

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0511  0.2261     20     no  Study_ID 
sigma^2.2  0.2189  0.4678    298     no     ES_ID 
sigma^2.3  0.0000  0.0000      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 295) = 5690.1544, p-val &lt; .0001

Test of Moderators (coefficients 2:3):
F(df1 = 2, df2 = 295) = 0.6764, p-val = 0.5092

Model Results:

                          estimate      se    tval   df    pval    ci.lb 
intrcpt                     0.0657  0.1385  0.4743  295  0.6357  -0.2069 
moderator_relevel_BAcute    0.1922  0.1774  1.0832  295  0.2796  -0.1570 
moderator_relevel_BShort    0.1745  0.1734  1.0067  295  0.3149  -0.1667 
                           ci.ub    
intrcpt                   0.3383    
moderator_relevel_BAcute  0.5413    
moderator_relevel_BShort  0.5157    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model C: Reference = Short (C estimate)</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>db_filtered<span class="sc">$</span>moderator_relevel_C <span class="ot">&lt;-</span> <span class="fu">relevel</span>(db_filtered<span class="sc">$</span>Music_exposure_duration, <span class="at">ref =</span> LEVELS[<span class="dv">3</span>])</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>model_C <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mods =</span> <span class="sc">~</span> moderator_relevel_C,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>, <span class="at">method =</span> <span class="st">"REML"</span>, <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>model_C</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 298; method: REML)

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0511  0.2261     20     no  Study_ID 
sigma^2.2  0.2189  0.4678    298     no     ES_ID 
sigma^2.3  0.0000  0.0000      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 295) = 5690.1544, p-val &lt; .0001

Test of Moderators (coefficients 2:3):
F(df1 = 2, df2 = 295) = 0.6764, p-val = 0.5092

Model Results:

                           estimate      se     tval   df    pval    ci.lb 
intrcpt                      0.2402  0.1043   2.3041  295  0.0219   0.0350 
moderator_relevel_CAcute     0.0177  0.1522   0.1160  295  0.9077  -0.2818 
moderator_relevel_CMedium   -0.1745  0.1734  -1.0067  295  0.3149  -0.5157 
                            ci.ub    
intrcpt                    0.4454  * 
moderator_relevel_CAcute   0.3172    
moderator_relevel_CMedium  0.1667    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>mEXD <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Experimental_design<span class="dv">-1</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mEXD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 299; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-246.4081   492.8162   504.8162   526.9584   505.1069   

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0445  0.2109     20     no  Study_ID 
sigma^2.2  0.2164  0.4652    299     no     ES_ID 
sigma^2.3  0.0000  0.0000      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 296) = 5576.1338, p-val &lt; .0001

Test of Moderators (coefficients 1:3):
F(df1 = 3, df2 = 296) = 4.8125, p-val = 0.0027

Model Results:

                                                estimate      se    tval   df 
Experimental_designFactorial                      0.1711  0.0698  2.4519  296 
Experimental_designPosttest-Only Control Group    0.3699  0.1051  3.5189  296 
Experimental_designRepeated Measures              0.1651  0.2040  0.8096  296 
                                                  pval    ci.lb   ci.ub      
Experimental_designFactorial                    0.0148   0.0338  0.3084    * 
Experimental_designPosttest-Only Control Group  0.0005   0.1630  0.5768  *** 
Experimental_designRepeated Measures            0.4188  -0.2363  0.5665      

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>r2EXD <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mEXD), <span class="dv">4</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>r2EXD</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
        0.0219         0.1888 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>orchard_design<span class="ot">&lt;-</span><span class="fu">orchard_plot</span>(mEXD,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Experimental_design"</span>,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span> <span class="st">"log response ratio (lnRR)"</span>, </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">flip=</span><span class="cn">FALSE</span>) <span class="sc">+</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span> ))</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>orchard_design</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="uni_moderators_files/figure-html/orchard_experimental_design-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_design_lnRR.pdf"</span>),</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_design,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_design_lnRR.jpg"</span>),</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_design,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">9</span>,  </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">7</span>,  </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Contrasts between levels</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The Generator</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>contra_mEXD <span class="ot">&lt;-</span> <span class="fu">contrast_fun</span>(<span class="at">data =</span> db, </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">response =</span> lnRR, </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">moderator =</span> Experimental_design, </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">VCV =</span> VCV)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The Harvester</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>t1<span class="ot">&lt;-</span><span class="fu">get_estimate</span>(<span class="at">model =</span> mEXD, <span class="at">contra =</span> contra_mEXD, <span class="at">moderator =</span> Experimental_design)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co"># The Cleaner</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">clean_unique_contrasts</span>(<span class="at">full_results_table =</span> t1, <span class="at">level_count =</span> <span class="dv">3</span>)</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>t2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 7
  Levels                    Estimate Lower_CI Upper_CI P_value Lower_PI Upper_PI
  &lt;chr&gt;                        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 Factorial                  0.171    3.38e-2 0.308    1.48e-2   -0.843    1.19 
2 Posttest-Only Control Gr…  0.370    1.63e-1 0.577    5.01e-4   -0.656    1.40 
3 Repeated Measures          0.165   -2.36e-1 0.567    4.19e-1   -0.917    1.25 
4 Posttest-Only Control Gr…  0.199   -3.80e-4 0.398    5.04e-2   -0.826    1.22 
5 Repeated Measures-Factor… -0.00597 -4.30e-1 0.418    9.78e-1   -1.10     1.09 
6 Factorial-Posttest-Only … -0.199   -3.98e-1 0.000380 5.04e-2   -1.22     0.826
7 Repeated Measures-Postte… -0.205   -6.56e-1 0.247    3.73e-1   -1.31     0.897</code></pre>
</div>
</div>
</div>
<div id="tabset-2-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>mIB <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Induced behaviour</span><span class="st">`</span><span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mIB)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 299; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-245.0936   490.1871   500.1871   518.6558   500.3933   

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0482  0.2195     20     no  Study_ID 
sigma^2.2  0.2094  0.4576    299     no     ES_ID 
sigma^2.3  0.0000  0.0000      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 297) = 5340.7378, p-val &lt; .0001

Test of Moderators (coefficients 1:2):
F(df1 = 2, df2 = 297) = 9.4196, p-val = 0.0001

Model Results:

                            estimate      se    tval   df    pval    ci.lb 
`Induced behaviour`Induced    0.4524  0.1055  4.2890  297  &lt;.0001   0.2448 
`Induced behaviour`Innate     0.1300  0.0695  1.8697  297  0.0625  -0.0068 
                             ci.ub      
`Induced behaviour`Induced  0.6600  *** 
`Induced behaviour`Innate   0.2668    . 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>r2IB <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mIB), <span class="dv">4</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>r2IB</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
        0.0550         0.2317 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>orchard_behaviour<span class="ot">&lt;-</span><span class="fu">orchard_plot</span>(mIB,</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Induced behaviour"</span>,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span> <span class="st">"log response ratio (lnRR)"</span>, </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">flip =</span> <span class="cn">FALSE</span>) <span class="sc">+</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span> ))</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>orchard_behaviour</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="uni_moderators_files/figure-html/orchard_INDUCED_BEHAVIOUR-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_behaviour_lnRR.pdf"</span>),</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_behaviour,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_behaviour_lnRR.jpg"</span>),</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_behaviour,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">9</span>,  </span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">7</span>,  </span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>mIB <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Induced behaviour</span><span class="st">`</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mIB)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 299; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-245.0936   490.1871   500.1871   518.6558   500.3933   

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0482  0.2195     20     no  Study_ID 
sigma^2.2  0.2094  0.4576    299     no     ES_ID 
sigma^2.3  0.0000  0.0000      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 297) = 5340.7378, p-val &lt; .0001

Test of Moderators (coefficient 2):
F(df1 = 1, df2 = 297) = 8.8507, p-val = 0.0032

Model Results:

                           estimate      se     tval   df    pval    ci.lb 
intrcpt                      0.4524  0.1055   4.2890  297  &lt;.0001   0.2448 
`Induced behaviour`Innate   -0.3225  0.1084  -2.9750  297  0.0032  -0.5358 
                             ci.ub      
intrcpt                     0.6600  *** 
`Induced behaviour`Innate  -0.1092   ** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div id="tabset-2-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>mRT <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Relative_timing<span class="dv">-1</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mRT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 299; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-245.9058   491.8116   503.8116   525.9537   504.1022   

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0486  0.2205     20     no  Study_ID 
sigma^2.2  0.2145  0.4631    299     no     ES_ID 
sigma^2.3  0.0000  0.0000      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 296) = 5658.5329, p-val &lt; .0001

Test of Moderators (coefficients 1:3):
F(df1 = 3, df2 = 296) = 5.1444, p-val = 0.0018

Model Results:

                           estimate      se     tval   df    pval    ci.lb 
Relative_timingBefore        0.2226  0.0711   3.1296  296  0.0019   0.0826 
Relative_timingBoth          0.1856  0.1364   1.3605  296  0.1747  -0.0829 
Relative_timingConcurrent   -0.3384  0.2410  -1.4041  296  0.1614  -0.8126 
                            ci.ub     
Relative_timingBefore      0.3626  ** 
Relative_timingBoth        0.4541     
Relative_timingConcurrent  0.1359     

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>r2RT <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mRT), <span class="dv">4</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>r2RT</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
        0.0232         0.2038 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">orchard_plot</span>(mRT,</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Relative_timing"</span>,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span> <span class="st">"log response ratio (lnRR)"</span>, </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">angle =</span> <span class="dv">30</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="uni_moderators_files/figure-html/orchard_relative_timing-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>mRT <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Relative_timing,</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mRT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 299; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-245.9058   491.8116   503.8116   525.9537   504.1022   

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0486  0.2205     20     no  Study_ID 
sigma^2.2  0.2145  0.4631    299     no     ES_ID 
sigma^2.3  0.0000  0.0000      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 296) = 5658.5329, p-val &lt; .0001

Test of Moderators (coefficients 2:3):
F(df1 = 2, df2 = 296) = 2.7521, p-val = 0.0654

Model Results:

                           estimate      se     tval   df    pval    ci.lb 
intrcpt                      0.2226  0.0711   3.1296  296  0.0019   0.0826 
Relative_timingBoth         -0.0370  0.1479  -0.2503  296  0.8026  -0.3280 
Relative_timingConcurrent   -0.5610  0.2420  -2.3176  296  0.0212  -1.0373 
                             ci.ub     
intrcpt                     0.3626  ** 
Relative_timingBoth         0.2540     
Relative_timingConcurrent  -0.0846   * 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div id="tabset-2-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-9-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>mEXP <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Experimental_procedures<span class="dv">-1</span>,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mEXP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 299; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-249.0385   498.0770   508.0770   526.5456   508.2832   

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0541  0.2326     20     no  Study_ID 
sigma^2.2  0.2160  0.4648    299     no     ES_ID 
sigma^2.3  0.0000  0.0000      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 297) = 5655.8740, p-val &lt; .0001

Test of Moderators (coefficients 1:2):
F(df1 = 2, df2 = 297) = 5.0008, p-val = 0.0073

Model Results:

                             estimate      se    tval   df    pval    ci.lb 
Experimental_proceduresNone    0.2171  0.0689  3.1523  297  0.0018   0.0816 
Experimental_proceduresSham    0.1236  0.1149  1.0749  297  0.2833  -0.1027 
                              ci.ub     
Experimental_proceduresNone  0.3527  ** 
Experimental_proceduresSham  0.3498     

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>r2EXP <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mEXP), <span class="dv">4</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>r2EXP</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
        0.0053         0.2045 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">orchard_plot</span>(mEXP,</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Experimental_procedures"</span>,</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span> <span class="st">"log response ratio (lnRR)"</span>, </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">angle =</span> <span class="dv">30</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="uni_moderators_files/figure-html/orchard_experimental_procedures-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>mEXP <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Experimental_procedures,</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mEXP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 299; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-249.0385   498.0770   508.0770   526.5456   508.2832   

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0541  0.2326     20     no  Study_ID 
sigma^2.2  0.2160  0.4648    299     no     ES_ID 
sigma^2.3  0.0000  0.0000      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 297) = 5655.8740, p-val &lt; .0001

Test of Moderators (coefficient 2):
F(df1 = 1, df2 = 297) = 0.7682, p-val = 0.3815

Model Results:

                             estimate      se     tval   df    pval    ci.lb 
intrcpt                        0.2171  0.0689   3.1523  297  0.0018   0.0816 
Experimental_proceduresSham   -0.0936  0.1068  -0.8765  297  0.3815  -0.3037 
                              ci.ub     
intrcpt                      0.3527  ** 
Experimental_proceduresSham  0.1165     

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div id="tabset-2-10" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-10-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>mCC <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Control_conditions<span class="dv">-1</span>,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mCC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 299; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-246.1763   492.3527   502.3527   520.8214   502.5589   

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0448  0.2116     20     no  Study_ID 
sigma^2.2  0.2131  0.4617    299     no     ES_ID 
sigma^2.3  0.0000  0.0001      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 297) = 5322.2027, p-val &lt; .0001

Test of Moderators (coefficients 1:2):
F(df1 = 2, df2 = 297) = 8.6904, p-val = 0.0002

Model Results:

                                estimate      se    tval   df    pval   ci.lb 
Control_conditionsambiet sound    0.1811  0.0642  2.8215  297  0.0051  0.0548 
Control_conditionswhite noise     0.4433  0.1106  4.0088  297  &lt;.0001  0.2257 
                                 ci.ub      
Control_conditionsambiet sound  0.3074   ** 
Control_conditionswhite noise   0.6609  *** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>r2CC <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mCC), <span class="dv">4</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>r2CC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
        0.0331         0.2009 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">orchard_plot</span>(mCC,</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Control_conditions"</span>,</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span> <span class="st">"log response ratio (lnRR)"</span>, </span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">angle =</span> <span class="dv">30</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="uni_moderators_files/figure-html/orchard_control_condition-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>mCC <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Control_conditions,</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mCC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 299; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-246.1763   492.3527   502.3527   520.8214   502.5589   

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0448  0.2116     20     no  Study_ID 
sigma^2.2  0.2131  0.4617    299     no     ES_ID 
sigma^2.3  0.0000  0.0001      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 297) = 5322.2027, p-val &lt; .0001

Test of Moderators (coefficient 2):
F(df1 = 1, df2 = 297) = 6.8896, p-val = 0.0091

Model Results:

                               estimate      se    tval   df    pval   ci.lb 
intrcpt                          0.1811  0.0642  2.8215  297  0.0051  0.0548 
Control_conditionswhite noise    0.2622  0.0999  2.6248  297  0.0091  0.0656 
                                ci.ub     
intrcpt                        0.3074  ** 
Control_conditionswhite noise  0.4588  ** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div id="tabset-2-11" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-11-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Identify and Filter Low-K Levels</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>k_counts <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Assay_type) <span class="sc">%&gt;%</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">k_es =</span> <span class="fu">n</span>())</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the levels to keep (where k_es &gt;= 5)</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>levels_to_keep <span class="ot">&lt;-</span> k_counts <span class="sc">%&gt;%</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(k_es <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Assay_type)</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Create the Filtered Data Frame</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>db_filtered <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Assay_type <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Subset the VCV Matrix (CRITICAL STEP)</span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumes VCV matrix rows/columns match the original 'db' data frame indices.</span></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>indices_to_keep <span class="ot">&lt;-</span> <span class="fu">which</span>(db<span class="sc">$</span>Assay_type <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>VCV_filtered <span class="ot">&lt;-</span> VCV[indices_to_keep, indices_to_keep]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>mAT <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Assay_type<span class="dv">-1</span>,</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mAT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 290; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-234.3518   468.7035   486.7035   519.5443   487.3605   

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0309  0.1758     20     no  Study_ID 
sigma^2.2  0.2134  0.4620    290     no     ES_ID 
sigma^2.3  0.0040  0.0634      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 284) = 5402.4612, p-val &lt; .0001

Test of Moderators (coefficients 1:6):
F(df1 = 6, df2 = 284) = 3.8363, p-val = 0.0011

Model Results:

                                         estimate      se    tval   df    pval 
Assay_typeElevated Plus Maze               0.2817  0.0799  3.5271  284  0.0005 
Assay_typeForced Swim Test (FST)           0.3137  0.1102  2.8469  284  0.0047 
Assay_typeLight-Dark Box                   0.5529  0.1487  3.7195  284  0.0002 
Assay_typeOpen Field Test                  0.0662  0.0826  0.8012  284  0.4237 
Assay_typeSucrose Preference Test (SPT)    0.0790  0.1486  0.5318  284  0.5953 
Assay_typeTail Suspension Test (TST)       0.0939  0.1977  0.4750  284  0.6352 
                                           ci.lb   ci.ub      
Assay_typeElevated Plus Maze              0.1245  0.4388  *** 
Assay_typeForced Swim Test (FST)          0.0968  0.5307   ** 
Assay_typeLight-Dark Box                  0.2603  0.8455  *** 
Assay_typeOpen Field Test                -0.0964  0.2287      
Assay_typeSucrose Preference Test (SPT)  -0.2135  0.3715      
Assay_typeTail Suspension Test (TST)     -0.2952  0.4830      

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>r2AT <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mAT), <span class="dv">4</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>r2AT</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
        0.0728         0.2031 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">orchard_plot</span>(mAT,</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Assay_type"</span>,</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span> <span class="st">"log response ratio (lnRR)"</span>, </span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">angle =</span> <span class="dv">30</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="uni_moderators_files/figure-html/orchard_assay_type-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>mAT <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Assay_type,</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mAT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 290; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-234.3518   468.7035   486.7035   519.5443   487.3605   

Variance Components:

            estim    sqrt  nlvls  fixed    factor 
sigma^2.1  0.0309  0.1758     20     no  Study_ID 
sigma^2.2  0.2134  0.4620    290     no     ES_ID 
sigma^2.3  0.0040  0.0634      6     no    Strain 

Test for Residual Heterogeneity:
QE(df = 284) = 5402.4612, p-val &lt; .0001

Test of Moderators (coefficients 2:6):
F(df1 = 5, df2 = 284) = 2.8417, p-val = 0.0160

Model Results:

                                         estimate      se     tval   df    pval 
intrcpt                                    0.2817  0.0799   3.5271  284  0.0005 
Assay_typeForced Swim Test (FST)           0.0321  0.1096   0.2928  284  0.7699 
Assay_typeLight-Dark Box                   0.2712  0.1333   2.0348  284  0.0428 
Assay_typeOpen Field Test                 -0.2155  0.0812  -2.6528  284  0.0084 
Assay_typeSucrose Preference Test (SPT)   -0.2026  0.1553  -1.3044  284  0.1932 
Assay_typeTail Suspension Test (TST)      -0.1878  0.2024  -0.9278  284  0.3543 
                                           ci.lb    ci.ub      
intrcpt                                   0.1245   0.4388  *** 
Assay_typeForced Swim Test (FST)         -0.1837   0.2478      
Assay_typeLight-Dark Box                  0.0089   0.5336    * 
Assay_typeOpen Field Test                -0.3754  -0.0556   ** 
Assay_typeSucrose Preference Test (SPT)  -0.5084   0.1031      
Assay_typeTail Suspension Test (TST)     -0.5861   0.2106      

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./overall_effect.html" class="pagination-link" aria-label="Overall effect">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Overall effect</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./multi_moderator.html" class="pagination-link" aria-label="Multi_moderator">
        <span class="nav-page-text"><span class="chapter-title">Multi_moderator</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb99" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Uni-moderators"</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>               DT,</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>               dtplyr,</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>               here, </span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>               knitr,</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>               tidyverse,</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>               patchwork,</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>               metafor,</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>               orchaRd, </span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load_and_clean_data</span></span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>db <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"data"</span>,<span class="st">"db_lnRR.csv"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(C_n, Ex_n, C_mean, Ex_mean, C_SE, Ex_SE, C_SD, Ex_SD), as.numeric))<span class="sc">%&gt;%</span></span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), as.factor)) </span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>VCV <span class="ot">&lt;-</span> metafor<span class="sc">::</span><span class="fu">vcalc</span>(</span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">vi =</span> lnRR_var,</span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">cluster =</span> Cohort_ID, <span class="co"># The clustering variable (Study_ID + Ex_ID)</span></span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">obs =</span> ES_ID,         <span class="co"># The unique observation/effect size ID</span></span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">rho =</span> <span class="fl">0.5</span>,           <span class="co"># Assumed correlation between outcomes from the same cohort</span></span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> db </span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a>Variable definitions:</span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Variable Name <span class="pp">|</span> Definition <span class="pp">|</span></span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a><span class="pp">|:-----------------------------------|:-----------------------------------|</span></span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **`ES_ID`** <span class="pp">|</span> Unique row identifier for each $\text{lnRR}$ effect size. <span class="pp">|</span></span>
<span id="cb99-43"><a href="#cb99-43" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **`Study_ID`** <span class="pp">|</span> Identifier for the primary research paper. <span class="pp">|</span></span>
<span id="cb99-44"><a href="#cb99-44" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **`Cohort_ID`** <span class="pp">|</span> Identifier for specific experimental groups within a study. <span class="pp">|</span></span>
<span id="cb99-45"><a href="#cb99-45" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **`Outcome_type`** | The behavioral construct measured. Levels: **Anxiety**, **Depression**, **both**, **unclear**. <span class="pp">|</span></span>
<span id="cb99-46"><a href="#cb99-46" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **`Lifestage_exposure`** | Animal's developmental stage during music exposure. Levels: **Adolescent**, **Juvenile**, **Young adult**, **Adult**, **Mixed**, **Unclear**. <span class="pp">|</span></span>
<span id="cb99-47"><a href="#cb99-47" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **`Sex`** | Sex of the subjects. Levels: **Male**, **Female**. <span class="pp">|</span></span>
<span id="cb99-48"><a href="#cb99-48" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **`Strain`** <span class="pp">|</span> Specific animal strain or species used. <span class="pp">|</span></span>
<span id="cb99-49"><a href="#cb99-49" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **`Meta_genre`** | Categorization of the music stimulus. Levels: **Western Art Music / Orchestral**, **Popular Contemporary Music**, **Traditional Music / Folk / World**, **Mixed**, **Unclear**. <span class="pp">|</span></span>
<span id="cb99-50"><a href="#cb99-50" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **`Music_exposure_duration`** | Total time subjects were exposed to music. Levels: **Acute**, **short**, **medium**, **long**. <span class="pp">|</span></span>
<span id="cb99-51"><a href="#cb99-51" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **`Experimental_design`** | Study's methodological setup. Levels: **Posttest-Only Control Group**, **Randomized Block**, **Factorial**, **Repeated Measures**. <span class="pp">|</span></span>
<span id="cb99-52"><a href="#cb99-52" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **`Induced behaviour`** <span class="pp">|</span> Whether the tested behavior was innate or experimentally induced. <span class="pp">|</span></span>
<span id="cb99-53"><a href="#cb99-53" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **`Relative_timing`** | When music was administered relative to the behavioral test. Levels: **before**, **concurrent**, **both**, **not specified**. <span class="pp">|</span></span>
<span id="cb99-54"><a href="#cb99-54" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **`Experimental_procedures`** | Identifies non-treatment controls for interventions. Levels: **sham**, **none**. <span class="pp">|</span></span>
<span id="cb99-55"><a href="#cb99-55" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **`Control_condition`** | Description of the control group condition. Levels: **white noise**, **ambient noise** <span class="pp">|</span></span>
<span id="cb99-56"><a href="#cb99-56" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **`Assay_type`** <span class="pp">|</span> Type of behavioral test used. <span class="pp">|</span></span>
<span id="cb99-57"><a href="#cb99-57" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **`Overall_rob`** | Overall risk of bias assessment for each study. Levels: **2 (low)**, **1 (moderate)**, **0 (high)**. <span class="pp">|</span></span>
<span id="cb99-58"><a href="#cb99-58" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb99-59"><a href="#cb99-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-60"><a href="#cb99-60" aria-hidden="true" tabindex="-1"></a><span class="fu">## Functions for pairwise contrasts</span></span>
<span id="cb99-61"><a href="#cb99-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-62"><a href="#cb99-62" aria-hidden="true" tabindex="-1"></a>General Explanation This set of functions automates a common but tedious task in meta-analysis: calculating all pairwise comparisons between groups.</span>
<span id="cb99-63"><a href="#cb99-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-64"><a href="#cb99-64" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Function 1 (The Generator): Standard meta-regression usually compares all groups against a single "Reference" group. This function "hacks" that by re-running the model multiple times, rotating the reference group each time so that every group gets a turn as the baseline.</span>
<span id="cb99-65"><a href="#cb99-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-66"><a href="#cb99-66" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Function 2 (The Harvester): This extracts the statistical results (estimates, confidence intervals, p-values) from all those models and organizes them into a single, readable table.</span>
<span id="cb99-67"><a href="#cb99-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-68"><a href="#cb99-68" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Function 3 (The Cleaner): Because the first two steps calculate both "Group A vs B" and "Group B vs A" (which are mathematically identical), this function filters out the duplicates to leave you with a clean, unique list of comparisons.</span>
<span id="cb99-69"><a href="#cb99-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-70"><a href="#cb99-70" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb99-71"><a href="#cb99-71" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1. The Generator</span></span>
<span id="cb99-72"><a href="#cb99-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-75"><a href="#cb99-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-76"><a href="#cb99-76" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: contrast_function</span></span>
<span id="cb99-77"><a href="#cb99-77" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold: TRUE</span></span>
<span id="cb99-78"><a href="#cb99-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-79"><a href="#cb99-79" aria-hidden="true" tabindex="-1"></a>contrast_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(data, response, moderator, VCV){</span>
<span id="cb99-80"><a href="#cb99-80" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-81"><a href="#cb99-81" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 1. Setup Dynamic Names ---</span></span>
<span id="cb99-82"><a href="#cb99-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We grab the actual names of the columns so we can use them in the formulas below</span></span>
<span id="cb99-83"><a href="#cb99-83" aria-hidden="true" tabindex="-1"></a>    mod  <span class="ot">&lt;-</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(moderator))</span>
<span id="cb99-84"><a href="#cb99-84" aria-hidden="true" tabindex="-1"></a>    resp <span class="ot">&lt;-</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(response))</span>
<span id="cb99-85"><a href="#cb99-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-86"><a href="#cb99-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 2. Identify Groups ---</span></span>
<span id="cb99-87"><a href="#cb99-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find all unique categories in the moderator and ensure it's a factor</span></span>
<span id="cb99-88"><a href="#cb99-88" aria-hidden="true" tabindex="-1"></a>    names <span class="ot">&lt;-</span> <span class="fu">levels</span>(<span class="fu">as.factor</span>(data[[mod]]))</span>
<span id="cb99-89"><a href="#cb99-89" aria-hidden="true" tabindex="-1"></a>    moderator <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data[[mod]])</span>
<span id="cb99-90"><a href="#cb99-90" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-91"><a href="#cb99-91" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 3. The Model Runner ---</span></span>
<span id="cb99-92"><a href="#cb99-92" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This internal function fits the meta-regression repeatedly.</span></span>
<span id="cb99-93"><a href="#cb99-93" aria-hidden="true" tabindex="-1"></a>    <span class="co"># It changes the 'ref' (reference level) dynamically each time.</span></span>
<span id="cb99-94"><a href="#cb99-94" aria-hidden="true" tabindex="-1"></a>    run_rma <span class="ot">&lt;-</span> <span class="cf">function</span>(name) {</span>
<span id="cb99-95"><a href="#cb99-95" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rma.mv</span>(<span class="at">yi =</span> data[[resp]], </span>
<span id="cb99-96"><a href="#cb99-96" aria-hidden="true" tabindex="-1"></a>               <span class="at">V =</span> VCV, </span>
<span id="cb99-97"><a href="#cb99-97" aria-hidden="true" tabindex="-1"></a>               <span class="co"># Here is the magic: we force the model to use 'name' as the baseline</span></span>
<span id="cb99-98"><a href="#cb99-98" aria-hidden="true" tabindex="-1"></a>               <span class="at">mods =</span> <span class="sc">~</span> <span class="fu">relevel</span>(moderator, <span class="at">ref =</span> name), </span>
<span id="cb99-99"><a href="#cb99-99" aria-hidden="true" tabindex="-1"></a>               <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>Study_ID, <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>ES_ID, <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>Strain), </span>
<span id="cb99-100"><a href="#cb99-100" aria-hidden="true" tabindex="-1"></a>               <span class="at">test =</span> <span class="st">"t"</span>, </span>
<span id="cb99-101"><a href="#cb99-101" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> data, </span>
<span id="cb99-102"><a href="#cb99-102" aria-hidden="true" tabindex="-1"></a>               <span class="at">sparse =</span> <span class="cn">TRUE</span>)</span>
<span id="cb99-103"><a href="#cb99-103" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb99-104"><a href="#cb99-104" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-105"><a href="#cb99-105" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- 4. Loop Through Groups ---</span></span>
<span id="cb99-106"><a href="#cb99-106" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We run the model n-1 times (we don't need the last one as it's covered by previous runs).</span></span>
<span id="cb99-107"><a href="#cb99-107" aria-hidden="true" tabindex="-1"></a>    <span class="co"># map() iterates through the names and applies run_rma() to each.</span></span>
<span id="cb99-108"><a href="#cb99-108" aria-hidden="true" tabindex="-1"></a>    contra <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(names[<span class="sc">-</span><span class="fu">length</span>(names)], run_rma)</span>
<span id="cb99-109"><a href="#cb99-109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-110"><a href="#cb99-110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(contra)</span>
<span id="cb99-111"><a href="#cb99-111" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb99-112"><a href="#cb99-112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-113"><a href="#cb99-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-114"><a href="#cb99-114" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2. The Harvester</span></span>
<span id="cb99-115"><a href="#cb99-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-118"><a href="#cb99-118" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-119"><a href="#cb99-119" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: the harvester_function</span></span>
<span id="cb99-120"><a href="#cb99-120" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold: TRUE</span></span>
<span id="cb99-121"><a href="#cb99-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-122"><a href="#cb99-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-123"><a href="#cb99-123" aria-hidden="true" tabindex="-1"></a>get_estimate <span class="ot">&lt;-</span> <span class="cf">function</span>(model, contra, moderator) {</span>
<span id="cb99-124"><a href="#cb99-124" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-125"><a href="#cb99-125" aria-hidden="true" tabindex="-1"></a>    mod <span class="ot">&lt;-</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(moderator))</span>
<span id="cb99-126"><a href="#cb99-126" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-127"><a href="#cb99-127" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Utility: Make text look nice (e.g., "control" -&gt; "Control")</span></span>
<span id="cb99-128"><a href="#cb99-128" aria-hidden="true" tabindex="-1"></a>    capitalize_first <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb99-129"><a href="#cb99-129" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">toupper</span>(<span class="fu">substring</span>(x, <span class="dv">1</span>, <span class="dv">1</span>)), <span class="fu">substring</span>(x, <span class="dv">2</span>))</span>
<span id="cb99-130"><a href="#cb99-130" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb99-131"><a href="#cb99-131" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-132"><a href="#cb99-132" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- Helper A: Get Group Means ---</span></span>
<span id="cb99-133"><a href="#cb99-133" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extracts the estimated mean effect size for each group from the base model</span></span>
<span id="cb99-134"><a href="#cb99-134" aria-hidden="true" tabindex="-1"></a>    get_pred1 <span class="ot">&lt;-</span> <span class="cf">function</span> (model, <span class="at">mod =</span> mod) {</span>
<span id="cb99-135"><a href="#cb99-135" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Clean up row names to just get the group name</span></span>
<span id="cb99-136"><a href="#cb99-136" aria-hidden="true" tabindex="-1"></a>        name_raw <span class="ot">&lt;-</span> <span class="fu">as.character</span>(stringr<span class="sc">::</span><span class="fu">str_replace</span>(<span class="fu">row.names</span>(model<span class="sc">$</span>beta), mod, <span class="st">""</span>))</span>
<span id="cb99-137"><a href="#cb99-137" aria-hidden="true" tabindex="-1"></a>        name <span class="ot">&lt;-</span> <span class="fu">capitalize_first</span>(name_raw)</span>
<span id="cb99-138"><a href="#cb99-138" aria-hidden="true" tabindex="-1"></a>        len <span class="ot">&lt;-</span> <span class="fu">length</span>(name)</span>
<span id="cb99-139"><a href="#cb99-139" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb99-140"><a href="#cb99-140" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create a dummy matrix to predict the mean for each group individually</span></span>
<span id="cb99-141"><a href="#cb99-141" aria-hidden="true" tabindex="-1"></a>        newdata <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> len, <span class="at">nrow =</span> len)</span>
<span id="cb99-142"><a href="#cb99-142" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>len) {</span>
<span id="cb99-143"><a href="#cb99-143" aria-hidden="true" tabindex="-1"></a>            pos <span class="ot">&lt;-</span> <span class="fu">which</span>(model<span class="sc">$</span>X[, i] <span class="sc">==</span> <span class="dv">1</span>)[[<span class="dv">1</span>]] </span>
<span id="cb99-144"><a href="#cb99-144" aria-hidden="true" tabindex="-1"></a>            newdata[i, ] <span class="ot">&lt;-</span> model<span class="sc">$</span>X[pos, ]       </span>
<span id="cb99-145"><a href="#cb99-145" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb99-146"><a href="#cb99-146" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb99-147"><a href="#cb99-147" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Predict values</span></span>
<span id="cb99-148"><a href="#cb99-148" aria-hidden="true" tabindex="-1"></a>        pred <span class="ot">&lt;-</span> metafor<span class="sc">::</span><span class="fu">predict.rma</span>(model, <span class="at">newmods =</span> newdata)</span>
<span id="cb99-149"><a href="#cb99-149" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb99-150"><a href="#cb99-150" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Format into a tibble</span></span>
<span id="cb99-151"><a href="#cb99-151" aria-hidden="true" tabindex="-1"></a>        tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb99-152"><a href="#cb99-152" aria-hidden="true" tabindex="-1"></a>            <span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> name, <span class="at">labels =</span> name),</span>
<span id="cb99-153"><a href="#cb99-153" aria-hidden="true" tabindex="-1"></a>            <span class="at">estimate =</span> pred<span class="sc">$</span>pred,</span>
<span id="cb99-154"><a href="#cb99-154" aria-hidden="true" tabindex="-1"></a>            <span class="at">lowerCL =</span> pred<span class="sc">$</span>ci.lb, <span class="at">upperCL =</span> pred<span class="sc">$</span>ci.ub,</span>
<span id="cb99-155"><a href="#cb99-155" aria-hidden="true" tabindex="-1"></a>            <span class="at">pval =</span> model<span class="sc">$</span>pval, </span>
<span id="cb99-156"><a href="#cb99-156" aria-hidden="true" tabindex="-1"></a>            <span class="at">lowerPR =</span> pred<span class="sc">$</span>cr.lb, <span class="at">upperPR =</span> pred<span class="sc">$</span>cr.ub</span>
<span id="cb99-157"><a href="#cb99-157" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb99-158"><a href="#cb99-158" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb99-159"><a href="#cb99-159" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-160"><a href="#cb99-160" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- Helper B: Get Pairwise Differences ---</span></span>
<span id="cb99-161"><a href="#cb99-161" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extracts the "contrasts" (differences between groups) from the re-leveled models</span></span>
<span id="cb99-162"><a href="#cb99-162" aria-hidden="true" tabindex="-1"></a>    get_pred2 <span class="ot">&lt;-</span> <span class="cf">function</span> (model) {</span>
<span id="cb99-163"><a href="#cb99-163" aria-hidden="true" tabindex="-1"></a>        name <span class="ot">&lt;-</span> <span class="fu">row.names</span>(model<span class="sc">$</span>beta) </span>
<span id="cb99-164"><a href="#cb99-164" aria-hidden="true" tabindex="-1"></a>        len <span class="ot">&lt;-</span> <span class="fu">length</span>(name)</span>
<span id="cb99-165"><a href="#cb99-165" aria-hidden="true" tabindex="-1"></a>        newdata <span class="ot">&lt;-</span> <span class="fu">diag</span>(len)</span>
<span id="cb99-166"><a href="#cb99-166" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb99-167"><a href="#cb99-167" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1. Get the Intercept (The Reference Group Mean)</span></span>
<span id="cb99-168"><a href="#cb99-168" aria-hidden="true" tabindex="-1"></a>        pred1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(metafor<span class="sc">::</span><span class="fu">predict.rma</span>(model, <span class="at">newmods =</span> newdata[<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb99-169"><a href="#cb99-169" aria-hidden="true" tabindex="-1"></a>        <span class="fu">names</span>(pred1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pred"</span>, <span class="st">"se"</span>, <span class="st">"ci.lb"</span>, <span class="st">"ci.ub"</span>, <span class="st">"cr.lb"</span>, <span class="st">"cr.ub"</span>) </span>
<span id="cb99-170"><a href="#cb99-170" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb99-171"><a href="#cb99-171" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2. Get the Contrasts (Difference from Reference)</span></span>
<span id="cb99-172"><a href="#cb99-172" aria-hidden="true" tabindex="-1"></a>        pred2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(metafor<span class="sc">::</span><span class="fu">predict.rma</span>(model, <span class="at">intercept =</span> <span class="cn">FALSE</span>, <span class="at">newmods =</span> newdata[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb99-173"><a href="#cb99-173" aria-hidden="true" tabindex="-1"></a>        <span class="fu">names</span>(pred2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pred"</span>, <span class="st">"se"</span>, <span class="st">"ci.lb"</span>, <span class="st">"ci.ub"</span>, <span class="st">"cr.lb"</span>, <span class="st">"cr.ub"</span>) </span>
<span id="cb99-174"><a href="#cb99-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-175"><a href="#cb99-175" aria-hidden="true" tabindex="-1"></a>        pred <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pred1, pred2)</span>
<span id="cb99-176"><a href="#cb99-176" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb99-177"><a href="#cb99-177" aria-hidden="true" tabindex="-1"></a>        tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb99-178"><a href="#cb99-178" aria-hidden="true" tabindex="-1"></a>            <span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> name, <span class="at">labels =</span> name),</span>
<span id="cb99-179"><a href="#cb99-179" aria-hidden="true" tabindex="-1"></a>            <span class="at">estimate =</span> pred<span class="sc">$</span>pred,</span>
<span id="cb99-180"><a href="#cb99-180" aria-hidden="true" tabindex="-1"></a>            <span class="at">lowerCL =</span> pred<span class="sc">$</span>ci.lb, <span class="at">upperCL =</span> pred<span class="sc">$</span>ci.ub,</span>
<span id="cb99-181"><a href="#cb99-181" aria-hidden="true" tabindex="-1"></a>            <span class="at">pval =</span> model<span class="sc">$</span>pval,</span>
<span id="cb99-182"><a href="#cb99-182" aria-hidden="true" tabindex="-1"></a>            <span class="at">lowerPR =</span> pred<span class="sc">$</span>cr.lb, <span class="at">upperPR =</span> pred<span class="sc">$</span>cr.ub</span>
<span id="cb99-183"><a href="#cb99-183" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb99-184"><a href="#cb99-184" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb99-185"><a href="#cb99-185" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-186"><a href="#cb99-186" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- Helper C: Combine Everything ---</span></span>
<span id="cb99-187"><a href="#cb99-187" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Stitches the group means and the pairwise differences into one big table</span></span>
<span id="cb99-188"><a href="#cb99-188" aria-hidden="true" tabindex="-1"></a>    mr_results <span class="ot">&lt;-</span> <span class="cf">function</span>(res1, res2) {</span>
<span id="cb99-189"><a href="#cb99-189" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-190"><a href="#cb99-190" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Logic to name the comparisons (e.g., "Treatment-Control") based on order</span></span>
<span id="cb99-191"><a href="#cb99-191" aria-hidden="true" tabindex="-1"></a>        get_ordered_contrast_names <span class="ot">&lt;-</span> <span class="cf">function</span>(level_names) {</span>
<span id="cb99-192"><a href="#cb99-192" aria-hidden="true" tabindex="-1"></a>            reference_levels <span class="ot">&lt;-</span> level_names[<span class="sc">-</span><span class="fu">length</span>(level_names)] </span>
<span id="cb99-193"><a href="#cb99-193" aria-hidden="true" tabindex="-1"></a>            ordered_names <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb99-194"><a href="#cb99-194" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb99-195"><a href="#cb99-195" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (ref <span class="cf">in</span> reference_levels) {</span>
<span id="cb99-196"><a href="#cb99-196" aria-hidden="true" tabindex="-1"></a>                coefficient_levels <span class="ot">&lt;-</span> level_names[level_names <span class="sc">!=</span> ref]</span>
<span id="cb99-197"><a href="#cb99-197" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Format: "ComparisonGroup - ReferenceGroup"</span></span>
<span id="cb99-198"><a href="#cb99-198" aria-hidden="true" tabindex="-1"></a>                ordered_names <span class="ot">&lt;-</span> <span class="fu">c</span>(ordered_names, <span class="fu">paste</span>(coefficient_levels, ref, <span class="at">sep=</span><span class="st">"-"</span>))</span>
<span id="cb99-199"><a href="#cb99-199" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb99-200"><a href="#cb99-200" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(ordered_names)</span>
<span id="cb99-201"><a href="#cb99-201" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb99-202"><a href="#cb99-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-203"><a href="#cb99-203" aria-hidden="true" tabindex="-1"></a>        level_names <span class="ot">&lt;-</span> <span class="fu">as.character</span>(res1<span class="sc">$</span>name)</span>
<span id="cb99-204"><a href="#cb99-204" aria-hidden="true" tabindex="-1"></a>        new_contrast_names <span class="ot">&lt;-</span> <span class="fu">get_ordered_contrast_names</span>(level_names)</span>
<span id="cb99-205"><a href="#cb99-205" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb99-206"><a href="#cb99-206" aria-hidden="true" tabindex="-1"></a>        tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb99-207"><a href="#cb99-207" aria-hidden="true" tabindex="-1"></a>            <span class="at">Levels =</span> <span class="fu">c</span>(level_names, new_contrast_names),</span>
<span id="cb99-208"><a href="#cb99-208" aria-hidden="true" tabindex="-1"></a>            <span class="at">Estimate =</span> <span class="fu">c</span>(res1<span class="sc">$</span>estimate, res2<span class="sc">$</span>estimate),</span>
<span id="cb99-209"><a href="#cb99-209" aria-hidden="true" tabindex="-1"></a>            <span class="at">Lower_CI =</span> <span class="fu">c</span>(res1<span class="sc">$</span>lowerCL, res2<span class="sc">$</span>lowerCL),</span>
<span id="cb99-210"><a href="#cb99-210" aria-hidden="true" tabindex="-1"></a>            <span class="at">Upper_CI =</span> <span class="fu">c</span>(res1<span class="sc">$</span>upperCL, res2<span class="sc">$</span>upperCL),</span>
<span id="cb99-211"><a href="#cb99-211" aria-hidden="true" tabindex="-1"></a>            <span class="at">P_value =</span> <span class="fu">c</span>(res1<span class="sc">$</span>pval, res2<span class="sc">$</span>pval),</span>
<span id="cb99-212"><a href="#cb99-212" aria-hidden="true" tabindex="-1"></a>            <span class="at">Lower_PI =</span> <span class="fu">c</span>(res1<span class="sc">$</span>lowerPR, res2<span class="sc">$</span>lowerPR),</span>
<span id="cb99-213"><a href="#cb99-213" aria-hidden="true" tabindex="-1"></a>            <span class="at">Upper_PI =</span> <span class="fu">c</span>(res1<span class="sc">$</span>upperPR, res2<span class="sc">$</span>upperPR)</span>
<span id="cb99-214"><a href="#cb99-214" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb99-215"><a href="#cb99-215" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb99-216"><a href="#cb99-216" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-217"><a href="#cb99-217" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- MAIN EXECUTION FLOW ---</span></span>
<span id="cb99-218"><a href="#cb99-218" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-219"><a href="#cb99-219" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. Calculate Group Means (Base Model)</span></span>
<span id="cb99-220"><a href="#cb99-220" aria-hidden="true" tabindex="-1"></a>    res1 <span class="ot">&lt;-</span> <span class="fu">get_pred1</span>(model, <span class="at">mod =</span> mod)</span>
<span id="cb99-221"><a href="#cb99-221" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-222"><a href="#cb99-222" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. Calculate Contrasts (Re-leveled Models)</span></span>
<span id="cb99-223"><a href="#cb99-223" aria-hidden="true" tabindex="-1"></a>    estimates <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(contra, <span class="sc">~</span> <span class="fu">get_pred2</span>(.x))</span>
<span id="cb99-224"><a href="#cb99-224" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-225"><a href="#cb99-225" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3. Drop intercepts from contrast models (we only want the differences)</span></span>
<span id="cb99-226"><a href="#cb99-226" aria-hidden="true" tabindex="-1"></a>    res2 <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_dfr</span>(estimates, <span class="sc">~</span>.x[<span class="sc">-</span><span class="dv">1</span>, ]) </span>
<span id="cb99-227"><a href="#cb99-227" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-228"><a href="#cb99-228" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 4. Final Polish</span></span>
<span id="cb99-229"><a href="#cb99-229" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">mr_results</span>(res1, res2)</span>
<span id="cb99-230"><a href="#cb99-230" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-231"><a href="#cb99-231" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(results)</span>
<span id="cb99-232"><a href="#cb99-232" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb99-233"><a href="#cb99-233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-234"><a href="#cb99-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-235"><a href="#cb99-235" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3. The cleaner</span></span>
<span id="cb99-236"><a href="#cb99-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-239"><a href="#cb99-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-240"><a href="#cb99-240" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: clean_unique_contrasts_function</span></span>
<span id="cb99-241"><a href="#cb99-241" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold: TRUE</span></span>
<span id="cb99-242"><a href="#cb99-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-243"><a href="#cb99-243" aria-hidden="true" tabindex="-1"></a>clean_unique_contrasts <span class="ot">&lt;-</span> <span class="cf">function</span>(full_results_table, <span class="at">level_count =</span> <span class="dv">6</span>) {</span>
<span id="cb99-244"><a href="#cb99-244" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-245"><a href="#cb99-245" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- 1. Split Data ---</span></span>
<span id="cb99-246"><a href="#cb99-246" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Keep the single group means safe at the top</span></span>
<span id="cb99-247"><a href="#cb99-247" aria-hidden="true" tabindex="-1"></a>  level_estimates <span class="ot">&lt;-</span> full_results_table[<span class="dv">1</span><span class="sc">:</span>level_count, ]</span>
<span id="cb99-248"><a href="#cb99-248" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Isolate the pairwise comparisons</span></span>
<span id="cb99-249"><a href="#cb99-249" aria-hidden="true" tabindex="-1"></a>  contrast_estimates <span class="ot">&lt;-</span> full_results_table[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>level_count), ]</span>
<span id="cb99-250"><a href="#cb99-250" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-251"><a href="#cb99-251" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- 2. Clean Names ---</span></span>
<span id="cb99-252"><a href="#cb99-252" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Parse "GroupA-GroupB" into separate columns</span></span>
<span id="cb99-253"><a href="#cb99-253" aria-hidden="true" tabindex="-1"></a>  contrast_estimates <span class="ot">&lt;-</span> contrast_estimates <span class="sc">%&gt;%</span></span>
<span id="cb99-254"><a href="#cb99-254" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb99-255"><a href="#cb99-255" aria-hidden="true" tabindex="-1"></a>      <span class="at">Level1 =</span> <span class="fu">str_extract</span>(Levels, <span class="st">"^(.*?)-"</span>),</span>
<span id="cb99-256"><a href="#cb99-256" aria-hidden="true" tabindex="-1"></a>      <span class="at">Level2 =</span> <span class="fu">str_extract</span>(Levels, <span class="st">"-(.*?)$"</span>)</span>
<span id="cb99-257"><a href="#cb99-257" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb99-258"><a href="#cb99-258" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb99-259"><a href="#cb99-259" aria-hidden="true" tabindex="-1"></a>      <span class="at">Level1 =</span> <span class="fu">str_replace_all</span>(Level1, <span class="st">"-"</span>, <span class="st">""</span>),</span>
<span id="cb99-260"><a href="#cb99-260" aria-hidden="true" tabindex="-1"></a>      <span class="at">Level2 =</span> <span class="fu">str_replace_all</span>(Level2, <span class="st">"-"</span>, <span class="st">""</span>)</span>
<span id="cb99-261"><a href="#cb99-261" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb99-262"><a href="#cb99-262" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-263"><a href="#cb99-263" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- 3. Deduplicate ---</span></span>
<span id="cb99-264"><a href="#cb99-264" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a sorted key so "A_B" and "B_A" are treated as identical</span></span>
<span id="cb99-265"><a href="#cb99-265" aria-hidden="true" tabindex="-1"></a>  unique_contrasts <span class="ot">&lt;-</span> contrast_estimates <span class="sc">%&gt;%</span></span>
<span id="cb99-266"><a href="#cb99-266" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb99-267"><a href="#cb99-267" aria-hidden="true" tabindex="-1"></a>      <span class="at">Unique_Pair_Key =</span> <span class="fu">paste</span>(<span class="fu">pmin</span>(Level1, Level2), <span class="fu">pmax</span>(Level1, Level2), <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb99-268"><a href="#cb99-268" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb99-269"><a href="#cb99-269" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep only the first instance of each unique pair</span></span>
<span id="cb99-270"><a href="#cb99-270" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(Unique_Pair_Key, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-271"><a href="#cb99-271" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>Level1, <span class="sc">-</span>Level2, <span class="sc">-</span>Unique_Pair_Key)</span>
<span id="cb99-272"><a href="#cb99-272" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-273"><a href="#cb99-273" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- 4. Recombine ---</span></span>
<span id="cb99-274"><a href="#cb99-274" aria-hidden="true" tabindex="-1"></a>  final_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(level_estimates, unique_contrasts)</span>
<span id="cb99-275"><a href="#cb99-275" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-276"><a href="#cb99-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(final_table)</span>
<span id="cb99-277"><a href="#cb99-277" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb99-278"><a href="#cb99-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-279"><a href="#cb99-279" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb99-280"><a href="#cb99-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-281"><a href="#cb99-281" aria-hidden="true" tabindex="-1"></a><span class="fu">## Meta-regressions</span></span>
<span id="cb99-282"><a href="#cb99-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-283"><a href="#cb99-283" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="true"}</span>
<span id="cb99-284"><a href="#cb99-284" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Filtering &amp; Matrix Alignment</span></span>
<span id="cb99-285"><a href="#cb99-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-286"><a href="#cb99-286" aria-hidden="true" tabindex="-1"></a>This snippet performs quality control before running your meta-analysis. It serves two critical functions:</span>
<span id="cb99-287"><a href="#cb99-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-288"><a href="#cb99-288" aria-hidden="true" tabindex="-1"></a>Ensures Reliability: It removes specific levels of your moderator (groups) that have too little data to be trusted (in this case, fewer than 5 effect sizes).</span>
<span id="cb99-289"><a href="#cb99-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-290"><a href="#cb99-290" aria-hidden="true" tabindex="-1"></a>Prevents Errors: Crucially, it subsets the Variance-Covariance (VCV) matrix to match your filtered data. Since the VCV matrix is a square grid where every row/column corresponds to a row in your data, filtering the data without "cropping" the matrix correspondingly will cause your model to crash due to a dimension mismatch.</span>
<span id="cb99-291"><a href="#cb99-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-294"><a href="#cb99-294" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-295"><a href="#cb99-295" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: filter_low_k</span></span>
<span id="cb99-296"><a href="#cb99-296" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: FALSE</span></span>
<span id="cb99-297"><a href="#cb99-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-298"><a href="#cb99-298" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Identify and Filter Low-K Levels</span></span>
<span id="cb99-299"><a href="#cb99-299" aria-hidden="true" tabindex="-1"></a><span class="co"># (Replace 'Outcome_type' with the specific moderator column name)</span></span>
<span id="cb99-300"><a href="#cb99-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-301"><a href="#cb99-301" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the count of ES_ID (k) for each level of the moderator</span></span>
<span id="cb99-302"><a href="#cb99-302" aria-hidden="true" tabindex="-1"></a>k_counts <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb99-303"><a href="#cb99-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Outcome_type) <span class="sc">%&gt;%</span></span>
<span id="cb99-304"><a href="#cb99-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">k_es =</span> <span class="fu">n</span>())</span>
<span id="cb99-305"><a href="#cb99-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-306"><a href="#cb99-306" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the levels to keep (where k_es &gt;= 5)</span></span>
<span id="cb99-307"><a href="#cb99-307" aria-hidden="true" tabindex="-1"></a>levels_to_keep <span class="ot">&lt;-</span> k_counts <span class="sc">%&gt;%</span></span>
<span id="cb99-308"><a href="#cb99-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(k_es <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-309"><a href="#cb99-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Outcome_type)</span>
<span id="cb99-310"><a href="#cb99-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-311"><a href="#cb99-311" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Create the Filtered Data Frame</span></span>
<span id="cb99-312"><a href="#cb99-312" aria-hidden="true" tabindex="-1"></a>db_filtered <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb99-313"><a href="#cb99-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Outcome_type <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb99-314"><a href="#cb99-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-315"><a href="#cb99-315" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Subset the VCV Matrix (CRITICAL STEP)</span></span>
<span id="cb99-316"><a href="#cb99-316" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumes VCV matrix rows/columns match the original 'db' data frame indices.</span></span>
<span id="cb99-317"><a href="#cb99-317" aria-hidden="true" tabindex="-1"></a>indices_to_keep <span class="ot">&lt;-</span> <span class="fu">which</span>(db<span class="sc">$</span>Outcome_type <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb99-318"><a href="#cb99-318" aria-hidden="true" tabindex="-1"></a>VCV_filtered <span class="ot">&lt;-</span> VCV[indices_to_keep, indices_to_keep]</span>
<span id="cb99-319"><a href="#cb99-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-320"><a href="#cb99-320" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb99-321"><a href="#cb99-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-322"><a href="#cb99-322" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb99-323"><a href="#cb99-323" aria-hidden="true" tabindex="-1"></a>Manual Reference Rotation for SubsetsThe automated contrast functions are designed for full datasets. When you filter for data availability (e.g., keeping only levels with $k \ge 5$) and are left with more than 2 levels, it is often safer to manually "rotate" the reference level. How it works:In meta-regression with an intercept, the Intercept represents the mean of the Reference Level. The other coefficients represent the difference between the reference and the other groups.By manually changing the reference (ref = ...) and re-running the model for each level, you mathematically force the model to calculate every possible pairwise comparison (e.g., A vs B, B vs C, A vs C) and their specific p-values.</span>
<span id="cb99-324"><a href="#cb99-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-325"><a href="#cb99-325" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>2 Levels remaining? You only need one model (Intercept = Group A, Coefficient = Difference).</span>
<span id="cb99-326"><a href="#cb99-326" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>3+ Levels remaining? Use the rotation method below.</span>
<span id="cb99-327"><a href="#cb99-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-330"><a href="#cb99-330" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-331"><a href="#cb99-331" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: manual_contrasts</span></span>
<span id="cb99-332"><a href="#cb99-332" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: FALSE</span></span>
<span id="cb99-333"><a href="#cb99-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-334"><a href="#cb99-334" aria-hidden="true" tabindex="-1"></a><span class="co"># 0. Define your levels of interest</span></span>
<span id="cb99-335"><a href="#cb99-335" aria-hidden="true" tabindex="-1"></a>LEVELS <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Acute"</span>, <span class="st">"Medium"</span>, <span class="st">"Short"</span>)</span>
<span id="cb99-336"><a href="#cb99-336" aria-hidden="true" tabindex="-1"></a><span class="co"># (Optional) Store moderator name for clarity</span></span>
<span id="cb99-337"><a href="#cb99-337" aria-hidden="true" tabindex="-1"></a>MOD_NAME <span class="ot">&lt;-</span> <span class="st">"Music_exposure_duration"</span></span>
<span id="cb99-338"><a href="#cb99-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-339"><a href="#cb99-339" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model A: Reference = Acute ---</span></span>
<span id="cb99-340"><a href="#cb99-340" aria-hidden="true" tabindex="-1"></a><span class="co"># Intercept = Acute Mean</span></span>
<span id="cb99-341"><a href="#cb99-341" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients = (Medium - Acute) and (Short - Acute)</span></span>
<span id="cb99-342"><a href="#cb99-342" aria-hidden="true" tabindex="-1"></a>db_filtered<span class="sc">$</span>moderator_relevel_A <span class="ot">&lt;-</span> <span class="fu">relevel</span>(db_filtered<span class="sc">$</span>Music_exposure_duration, <span class="at">ref =</span> LEVELS[<span class="dv">1</span>])</span>
<span id="cb99-343"><a href="#cb99-343" aria-hidden="true" tabindex="-1"></a>model_A <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-344"><a href="#cb99-344" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb99-345"><a href="#cb99-345" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mods =</span> <span class="sc">~</span> moderator_relevel_A,</span>
<span id="cb99-346"><a href="#cb99-346" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-347"><a href="#cb99-347" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>, <span class="at">method =</span> <span class="st">"REML"</span>, <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-348"><a href="#cb99-348" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb99-349"><a href="#cb99-349" aria-hidden="true" tabindex="-1"></a>model_A</span>
<span id="cb99-350"><a href="#cb99-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-351"><a href="#cb99-351" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model B: Reference = Medium ---</span></span>
<span id="cb99-352"><a href="#cb99-352" aria-hidden="true" tabindex="-1"></a><span class="co"># Intercept = Medium Mean</span></span>
<span id="cb99-353"><a href="#cb99-353" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients = (Acute - Medium) and (Short - Medium)</span></span>
<span id="cb99-354"><a href="#cb99-354" aria-hidden="true" tabindex="-1"></a><span class="co"># *Key Gain: This gives us the specific P-value for Short vs Medium*</span></span>
<span id="cb99-355"><a href="#cb99-355" aria-hidden="true" tabindex="-1"></a>db_filtered<span class="sc">$</span>moderator_relevel_B <span class="ot">&lt;-</span> <span class="fu">relevel</span>(db_filtered<span class="sc">$</span>Music_exposure_duration, <span class="at">ref =</span> LEVELS[<span class="dv">2</span>])</span>
<span id="cb99-356"><a href="#cb99-356" aria-hidden="true" tabindex="-1"></a>model_B <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-357"><a href="#cb99-357" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb99-358"><a href="#cb99-358" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mods =</span> <span class="sc">~</span> moderator_relevel_B,</span>
<span id="cb99-359"><a href="#cb99-359" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-360"><a href="#cb99-360" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>, <span class="at">method =</span> <span class="st">"REML"</span>, <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-361"><a href="#cb99-361" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb99-362"><a href="#cb99-362" aria-hidden="true" tabindex="-1"></a>model_B</span>
<span id="cb99-363"><a href="#cb99-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-364"><a href="#cb99-364" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Model C: Reference = Short ---</span></span>
<span id="cb99-365"><a href="#cb99-365" aria-hidden="true" tabindex="-1"></a><span class="co"># Intercept = Short Mean</span></span>
<span id="cb99-366"><a href="#cb99-366" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients = (Acute - Short) and (Medium - Short)</span></span>
<span id="cb99-367"><a href="#cb99-367" aria-hidden="true" tabindex="-1"></a><span class="co"># *Useful for: Getting the direct estimate/CI for the "Short" group mean*</span></span>
<span id="cb99-368"><a href="#cb99-368" aria-hidden="true" tabindex="-1"></a>db_filtered<span class="sc">$</span>moderator_relevel_C <span class="ot">&lt;-</span> <span class="fu">relevel</span>(db_filtered<span class="sc">$</span>Music_exposure_duration, <span class="at">ref =</span> LEVELS[<span class="dv">3</span>])</span>
<span id="cb99-369"><a href="#cb99-369" aria-hidden="true" tabindex="-1"></a>model_C <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-370"><a href="#cb99-370" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb99-371"><a href="#cb99-371" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mods =</span> <span class="sc">~</span> moderator_relevel_C,</span>
<span id="cb99-372"><a href="#cb99-372" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-373"><a href="#cb99-373" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>, <span class="at">method =</span> <span class="st">"REML"</span>, <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-374"><a href="#cb99-374" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb99-375"><a href="#cb99-375" aria-hidden="true" tabindex="-1"></a>model_C</span>
<span id="cb99-376"><a href="#cb99-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-377"><a href="#cb99-377" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb99-378"><a href="#cb99-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-379"><a href="#cb99-379" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb99-380"><a href="#cb99-380" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1. Outcome type: Anxiety and Depression</span></span>
<span id="cb99-381"><a href="#cb99-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-384"><a href="#cb99-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-385"><a href="#cb99-385" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: filter_outcome_type</span></span>
<span id="cb99-386"><a href="#cb99-386" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold: TRUE</span></span>
<span id="cb99-387"><a href="#cb99-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-388"><a href="#cb99-388" aria-hidden="true" tabindex="-1"></a>k_counts <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb99-389"><a href="#cb99-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Outcome_type) <span class="sc">%&gt;%</span></span>
<span id="cb99-390"><a href="#cb99-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">k_es =</span> <span class="fu">n</span>())</span>
<span id="cb99-391"><a href="#cb99-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-392"><a href="#cb99-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-393"><a href="#cb99-393" aria-hidden="true" tabindex="-1"></a>levels_to_keep <span class="ot">&lt;-</span> k_counts <span class="sc">%&gt;%</span></span>
<span id="cb99-394"><a href="#cb99-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(k_es <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-395"><a href="#cb99-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Outcome_type)</span>
<span id="cb99-396"><a href="#cb99-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-397"><a href="#cb99-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-398"><a href="#cb99-398" aria-hidden="true" tabindex="-1"></a>db_filtered <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb99-399"><a href="#cb99-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Outcome_type <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb99-400"><a href="#cb99-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-401"><a href="#cb99-401" aria-hidden="true" tabindex="-1"></a>indices_to_keep <span class="ot">&lt;-</span> <span class="fu">which</span>(db<span class="sc">$</span>Outcome_type <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb99-402"><a href="#cb99-402" aria-hidden="true" tabindex="-1"></a>VCV_filtered <span class="ot">&lt;-</span> VCV[indices_to_keep, indices_to_keep]</span>
<span id="cb99-403"><a href="#cb99-403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-404"><a href="#cb99-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-407"><a href="#cb99-407" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-408"><a href="#cb99-408" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_outcome_type</span></span>
<span id="cb99-409"><a href="#cb99-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-410"><a href="#cb99-410" aria-hidden="true" tabindex="-1"></a>mOT <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-411"><a href="#cb99-411" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb99-412"><a href="#cb99-412" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Outcome_type<span class="dv">-1</span>,</span>
<span id="cb99-413"><a href="#cb99-413" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb99-414"><a href="#cb99-414" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID,</span>
<span id="cb99-415"><a href="#cb99-415" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-416"><a href="#cb99-416" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-417"><a href="#cb99-417" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb99-418"><a href="#cb99-418" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-419"><a href="#cb99-419" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb99-420"><a href="#cb99-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-421"><a href="#cb99-421" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mOT)</span>
<span id="cb99-422"><a href="#cb99-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-423"><a href="#cb99-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-424"><a href="#cb99-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-427"><a href="#cb99-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-428"><a href="#cb99-428" aria-hidden="true" tabindex="-1"></a>r2OT <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mOT), <span class="dv">4</span>)</span>
<span id="cb99-429"><a href="#cb99-429" aria-hidden="true" tabindex="-1"></a>r2OT</span>
<span id="cb99-430"><a href="#cb99-430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-431"><a href="#cb99-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-434"><a href="#cb99-434" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-435"><a href="#cb99-435" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: orchard_outcome_type</span></span>
<span id="cb99-436"><a href="#cb99-436" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb99-437"><a href="#cb99-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb99-438"><a href="#cb99-438" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb99-439"><a href="#cb99-439" aria-hidden="true" tabindex="-1"></a>orchard_outcome<span class="ot">&lt;-</span><span class="fu">orchard_plot</span>(mOT,</span>
<span id="cb99-440"><a href="#cb99-440" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Outcome_type"</span>,</span>
<span id="cb99-441"><a href="#cb99-441" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb99-442"><a href="#cb99-442" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span> <span class="st">"lnRR"</span>, </span>
<span id="cb99-443"><a href="#cb99-443" aria-hidden="true" tabindex="-1"></a>             <span class="at">flip =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb99-444"><a href="#cb99-444" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb99-445"><a href="#cb99-445" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>)<span class="sc">+</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb99-446"><a href="#cb99-446" aria-hidden="true" tabindex="-1"></a>                                                                    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span> ))</span>
<span id="cb99-447"><a href="#cb99-447" aria-hidden="true" tabindex="-1"></a>orchard_outcome</span>
<span id="cb99-448"><a href="#cb99-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-449"><a href="#cb99-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-452"><a href="#cb99-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-453"><a href="#cb99-453" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: save-figure</span></span>
<span id="cb99-454"><a href="#cb99-454" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb99-455"><a href="#cb99-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-456"><a href="#cb99-456" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_outcome_lnRR.pdf"</span>),</span>
<span id="cb99-457"><a href="#cb99-457" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_outcome,</span>
<span id="cb99-458"><a href="#cb99-458" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb99-459"><a href="#cb99-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-460"><a href="#cb99-460" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_outcome_lnRR.jpg"</span>),</span>
<span id="cb99-461"><a href="#cb99-461" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_outcome,</span>
<span id="cb99-462"><a href="#cb99-462" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">7</span>,  </span>
<span id="cb99-463"><a href="#cb99-463" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">9</span>,  </span>
<span id="cb99-464"><a href="#cb99-464" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb99-465"><a href="#cb99-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-466"><a href="#cb99-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-467"><a href="#cb99-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-468"><a href="#cb99-468" aria-hidden="true" tabindex="-1"></a>Contrast between levels (Anxiety as reference level)</span>
<span id="cb99-469"><a href="#cb99-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-472"><a href="#cb99-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-473"><a href="#cb99-473" aria-hidden="true" tabindex="-1"></a>mOT <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-474"><a href="#cb99-474" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb99-475"><a href="#cb99-475" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Outcome_type,</span>
<span id="cb99-476"><a href="#cb99-476" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb99-477"><a href="#cb99-477" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID,</span>
<span id="cb99-478"><a href="#cb99-478" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-479"><a href="#cb99-479" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-480"><a href="#cb99-480" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb99-481"><a href="#cb99-481" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-482"><a href="#cb99-482" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb99-483"><a href="#cb99-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-484"><a href="#cb99-484" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mOT)</span>
<span id="cb99-485"><a href="#cb99-485" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-486"><a href="#cb99-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-487"><a href="#cb99-487" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2. Lifestage of exposure</span></span>
<span id="cb99-488"><a href="#cb99-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-491"><a href="#cb99-491" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-492"><a href="#cb99-492" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_lifestage_exp</span></span>
<span id="cb99-493"><a href="#cb99-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-494"><a href="#cb99-494" aria-hidden="true" tabindex="-1"></a>mLE <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-495"><a href="#cb99-495" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb99-496"><a href="#cb99-496" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Lifestage_exposure<span class="dv">-1</span>,</span>
<span id="cb99-497"><a href="#cb99-497" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb99-498"><a href="#cb99-498" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID,</span>
<span id="cb99-499"><a href="#cb99-499" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-500"><a href="#cb99-500" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-501"><a href="#cb99-501" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb99-502"><a href="#cb99-502" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-503"><a href="#cb99-503" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb99-504"><a href="#cb99-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-505"><a href="#cb99-505" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mLE)</span>
<span id="cb99-506"><a href="#cb99-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-507"><a href="#cb99-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-508"><a href="#cb99-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-511"><a href="#cb99-511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-512"><a href="#cb99-512" aria-hidden="true" tabindex="-1"></a>r2LE <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mLE), <span class="dv">4</span>)</span>
<span id="cb99-513"><a href="#cb99-513" aria-hidden="true" tabindex="-1"></a>r2LE</span>
<span id="cb99-514"><a href="#cb99-514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-515"><a href="#cb99-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-518"><a href="#cb99-518" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-519"><a href="#cb99-519" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: orchard_lifestage_exp</span></span>
<span id="cb99-520"><a href="#cb99-520" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb99-521"><a href="#cb99-521" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb99-522"><a href="#cb99-522" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb99-523"><a href="#cb99-523" aria-hidden="true" tabindex="-1"></a>orchard_lifestage<span class="ot">&lt;-</span><span class="fu">orchard_plot</span>(mLE,</span>
<span id="cb99-524"><a href="#cb99-524" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Lifestage_exposure"</span>,</span>
<span id="cb99-525"><a href="#cb99-525" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb99-526"><a href="#cb99-526" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab =</span> <span class="st">"lnRR"</span>, </span>
<span id="cb99-527"><a href="#cb99-527" aria-hidden="true" tabindex="-1"></a>             <span class="at">flip =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb99-528"><a href="#cb99-528" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb99-529"><a href="#cb99-529" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>)<span class="sc">+</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb99-530"><a href="#cb99-530" aria-hidden="true" tabindex="-1"></a>                                                                    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span> ))</span>
<span id="cb99-531"><a href="#cb99-531" aria-hidden="true" tabindex="-1"></a>orchard_lifestage</span>
<span id="cb99-532"><a href="#cb99-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-533"><a href="#cb99-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-536"><a href="#cb99-536" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-537"><a href="#cb99-537" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: save-figure_lifestage</span></span>
<span id="cb99-538"><a href="#cb99-538" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb99-539"><a href="#cb99-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-540"><a href="#cb99-540" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_lifestage_lnRR.pdf"</span>),</span>
<span id="cb99-541"><a href="#cb99-541" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_lifestage,</span>
<span id="cb99-542"><a href="#cb99-542" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb99-543"><a href="#cb99-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-544"><a href="#cb99-544" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_lifestage_lnRR.jpg"</span>),</span>
<span id="cb99-545"><a href="#cb99-545" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_lifestage,</span>
<span id="cb99-546"><a href="#cb99-546" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">9</span>,  </span>
<span id="cb99-547"><a href="#cb99-547" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">7</span>,  </span>
<span id="cb99-548"><a href="#cb99-548" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb99-549"><a href="#cb99-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-550"><a href="#cb99-550" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-551"><a href="#cb99-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-552"><a href="#cb99-552" aria-hidden="true" tabindex="-1"></a>Contrasts between levels (Adolescent as reference level)</span>
<span id="cb99-553"><a href="#cb99-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-556"><a href="#cb99-556" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-557"><a href="#cb99-557" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lifestage_contrasts</span></span>
<span id="cb99-558"><a href="#cb99-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-559"><a href="#cb99-559" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we apply our custum functions</span></span>
<span id="cb99-560"><a href="#cb99-560" aria-hidden="true" tabindex="-1"></a><span class="co"># The Generator</span></span>
<span id="cb99-561"><a href="#cb99-561" aria-hidden="true" tabindex="-1"></a>contra_LE <span class="ot">&lt;-</span> <span class="fu">contrast_fun</span>(<span class="at">data =</span> db, </span>
<span id="cb99-562"><a href="#cb99-562" aria-hidden="true" tabindex="-1"></a>                          <span class="at">response =</span> lnRR, </span>
<span id="cb99-563"><a href="#cb99-563" aria-hidden="true" tabindex="-1"></a>                          <span class="at">moderator =</span> Lifestage_exposure, </span>
<span id="cb99-564"><a href="#cb99-564" aria-hidden="true" tabindex="-1"></a>                          <span class="at">VCV =</span> VCV)</span>
<span id="cb99-565"><a href="#cb99-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-566"><a href="#cb99-566" aria-hidden="true" tabindex="-1"></a><span class="co">#The Harvester</span></span>
<span id="cb99-567"><a href="#cb99-567" aria-hidden="true" tabindex="-1"></a>t1<span class="ot">&lt;-</span><span class="fu">get_estimate</span>(<span class="at">model =</span> mLE, <span class="at">contra =</span> contra_LE, <span class="at">moderator =</span> Lifestage_exposure)</span>
<span id="cb99-568"><a href="#cb99-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-569"><a href="#cb99-569" aria-hidden="true" tabindex="-1"></a><span class="co">#The Cleaner</span></span>
<span id="cb99-570"><a href="#cb99-570" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">clean_unique_contrasts</span>(<span class="at">full_results_table =</span> t1, <span class="at">level_count =</span> <span class="dv">6</span>)</span>
<span id="cb99-571"><a href="#cb99-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-572"><a href="#cb99-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-573"><a href="#cb99-573" aria-hidden="true" tabindex="-1"></a>t2</span>
<span id="cb99-574"><a href="#cb99-574" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-575"><a href="#cb99-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-576"><a href="#cb99-576" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3. Sex</span></span>
<span id="cb99-577"><a href="#cb99-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-580"><a href="#cb99-580" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-581"><a href="#cb99-581" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: filter_sex</span></span>
<span id="cb99-582"><a href="#cb99-582" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold: TRUE</span></span>
<span id="cb99-583"><a href="#cb99-583" aria-hidden="true" tabindex="-1"></a>k_counts <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb99-584"><a href="#cb99-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sex) <span class="sc">%&gt;%</span></span>
<span id="cb99-585"><a href="#cb99-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">k_es =</span> <span class="fu">n</span>())</span>
<span id="cb99-586"><a href="#cb99-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-587"><a href="#cb99-587" aria-hidden="true" tabindex="-1"></a>levels_to_keep <span class="ot">&lt;-</span> k_counts <span class="sc">%&gt;%</span></span>
<span id="cb99-588"><a href="#cb99-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(k_es <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-589"><a href="#cb99-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Sex)</span>
<span id="cb99-590"><a href="#cb99-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-591"><a href="#cb99-591" aria-hidden="true" tabindex="-1"></a>db_filtered <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb99-592"><a href="#cb99-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sex <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb99-593"><a href="#cb99-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-594"><a href="#cb99-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-595"><a href="#cb99-595" aria-hidden="true" tabindex="-1"></a>indices_to_keep <span class="ot">&lt;-</span> <span class="fu">which</span>(db<span class="sc">$</span>Sex <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb99-596"><a href="#cb99-596" aria-hidden="true" tabindex="-1"></a>VCV_filtered <span class="ot">&lt;-</span> VCV[indices_to_keep, indices_to_keep]</span>
<span id="cb99-597"><a href="#cb99-597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-598"><a href="#cb99-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-601"><a href="#cb99-601" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-602"><a href="#cb99-602" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_sex</span></span>
<span id="cb99-603"><a href="#cb99-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-604"><a href="#cb99-604" aria-hidden="true" tabindex="-1"></a>mSX <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-605"><a href="#cb99-605" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb99-606"><a href="#cb99-606" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Sex<span class="dv">-1</span>,</span>
<span id="cb99-607"><a href="#cb99-607" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb99-608"><a href="#cb99-608" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID,</span>
<span id="cb99-609"><a href="#cb99-609" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-610"><a href="#cb99-610" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-611"><a href="#cb99-611" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb99-612"><a href="#cb99-612" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-613"><a href="#cb99-613" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb99-614"><a href="#cb99-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-615"><a href="#cb99-615" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mSX)</span>
<span id="cb99-616"><a href="#cb99-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-617"><a href="#cb99-617" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-618"><a href="#cb99-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-621"><a href="#cb99-621" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-622"><a href="#cb99-622" aria-hidden="true" tabindex="-1"></a>r2SX <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mSX), <span class="dv">4</span>)</span>
<span id="cb99-623"><a href="#cb99-623" aria-hidden="true" tabindex="-1"></a>r2SX</span>
<span id="cb99-624"><a href="#cb99-624" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-625"><a href="#cb99-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-628"><a href="#cb99-628" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-629"><a href="#cb99-629" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: orchard_sex</span></span>
<span id="cb99-630"><a href="#cb99-630" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb99-631"><a href="#cb99-631" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb99-632"><a href="#cb99-632" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb99-633"><a href="#cb99-633" aria-hidden="true" tabindex="-1"></a>orchard_sex<span class="ot">&lt;-</span><span class="fu">orchard_plot</span>(mSX,</span>
<span id="cb99-634"><a href="#cb99-634" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Sex"</span>,</span>
<span id="cb99-635"><a href="#cb99-635" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb99-636"><a href="#cb99-636" aria-hidden="true" tabindex="-1"></a>             <span class="at">xlab =</span> <span class="st">"lnRR"</span>, </span>
<span id="cb99-637"><a href="#cb99-637" aria-hidden="true" tabindex="-1"></a>             <span class="at">flip =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb99-638"><a href="#cb99-638" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb99-639"><a href="#cb99-639" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)<span class="sc">+</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb99-640"><a href="#cb99-640" aria-hidden="true" tabindex="-1"></a>                                                                    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span> ))</span>
<span id="cb99-641"><a href="#cb99-641" aria-hidden="true" tabindex="-1"></a>orchard_sex</span>
<span id="cb99-642"><a href="#cb99-642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-643"><a href="#cb99-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-646"><a href="#cb99-646" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-647"><a href="#cb99-647" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: save-figure_sex</span></span>
<span id="cb99-648"><a href="#cb99-648" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb99-649"><a href="#cb99-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-650"><a href="#cb99-650" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_sex_lnRR.pdf"</span>),</span>
<span id="cb99-651"><a href="#cb99-651" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_sex,</span>
<span id="cb99-652"><a href="#cb99-652" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb99-653"><a href="#cb99-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-654"><a href="#cb99-654" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_sex_lnRR.jpg"</span>),</span>
<span id="cb99-655"><a href="#cb99-655" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_sex,</span>
<span id="cb99-656"><a href="#cb99-656" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">7</span>,  </span>
<span id="cb99-657"><a href="#cb99-657" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">9</span>,  </span>
<span id="cb99-658"><a href="#cb99-658" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb99-659"><a href="#cb99-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-660"><a href="#cb99-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-661"><a href="#cb99-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-662"><a href="#cb99-662" aria-hidden="true" tabindex="-1"></a>Contrast between levels (Female as reference level)</span>
<span id="cb99-663"><a href="#cb99-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-666"><a href="#cb99-666" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-667"><a href="#cb99-667" aria-hidden="true" tabindex="-1"></a>mSX <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-668"><a href="#cb99-668" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb99-669"><a href="#cb99-669" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Sex,</span>
<span id="cb99-670"><a href="#cb99-670" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb99-671"><a href="#cb99-671" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID,</span>
<span id="cb99-672"><a href="#cb99-672" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-673"><a href="#cb99-673" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-674"><a href="#cb99-674" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb99-675"><a href="#cb99-675" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-676"><a href="#cb99-676" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb99-677"><a href="#cb99-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-678"><a href="#cb99-678" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mSX)</span>
<span id="cb99-679"><a href="#cb99-679" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-680"><a href="#cb99-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-681"><a href="#cb99-681" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4. Music genre</span></span>
<span id="cb99-682"><a href="#cb99-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-683"><a href="#cb99-683" aria-hidden="true" tabindex="-1"></a>Meta_genre</span>
<span id="cb99-684"><a href="#cb99-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-687"><a href="#cb99-687" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-688"><a href="#cb99-688" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_music_genre</span></span>
<span id="cb99-689"><a href="#cb99-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-690"><a href="#cb99-690" aria-hidden="true" tabindex="-1"></a>mMG <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-691"><a href="#cb99-691" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb99-692"><a href="#cb99-692" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Meta_genre<span class="dv">-1</span>,</span>
<span id="cb99-693"><a href="#cb99-693" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb99-694"><a href="#cb99-694" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID,</span>
<span id="cb99-695"><a href="#cb99-695" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-696"><a href="#cb99-696" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-697"><a href="#cb99-697" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb99-698"><a href="#cb99-698" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-699"><a href="#cb99-699" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb99-700"><a href="#cb99-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-701"><a href="#cb99-701" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mMG)</span>
<span id="cb99-702"><a href="#cb99-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-703"><a href="#cb99-703" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-704"><a href="#cb99-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-707"><a href="#cb99-707" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-708"><a href="#cb99-708" aria-hidden="true" tabindex="-1"></a>r2MG <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mMG), <span class="dv">4</span>)</span>
<span id="cb99-709"><a href="#cb99-709" aria-hidden="true" tabindex="-1"></a>r2MG</span>
<span id="cb99-710"><a href="#cb99-710" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-711"><a href="#cb99-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-714"><a href="#cb99-714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-715"><a href="#cb99-715" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: orchard_music_genre</span></span>
<span id="cb99-716"><a href="#cb99-716" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb99-717"><a href="#cb99-717" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb99-718"><a href="#cb99-718" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb99-719"><a href="#cb99-719" aria-hidden="true" tabindex="-1"></a>orchard_genre<span class="ot">&lt;-</span><span class="fu">orchard_plot</span>(mMG,</span>
<span id="cb99-720"><a href="#cb99-720" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Meta_genre"</span>,</span>
<span id="cb99-721"><a href="#cb99-721" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb99-722"><a href="#cb99-722" aria-hidden="true" tabindex="-1"></a>             <span class="at">xlab =</span> <span class="st">"lnRR"</span>, </span>
<span id="cb99-723"><a href="#cb99-723" aria-hidden="true" tabindex="-1"></a>             <span class="at">flip =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb99-724"><a href="#cb99-724" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb99-725"><a href="#cb99-725" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)<span class="sc">+</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb99-726"><a href="#cb99-726" aria-hidden="true" tabindex="-1"></a>                                                                    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span> ))</span>
<span id="cb99-727"><a href="#cb99-727" aria-hidden="true" tabindex="-1"></a>orchard_genre</span>
<span id="cb99-728"><a href="#cb99-728" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-729"><a href="#cb99-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-732"><a href="#cb99-732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-733"><a href="#cb99-733" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: save-figure_genre</span></span>
<span id="cb99-734"><a href="#cb99-734" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb99-735"><a href="#cb99-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-736"><a href="#cb99-736" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_genre_lnRR.pdf"</span>),</span>
<span id="cb99-737"><a href="#cb99-737" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_genre,</span>
<span id="cb99-738"><a href="#cb99-738" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb99-739"><a href="#cb99-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-740"><a href="#cb99-740" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_genre_lnRR.jpg"</span>),</span>
<span id="cb99-741"><a href="#cb99-741" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_genre,</span>
<span id="cb99-742"><a href="#cb99-742" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">9</span>,  </span>
<span id="cb99-743"><a href="#cb99-743" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">7</span>,  </span>
<span id="cb99-744"><a href="#cb99-744" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb99-745"><a href="#cb99-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-746"><a href="#cb99-746" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-747"><a href="#cb99-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-748"><a href="#cb99-748" aria-hidden="true" tabindex="-1"></a>Contrasts between levels</span>
<span id="cb99-749"><a href="#cb99-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-752"><a href="#cb99-752" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-753"><a href="#cb99-753" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: music_genre_contrasts1</span></span>
<span id="cb99-754"><a href="#cb99-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-755"><a href="#cb99-755" aria-hidden="true" tabindex="-1"></a><span class="co"># The Generator</span></span>
<span id="cb99-756"><a href="#cb99-756" aria-hidden="true" tabindex="-1"></a>contra_mMG <span class="ot">&lt;-</span> <span class="fu">contrast_fun</span>(<span class="at">data =</span> db, </span>
<span id="cb99-757"><a href="#cb99-757" aria-hidden="true" tabindex="-1"></a>                          <span class="at">response =</span> lnRR, </span>
<span id="cb99-758"><a href="#cb99-758" aria-hidden="true" tabindex="-1"></a>                          <span class="at">moderator =</span> Meta_genre, </span>
<span id="cb99-759"><a href="#cb99-759" aria-hidden="true" tabindex="-1"></a>                          <span class="at">VCV =</span> VCV)</span>
<span id="cb99-760"><a href="#cb99-760" aria-hidden="true" tabindex="-1"></a><span class="co"># The Harvester</span></span>
<span id="cb99-761"><a href="#cb99-761" aria-hidden="true" tabindex="-1"></a>t1<span class="ot">&lt;-</span><span class="fu">get_estimate</span>(<span class="at">model =</span> mMG, <span class="at">contra =</span> contra_mMG, <span class="at">moderator =</span> Meta_genre)</span>
<span id="cb99-762"><a href="#cb99-762" aria-hidden="true" tabindex="-1"></a><span class="co"># The Cleaner</span></span>
<span id="cb99-763"><a href="#cb99-763" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">clean_unique_contrasts</span>(<span class="at">full_results_table =</span> t1, <span class="at">level_count =</span> <span class="dv">4</span>)</span>
<span id="cb99-764"><a href="#cb99-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-765"><a href="#cb99-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-766"><a href="#cb99-766" aria-hidden="true" tabindex="-1"></a>t2</span>
<span id="cb99-767"><a href="#cb99-767" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-768"><a href="#cb99-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-769"><a href="#cb99-769" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5. Music exposure duration</span></span>
<span id="cb99-770"><a href="#cb99-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-771"><a href="#cb99-771" aria-hidden="true" tabindex="-1"></a>Music_exposure_duration</span>
<span id="cb99-772"><a href="#cb99-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-775"><a href="#cb99-775" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-776"><a href="#cb99-776" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: filter_music_exposure</span></span>
<span id="cb99-777"><a href="#cb99-777" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold: TRUE</span></span>
<span id="cb99-778"><a href="#cb99-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-779"><a href="#cb99-779" aria-hidden="true" tabindex="-1"></a>k_counts <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb99-780"><a href="#cb99-780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Music_exposure_duration) <span class="sc">%&gt;%</span></span>
<span id="cb99-781"><a href="#cb99-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">k_es =</span> <span class="fu">n</span>())</span>
<span id="cb99-782"><a href="#cb99-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-783"><a href="#cb99-783" aria-hidden="true" tabindex="-1"></a>levels_to_keep <span class="ot">&lt;-</span> k_counts <span class="sc">%&gt;%</span></span>
<span id="cb99-784"><a href="#cb99-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(k_es <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-785"><a href="#cb99-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Music_exposure_duration)</span>
<span id="cb99-786"><a href="#cb99-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-787"><a href="#cb99-787" aria-hidden="true" tabindex="-1"></a>db_filtered <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb99-788"><a href="#cb99-788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Music_exposure_duration <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb99-789"><a href="#cb99-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-790"><a href="#cb99-790" aria-hidden="true" tabindex="-1"></a>indices_to_keep <span class="ot">&lt;-</span> <span class="fu">which</span>(db<span class="sc">$</span>Music_exposure_duration <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb99-791"><a href="#cb99-791" aria-hidden="true" tabindex="-1"></a>VCV_filtered <span class="ot">&lt;-</span> VCV[indices_to_keep, indices_to_keep]</span>
<span id="cb99-792"><a href="#cb99-792" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-793"><a href="#cb99-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-796"><a href="#cb99-796" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-797"><a href="#cb99-797" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_music_exposure</span></span>
<span id="cb99-798"><a href="#cb99-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-799"><a href="#cb99-799" aria-hidden="true" tabindex="-1"></a>mMED <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-800"><a href="#cb99-800" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb99-801"><a href="#cb99-801" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Music_exposure_duration<span class="dv">-1</span>,</span>
<span id="cb99-802"><a href="#cb99-802" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb99-803"><a href="#cb99-803" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb99-804"><a href="#cb99-804" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-805"><a href="#cb99-805" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-806"><a href="#cb99-806" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb99-807"><a href="#cb99-807" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-808"><a href="#cb99-808" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb99-809"><a href="#cb99-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-810"><a href="#cb99-810" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mMED)</span>
<span id="cb99-811"><a href="#cb99-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-812"><a href="#cb99-812" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-813"><a href="#cb99-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-816"><a href="#cb99-816" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-817"><a href="#cb99-817" aria-hidden="true" tabindex="-1"></a>r2MED <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mMED), <span class="dv">4</span>)</span>
<span id="cb99-818"><a href="#cb99-818" aria-hidden="true" tabindex="-1"></a>r2MED</span>
<span id="cb99-819"><a href="#cb99-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-820"><a href="#cb99-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-823"><a href="#cb99-823" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-824"><a href="#cb99-824" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: orchard_music_exposure</span></span>
<span id="cb99-825"><a href="#cb99-825" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb99-826"><a href="#cb99-826" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb99-827"><a href="#cb99-827" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb99-828"><a href="#cb99-828" aria-hidden="true" tabindex="-1"></a>orchard_exposure<span class="ot">&lt;-</span><span class="fu">orchard_plot</span>(mMED,</span>
<span id="cb99-829"><a href="#cb99-829" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Music_exposure_duration"</span>,</span>
<span id="cb99-830"><a href="#cb99-830" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb99-831"><a href="#cb99-831" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span> <span class="st">"log response ratio (lnRR)"</span>, </span>
<span id="cb99-832"><a href="#cb99-832" aria-hidden="true" tabindex="-1"></a>              <span class="at">flip =</span> <span class="cn">FALSE</span>)  <span class="sc">+</span></span>
<span id="cb99-833"><a href="#cb99-833" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb99-834"><a href="#cb99-834" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)<span class="sc">+</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb99-835"><a href="#cb99-835" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span> ))</span>
<span id="cb99-836"><a href="#cb99-836" aria-hidden="true" tabindex="-1"></a>orchard_exposure</span>
<span id="cb99-837"><a href="#cb99-837" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-838"><a href="#cb99-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-841"><a href="#cb99-841" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-842"><a href="#cb99-842" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: save-figure_exposure</span></span>
<span id="cb99-843"><a href="#cb99-843" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb99-844"><a href="#cb99-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-845"><a href="#cb99-845" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_exposure_lnRR.pdf"</span>),</span>
<span id="cb99-846"><a href="#cb99-846" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_exposure,</span>
<span id="cb99-847"><a href="#cb99-847" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb99-848"><a href="#cb99-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-849"><a href="#cb99-849" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_exposure_lnRR.jpg"</span>),</span>
<span id="cb99-850"><a href="#cb99-850" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_exposure,</span>
<span id="cb99-851"><a href="#cb99-851" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">9</span>,  </span>
<span id="cb99-852"><a href="#cb99-852" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">7</span>,  </span>
<span id="cb99-853"><a href="#cb99-853" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb99-854"><a href="#cb99-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-855"><a href="#cb99-855" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-856"><a href="#cb99-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-857"><a href="#cb99-857" aria-hidden="true" tabindex="-1"></a>Contrasts between levels</span>
<span id="cb99-858"><a href="#cb99-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-861"><a href="#cb99-861" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-862"><a href="#cb99-862" aria-hidden="true" tabindex="-1"></a>LEVELS <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Acute"</span>, <span class="st">"Medium"</span>, <span class="st">"Short"</span>)</span>
<span id="cb99-863"><a href="#cb99-863" aria-hidden="true" tabindex="-1"></a>MOD_NAME <span class="ot">&lt;-</span> <span class="st">"Music_exposure_duration"</span></span>
<span id="cb99-864"><a href="#cb99-864" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-865"><a href="#cb99-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-868"><a href="#cb99-868" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-869"><a href="#cb99-869" aria-hidden="true" tabindex="-1"></a><span class="co"># Model A: Reference = Acute (A vs B, A vs C)</span></span>
<span id="cb99-870"><a href="#cb99-870" aria-hidden="true" tabindex="-1"></a>db_filtered<span class="sc">$</span>moderator_relevel_A <span class="ot">&lt;-</span> <span class="fu">relevel</span>(db_filtered<span class="sc">$</span>Music_exposure_duration, <span class="at">ref =</span> LEVELS[<span class="dv">1</span>])</span>
<span id="cb99-871"><a href="#cb99-871" aria-hidden="true" tabindex="-1"></a>model_A <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-872"><a href="#cb99-872" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb99-873"><a href="#cb99-873" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mods =</span> <span class="sc">~</span> moderator_relevel_A,</span>
<span id="cb99-874"><a href="#cb99-874" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-875"><a href="#cb99-875" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>, <span class="at">method =</span> <span class="st">"REML"</span>, <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-876"><a href="#cb99-876" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb99-877"><a href="#cb99-877" aria-hidden="true" tabindex="-1"></a>model_A</span>
<span id="cb99-878"><a href="#cb99-878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-879"><a href="#cb99-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-882"><a href="#cb99-882" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-883"><a href="#cb99-883" aria-hidden="true" tabindex="-1"></a><span class="co"># Model B: Reference = Medium (B vs C)</span></span>
<span id="cb99-884"><a href="#cb99-884" aria-hidden="true" tabindex="-1"></a>db_filtered<span class="sc">$</span>moderator_relevel_B <span class="ot">&lt;-</span> <span class="fu">relevel</span>(db_filtered<span class="sc">$</span>Music_exposure_duration, <span class="at">ref =</span> LEVELS[<span class="dv">2</span>])</span>
<span id="cb99-885"><a href="#cb99-885" aria-hidden="true" tabindex="-1"></a>model_B <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-886"><a href="#cb99-886" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb99-887"><a href="#cb99-887" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mods =</span> <span class="sc">~</span> moderator_relevel_B,</span>
<span id="cb99-888"><a href="#cb99-888" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-889"><a href="#cb99-889" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>, <span class="at">method =</span> <span class="st">"REML"</span>, <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-890"><a href="#cb99-890" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb99-891"><a href="#cb99-891" aria-hidden="true" tabindex="-1"></a>model_B</span>
<span id="cb99-892"><a href="#cb99-892" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-893"><a href="#cb99-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-896"><a href="#cb99-896" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-897"><a href="#cb99-897" aria-hidden="true" tabindex="-1"></a><span class="co"># Model C: Reference = Short (C estimate)</span></span>
<span id="cb99-898"><a href="#cb99-898" aria-hidden="true" tabindex="-1"></a>db_filtered<span class="sc">$</span>moderator_relevel_C <span class="ot">&lt;-</span> <span class="fu">relevel</span>(db_filtered<span class="sc">$</span>Music_exposure_duration, <span class="at">ref =</span> LEVELS[<span class="dv">3</span>])</span>
<span id="cb99-899"><a href="#cb99-899" aria-hidden="true" tabindex="-1"></a>model_C <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-900"><a href="#cb99-900" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb99-901"><a href="#cb99-901" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mods =</span> <span class="sc">~</span> moderator_relevel_C,</span>
<span id="cb99-902"><a href="#cb99-902" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-903"><a href="#cb99-903" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>, <span class="at">method =</span> <span class="st">"REML"</span>, <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-904"><a href="#cb99-904" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb99-905"><a href="#cb99-905" aria-hidden="true" tabindex="-1"></a>model_C</span>
<span id="cb99-906"><a href="#cb99-906" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-907"><a href="#cb99-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-908"><a href="#cb99-908" aria-hidden="true" tabindex="-1"></a><span class="fu">## 6. Experimental design</span></span>
<span id="cb99-909"><a href="#cb99-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-912"><a href="#cb99-912" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-913"><a href="#cb99-913" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_experimental_design</span></span>
<span id="cb99-914"><a href="#cb99-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-915"><a href="#cb99-915" aria-hidden="true" tabindex="-1"></a>mEXD <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-916"><a href="#cb99-916" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb99-917"><a href="#cb99-917" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Experimental_design<span class="dv">-1</span>,</span>
<span id="cb99-918"><a href="#cb99-918" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb99-919"><a href="#cb99-919" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb99-920"><a href="#cb99-920" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-921"><a href="#cb99-921" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-922"><a href="#cb99-922" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb99-923"><a href="#cb99-923" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-924"><a href="#cb99-924" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb99-925"><a href="#cb99-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-926"><a href="#cb99-926" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mEXD)</span>
<span id="cb99-927"><a href="#cb99-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-928"><a href="#cb99-928" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-929"><a href="#cb99-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-932"><a href="#cb99-932" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-933"><a href="#cb99-933" aria-hidden="true" tabindex="-1"></a>r2EXD <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mEXD), <span class="dv">4</span>)</span>
<span id="cb99-934"><a href="#cb99-934" aria-hidden="true" tabindex="-1"></a>r2EXD</span>
<span id="cb99-935"><a href="#cb99-935" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-936"><a href="#cb99-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-939"><a href="#cb99-939" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-940"><a href="#cb99-940" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: orchard_experimental_design</span></span>
<span id="cb99-941"><a href="#cb99-941" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb99-942"><a href="#cb99-942" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb99-943"><a href="#cb99-943" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb99-944"><a href="#cb99-944" aria-hidden="true" tabindex="-1"></a>orchard_design<span class="ot">&lt;-</span><span class="fu">orchard_plot</span>(mEXD,</span>
<span id="cb99-945"><a href="#cb99-945" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Experimental_design"</span>,</span>
<span id="cb99-946"><a href="#cb99-946" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb99-947"><a href="#cb99-947" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span> <span class="st">"log response ratio (lnRR)"</span>, </span>
<span id="cb99-948"><a href="#cb99-948" aria-hidden="true" tabindex="-1"></a>              <span class="at">flip=</span><span class="cn">FALSE</span>) <span class="sc">+</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb99-949"><a href="#cb99-949" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span> ))</span>
<span id="cb99-950"><a href="#cb99-950" aria-hidden="true" tabindex="-1"></a>orchard_design</span>
<span id="cb99-951"><a href="#cb99-951" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-952"><a href="#cb99-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-955"><a href="#cb99-955" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-956"><a href="#cb99-956" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: save-figure_design</span></span>
<span id="cb99-957"><a href="#cb99-957" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb99-958"><a href="#cb99-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-959"><a href="#cb99-959" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_design_lnRR.pdf"</span>),</span>
<span id="cb99-960"><a href="#cb99-960" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_design,</span>
<span id="cb99-961"><a href="#cb99-961" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb99-962"><a href="#cb99-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-963"><a href="#cb99-963" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_design_lnRR.jpg"</span>),</span>
<span id="cb99-964"><a href="#cb99-964" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_design,</span>
<span id="cb99-965"><a href="#cb99-965" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">9</span>,  </span>
<span id="cb99-966"><a href="#cb99-966" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">7</span>,  </span>
<span id="cb99-967"><a href="#cb99-967" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb99-968"><a href="#cb99-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-969"><a href="#cb99-969" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-970"><a href="#cb99-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-971"><a href="#cb99-971" aria-hidden="true" tabindex="-1"></a>Contrasts between levels</span>
<span id="cb99-972"><a href="#cb99-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-975"><a href="#cb99-975" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-976"><a href="#cb99-976" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: music_genre_contrasts</span></span>
<span id="cb99-977"><a href="#cb99-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-978"><a href="#cb99-978" aria-hidden="true" tabindex="-1"></a><span class="co"># The Generator</span></span>
<span id="cb99-979"><a href="#cb99-979" aria-hidden="true" tabindex="-1"></a>contra_mEXD <span class="ot">&lt;-</span> <span class="fu">contrast_fun</span>(<span class="at">data =</span> db, </span>
<span id="cb99-980"><a href="#cb99-980" aria-hidden="true" tabindex="-1"></a>                          <span class="at">response =</span> lnRR, </span>
<span id="cb99-981"><a href="#cb99-981" aria-hidden="true" tabindex="-1"></a>                          <span class="at">moderator =</span> Experimental_design, </span>
<span id="cb99-982"><a href="#cb99-982" aria-hidden="true" tabindex="-1"></a>                          <span class="at">VCV =</span> VCV)</span>
<span id="cb99-983"><a href="#cb99-983" aria-hidden="true" tabindex="-1"></a><span class="co"># The Harvester</span></span>
<span id="cb99-984"><a href="#cb99-984" aria-hidden="true" tabindex="-1"></a>t1<span class="ot">&lt;-</span><span class="fu">get_estimate</span>(<span class="at">model =</span> mEXD, <span class="at">contra =</span> contra_mEXD, <span class="at">moderator =</span> Experimental_design)</span>
<span id="cb99-985"><a href="#cb99-985" aria-hidden="true" tabindex="-1"></a><span class="co"># The Cleaner</span></span>
<span id="cb99-986"><a href="#cb99-986" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">clean_unique_contrasts</span>(<span class="at">full_results_table =</span> t1, <span class="at">level_count =</span> <span class="dv">3</span>)</span>
<span id="cb99-987"><a href="#cb99-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-988"><a href="#cb99-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-989"><a href="#cb99-989" aria-hidden="true" tabindex="-1"></a>t2</span>
<span id="cb99-990"><a href="#cb99-990" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-991"><a href="#cb99-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-992"><a href="#cb99-992" aria-hidden="true" tabindex="-1"></a><span class="fu">## 7. Induced behaviour</span></span>
<span id="cb99-993"><a href="#cb99-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-996"><a href="#cb99-996" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-997"><a href="#cb99-997" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_induced_behaviour</span></span>
<span id="cb99-998"><a href="#cb99-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-999"><a href="#cb99-999" aria-hidden="true" tabindex="-1"></a>mIB <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-1000"><a href="#cb99-1000" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb99-1001"><a href="#cb99-1001" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Induced behaviour</span><span class="st">`</span><span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb99-1002"><a href="#cb99-1002" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb99-1003"><a href="#cb99-1003" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb99-1004"><a href="#cb99-1004" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-1005"><a href="#cb99-1005" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-1006"><a href="#cb99-1006" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb99-1007"><a href="#cb99-1007" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-1008"><a href="#cb99-1008" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb99-1009"><a href="#cb99-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1010"><a href="#cb99-1010" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mIB)</span>
<span id="cb99-1011"><a href="#cb99-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1012"><a href="#cb99-1012" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1013"><a href="#cb99-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1016"><a href="#cb99-1016" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1017"><a href="#cb99-1017" aria-hidden="true" tabindex="-1"></a>r2IB <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mIB), <span class="dv">4</span>)</span>
<span id="cb99-1018"><a href="#cb99-1018" aria-hidden="true" tabindex="-1"></a>r2IB</span>
<span id="cb99-1019"><a href="#cb99-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1020"><a href="#cb99-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1023"><a href="#cb99-1023" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1024"><a href="#cb99-1024" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: orchard_INDUCED_BEHAVIOUR</span></span>
<span id="cb99-1025"><a href="#cb99-1025" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb99-1026"><a href="#cb99-1026" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb99-1027"><a href="#cb99-1027" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb99-1028"><a href="#cb99-1028" aria-hidden="true" tabindex="-1"></a>orchard_behaviour<span class="ot">&lt;-</span><span class="fu">orchard_plot</span>(mIB,</span>
<span id="cb99-1029"><a href="#cb99-1029" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Induced behaviour"</span>,</span>
<span id="cb99-1030"><a href="#cb99-1030" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb99-1031"><a href="#cb99-1031" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span> <span class="st">"log response ratio (lnRR)"</span>, </span>
<span id="cb99-1032"><a href="#cb99-1032" aria-hidden="true" tabindex="-1"></a>              <span class="at">flip =</span> <span class="cn">FALSE</span>) <span class="sc">+</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb99-1033"><a href="#cb99-1033" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span> ))</span>
<span id="cb99-1034"><a href="#cb99-1034" aria-hidden="true" tabindex="-1"></a>orchard_behaviour</span>
<span id="cb99-1035"><a href="#cb99-1035" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1036"><a href="#cb99-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1039"><a href="#cb99-1039" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1040"><a href="#cb99-1040" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: save-figure_behaviour</span></span>
<span id="cb99-1041"><a href="#cb99-1041" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb99-1042"><a href="#cb99-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1043"><a href="#cb99-1043" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_behaviour_lnRR.pdf"</span>),</span>
<span id="cb99-1044"><a href="#cb99-1044" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_behaviour,</span>
<span id="cb99-1045"><a href="#cb99-1045" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb99-1046"><a href="#cb99-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1047"><a href="#cb99-1047" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">".."</span>,<span class="st">"Plots"</span>, <span class="st">"orchard_behaviour_lnRR.jpg"</span>),</span>
<span id="cb99-1048"><a href="#cb99-1048" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> orchard_behaviour,</span>
<span id="cb99-1049"><a href="#cb99-1049" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">9</span>,  </span>
<span id="cb99-1050"><a href="#cb99-1050" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">7</span>,  </span>
<span id="cb99-1051"><a href="#cb99-1051" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb99-1052"><a href="#cb99-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1053"><a href="#cb99-1053" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1054"><a href="#cb99-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1057"><a href="#cb99-1057" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1058"><a href="#cb99-1058" aria-hidden="true" tabindex="-1"></a>mIB <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-1059"><a href="#cb99-1059" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb99-1060"><a href="#cb99-1060" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Induced behaviour</span><span class="st">`</span>,</span>
<span id="cb99-1061"><a href="#cb99-1061" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb99-1062"><a href="#cb99-1062" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb99-1063"><a href="#cb99-1063" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-1064"><a href="#cb99-1064" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-1065"><a href="#cb99-1065" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb99-1066"><a href="#cb99-1066" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-1067"><a href="#cb99-1067" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb99-1068"><a href="#cb99-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1069"><a href="#cb99-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mIB)</span>
<span id="cb99-1070"><a href="#cb99-1070" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1071"><a href="#cb99-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1072"><a href="#cb99-1072" aria-hidden="true" tabindex="-1"></a><span class="fu">## 8. Relative timing</span></span>
<span id="cb99-1073"><a href="#cb99-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1076"><a href="#cb99-1076" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1077"><a href="#cb99-1077" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model+_relative_timing</span></span>
<span id="cb99-1078"><a href="#cb99-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1079"><a href="#cb99-1079" aria-hidden="true" tabindex="-1"></a>mRT <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-1080"><a href="#cb99-1080" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb99-1081"><a href="#cb99-1081" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Relative_timing<span class="dv">-1</span>,</span>
<span id="cb99-1082"><a href="#cb99-1082" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb99-1083"><a href="#cb99-1083" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb99-1084"><a href="#cb99-1084" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-1085"><a href="#cb99-1085" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-1086"><a href="#cb99-1086" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb99-1087"><a href="#cb99-1087" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-1088"><a href="#cb99-1088" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb99-1089"><a href="#cb99-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1090"><a href="#cb99-1090" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mRT)</span>
<span id="cb99-1091"><a href="#cb99-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1092"><a href="#cb99-1092" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1093"><a href="#cb99-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1096"><a href="#cb99-1096" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1097"><a href="#cb99-1097" aria-hidden="true" tabindex="-1"></a>r2RT <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mRT), <span class="dv">4</span>)</span>
<span id="cb99-1098"><a href="#cb99-1098" aria-hidden="true" tabindex="-1"></a>r2RT</span>
<span id="cb99-1099"><a href="#cb99-1099" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1100"><a href="#cb99-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1103"><a href="#cb99-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1104"><a href="#cb99-1104" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: orchard_relative_timing</span></span>
<span id="cb99-1105"><a href="#cb99-1105" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb99-1106"><a href="#cb99-1106" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb99-1107"><a href="#cb99-1107" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb99-1108"><a href="#cb99-1108" aria-hidden="true" tabindex="-1"></a><span class="fu">orchard_plot</span>(mRT,</span>
<span id="cb99-1109"><a href="#cb99-1109" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Relative_timing"</span>,</span>
<span id="cb99-1110"><a href="#cb99-1110" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb99-1111"><a href="#cb99-1111" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span> <span class="st">"log response ratio (lnRR)"</span>, </span>
<span id="cb99-1112"><a href="#cb99-1112" aria-hidden="true" tabindex="-1"></a>              <span class="at">angle =</span> <span class="dv">30</span>) </span>
<span id="cb99-1113"><a href="#cb99-1113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1114"><a href="#cb99-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1117"><a href="#cb99-1117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1118"><a href="#cb99-1118" aria-hidden="true" tabindex="-1"></a>mRT <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-1119"><a href="#cb99-1119" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb99-1120"><a href="#cb99-1120" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Relative_timing,</span>
<span id="cb99-1121"><a href="#cb99-1121" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb99-1122"><a href="#cb99-1122" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb99-1123"><a href="#cb99-1123" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-1124"><a href="#cb99-1124" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-1125"><a href="#cb99-1125" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb99-1126"><a href="#cb99-1126" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-1127"><a href="#cb99-1127" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb99-1128"><a href="#cb99-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1129"><a href="#cb99-1129" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mRT)</span>
<span id="cb99-1130"><a href="#cb99-1130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1131"><a href="#cb99-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1132"><a href="#cb99-1132" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9. Experimental procedures</span></span>
<span id="cb99-1133"><a href="#cb99-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1136"><a href="#cb99-1136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1137"><a href="#cb99-1137" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_Experimental_procedures</span></span>
<span id="cb99-1138"><a href="#cb99-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1139"><a href="#cb99-1139" aria-hidden="true" tabindex="-1"></a>mEXP <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-1140"><a href="#cb99-1140" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb99-1141"><a href="#cb99-1141" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Experimental_procedures<span class="dv">-1</span>,</span>
<span id="cb99-1142"><a href="#cb99-1142" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb99-1143"><a href="#cb99-1143" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb99-1144"><a href="#cb99-1144" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-1145"><a href="#cb99-1145" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-1146"><a href="#cb99-1146" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb99-1147"><a href="#cb99-1147" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-1148"><a href="#cb99-1148" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb99-1149"><a href="#cb99-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1150"><a href="#cb99-1150" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mEXP)</span>
<span id="cb99-1151"><a href="#cb99-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1152"><a href="#cb99-1152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1153"><a href="#cb99-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1156"><a href="#cb99-1156" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1157"><a href="#cb99-1157" aria-hidden="true" tabindex="-1"></a>r2EXP <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mEXP), <span class="dv">4</span>)</span>
<span id="cb99-1158"><a href="#cb99-1158" aria-hidden="true" tabindex="-1"></a>r2EXP</span>
<span id="cb99-1159"><a href="#cb99-1159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1160"><a href="#cb99-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1163"><a href="#cb99-1163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1164"><a href="#cb99-1164" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: orchard_experimental_procedures</span></span>
<span id="cb99-1165"><a href="#cb99-1165" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb99-1166"><a href="#cb99-1166" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb99-1167"><a href="#cb99-1167" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb99-1168"><a href="#cb99-1168" aria-hidden="true" tabindex="-1"></a><span class="fu">orchard_plot</span>(mEXP,</span>
<span id="cb99-1169"><a href="#cb99-1169" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Experimental_procedures"</span>,</span>
<span id="cb99-1170"><a href="#cb99-1170" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb99-1171"><a href="#cb99-1171" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span> <span class="st">"log response ratio (lnRR)"</span>, </span>
<span id="cb99-1172"><a href="#cb99-1172" aria-hidden="true" tabindex="-1"></a>              <span class="at">angle =</span> <span class="dv">30</span>) </span>
<span id="cb99-1173"><a href="#cb99-1173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1174"><a href="#cb99-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1177"><a href="#cb99-1177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1178"><a href="#cb99-1178" aria-hidden="true" tabindex="-1"></a>mEXP <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-1179"><a href="#cb99-1179" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb99-1180"><a href="#cb99-1180" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Experimental_procedures,</span>
<span id="cb99-1181"><a href="#cb99-1181" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb99-1182"><a href="#cb99-1182" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb99-1183"><a href="#cb99-1183" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-1184"><a href="#cb99-1184" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-1185"><a href="#cb99-1185" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb99-1186"><a href="#cb99-1186" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-1187"><a href="#cb99-1187" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb99-1188"><a href="#cb99-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1189"><a href="#cb99-1189" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mEXP)</span>
<span id="cb99-1190"><a href="#cb99-1190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1191"><a href="#cb99-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1192"><a href="#cb99-1192" aria-hidden="true" tabindex="-1"></a><span class="fu">## 10. Control condition</span></span>
<span id="cb99-1193"><a href="#cb99-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1196"><a href="#cb99-1196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1197"><a href="#cb99-1197" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_control_condition</span></span>
<span id="cb99-1198"><a href="#cb99-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1199"><a href="#cb99-1199" aria-hidden="true" tabindex="-1"></a>mCC <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-1200"><a href="#cb99-1200" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb99-1201"><a href="#cb99-1201" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Control_conditions<span class="dv">-1</span>,</span>
<span id="cb99-1202"><a href="#cb99-1202" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb99-1203"><a href="#cb99-1203" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb99-1204"><a href="#cb99-1204" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-1205"><a href="#cb99-1205" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-1206"><a href="#cb99-1206" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb99-1207"><a href="#cb99-1207" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-1208"><a href="#cb99-1208" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb99-1209"><a href="#cb99-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1210"><a href="#cb99-1210" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mCC)</span>
<span id="cb99-1211"><a href="#cb99-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1212"><a href="#cb99-1212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1213"><a href="#cb99-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1216"><a href="#cb99-1216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1217"><a href="#cb99-1217" aria-hidden="true" tabindex="-1"></a>r2CC <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mCC), <span class="dv">4</span>)</span>
<span id="cb99-1218"><a href="#cb99-1218" aria-hidden="true" tabindex="-1"></a>r2CC</span>
<span id="cb99-1219"><a href="#cb99-1219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1220"><a href="#cb99-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1223"><a href="#cb99-1223" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1224"><a href="#cb99-1224" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: orchard_control_condition</span></span>
<span id="cb99-1225"><a href="#cb99-1225" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb99-1226"><a href="#cb99-1226" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb99-1227"><a href="#cb99-1227" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb99-1228"><a href="#cb99-1228" aria-hidden="true" tabindex="-1"></a><span class="fu">orchard_plot</span>(mCC,</span>
<span id="cb99-1229"><a href="#cb99-1229" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Control_conditions"</span>,</span>
<span id="cb99-1230"><a href="#cb99-1230" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb99-1231"><a href="#cb99-1231" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span> <span class="st">"log response ratio (lnRR)"</span>, </span>
<span id="cb99-1232"><a href="#cb99-1232" aria-hidden="true" tabindex="-1"></a>              <span class="at">angle =</span> <span class="dv">30</span>) </span>
<span id="cb99-1233"><a href="#cb99-1233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1234"><a href="#cb99-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1237"><a href="#cb99-1237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1238"><a href="#cb99-1238" aria-hidden="true" tabindex="-1"></a>mCC <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-1239"><a href="#cb99-1239" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV, </span>
<span id="cb99-1240"><a href="#cb99-1240" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Control_conditions,</span>
<span id="cb99-1241"><a href="#cb99-1241" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb99-1242"><a href="#cb99-1242" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb99-1243"><a href="#cb99-1243" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-1244"><a href="#cb99-1244" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-1245"><a href="#cb99-1245" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb99-1246"><a href="#cb99-1246" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-1247"><a href="#cb99-1247" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db)</span>
<span id="cb99-1248"><a href="#cb99-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1249"><a href="#cb99-1249" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mCC)</span>
<span id="cb99-1250"><a href="#cb99-1250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1251"><a href="#cb99-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1252"><a href="#cb99-1252" aria-hidden="true" tabindex="-1"></a><span class="fu">## 11. Assay type</span></span>
<span id="cb99-1253"><a href="#cb99-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1256"><a href="#cb99-1256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1257"><a href="#cb99-1257" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Identify and Filter Low-K Levels</span></span>
<span id="cb99-1258"><a href="#cb99-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1259"><a href="#cb99-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1260"><a href="#cb99-1260" aria-hidden="true" tabindex="-1"></a>k_counts <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb99-1261"><a href="#cb99-1261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Assay_type) <span class="sc">%&gt;%</span></span>
<span id="cb99-1262"><a href="#cb99-1262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">k_es =</span> <span class="fu">n</span>())</span>
<span id="cb99-1263"><a href="#cb99-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1264"><a href="#cb99-1264" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the levels to keep (where k_es &gt;= 5)</span></span>
<span id="cb99-1265"><a href="#cb99-1265" aria-hidden="true" tabindex="-1"></a>levels_to_keep <span class="ot">&lt;-</span> k_counts <span class="sc">%&gt;%</span></span>
<span id="cb99-1266"><a href="#cb99-1266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(k_es <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-1267"><a href="#cb99-1267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Assay_type)</span>
<span id="cb99-1268"><a href="#cb99-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1269"><a href="#cb99-1269" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Create the Filtered Data Frame</span></span>
<span id="cb99-1270"><a href="#cb99-1270" aria-hidden="true" tabindex="-1"></a>db_filtered <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span></span>
<span id="cb99-1271"><a href="#cb99-1271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Assay_type <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb99-1272"><a href="#cb99-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1273"><a href="#cb99-1273" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Subset the VCV Matrix (CRITICAL STEP)</span></span>
<span id="cb99-1274"><a href="#cb99-1274" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumes VCV matrix rows/columns match the original 'db' data frame indices.</span></span>
<span id="cb99-1275"><a href="#cb99-1275" aria-hidden="true" tabindex="-1"></a>indices_to_keep <span class="ot">&lt;-</span> <span class="fu">which</span>(db<span class="sc">$</span>Assay_type <span class="sc">%in%</span> levels_to_keep)</span>
<span id="cb99-1276"><a href="#cb99-1276" aria-hidden="true" tabindex="-1"></a>VCV_filtered <span class="ot">&lt;-</span> VCV[indices_to_keep, indices_to_keep]</span>
<span id="cb99-1277"><a href="#cb99-1277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1278"><a href="#cb99-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1281"><a href="#cb99-1281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1282"><a href="#cb99-1282" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_assay_type</span></span>
<span id="cb99-1283"><a href="#cb99-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1284"><a href="#cb99-1284" aria-hidden="true" tabindex="-1"></a>mAT <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-1285"><a href="#cb99-1285" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb99-1286"><a href="#cb99-1286" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Assay_type<span class="dv">-1</span>,</span>
<span id="cb99-1287"><a href="#cb99-1287" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb99-1288"><a href="#cb99-1288" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb99-1289"><a href="#cb99-1289" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-1290"><a href="#cb99-1290" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-1291"><a href="#cb99-1291" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb99-1292"><a href="#cb99-1292" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-1293"><a href="#cb99-1293" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb99-1294"><a href="#cb99-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1295"><a href="#cb99-1295" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mAT)</span>
<span id="cb99-1296"><a href="#cb99-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1297"><a href="#cb99-1297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1298"><a href="#cb99-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1301"><a href="#cb99-1301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1302"><a href="#cb99-1302" aria-hidden="true" tabindex="-1"></a>r2AT <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">r2_ml</span>(mAT), <span class="dv">4</span>)</span>
<span id="cb99-1303"><a href="#cb99-1303" aria-hidden="true" tabindex="-1"></a>r2AT</span>
<span id="cb99-1304"><a href="#cb99-1304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1305"><a href="#cb99-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1308"><a href="#cb99-1308" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1309"><a href="#cb99-1309" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: orchard_assay_type</span></span>
<span id="cb99-1310"><a href="#cb99-1310" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb99-1311"><a href="#cb99-1311" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb99-1312"><a href="#cb99-1312" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb99-1313"><a href="#cb99-1313" aria-hidden="true" tabindex="-1"></a><span class="fu">orchard_plot</span>(mAT,</span>
<span id="cb99-1314"><a href="#cb99-1314" aria-hidden="true" tabindex="-1"></a>             <span class="at">mod =</span> <span class="st">"Assay_type"</span>,</span>
<span id="cb99-1315"><a href="#cb99-1315" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> <span class="st">"Study_ID"</span>,</span>
<span id="cb99-1316"><a href="#cb99-1316" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span> <span class="st">"log response ratio (lnRR)"</span>, </span>
<span id="cb99-1317"><a href="#cb99-1317" aria-hidden="true" tabindex="-1"></a>              <span class="at">angle =</span> <span class="dv">30</span>) </span>
<span id="cb99-1318"><a href="#cb99-1318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1319"><a href="#cb99-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1322"><a href="#cb99-1322" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb99-1323"><a href="#cb99-1323" aria-hidden="true" tabindex="-1"></a>mAT <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR,</span>
<span id="cb99-1324"><a href="#cb99-1324" aria-hidden="true" tabindex="-1"></a>                  <span class="at">V =</span> VCV_filtered, </span>
<span id="cb99-1325"><a href="#cb99-1325" aria-hidden="true" tabindex="-1"></a>              <span class="at">mods =</span> <span class="sc">~</span> Assay_type,</span>
<span id="cb99-1326"><a href="#cb99-1326" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Study_ID,</span>
<span id="cb99-1327"><a href="#cb99-1327" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> ES_ID, </span>
<span id="cb99-1328"><a href="#cb99-1328" aria-hidden="true" tabindex="-1"></a>                                <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Strain),</span>
<span id="cb99-1329"><a href="#cb99-1329" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-1330"><a href="#cb99-1330" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"REML"</span>, </span>
<span id="cb99-1331"><a href="#cb99-1331" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sparse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-1332"><a href="#cb99-1332" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> db_filtered)</span>
<span id="cb99-1333"><a href="#cb99-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-1334"><a href="#cb99-1334" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mAT)</span>
<span id="cb99-1335"><a href="#cb99-1335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb99-1336"><a href="#cb99-1336" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>