~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Meta_genre +
Music_exposure_duration +
Relative_timing +
Experimental_procedures +
Control_conditions
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Meta_genre +
Music_exposure_duration +
Experimental_design +
Experimental_procedures +
Control_conditions
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Meta_genre +
Music_exposure_duration +
Experimental_design +
Relative_timing +
Control_conditions
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Meta_genre +
Music_exposure_duration +
Experimental_design +
Relative_timing +
Experimental_procedures
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Meta_genre +
Experimental_design +
Relative_timing +
Experimental_procedures +
Control_conditions
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
summary(mMULTI)
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Meta_genre +
Experimental_design +
Relative_timing +
Experimental_procedures +
Control_conditions
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Experimental_design +
Relative_timing +
Experimental_procedures +
Control_conditions
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Meta_genre +
Relative_timing +
Experimental_procedures +
Control_conditions
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Meta_genre +
Experimental_design +
Experimental_procedures +
Control_conditions
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Meta_genre +
Experimental_design +
Relative_timing +
Control_conditions
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Meta_genre +
Experimental_design +
Relative_timing +
Experimental_procedures
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Meta_genre +
Experimental_design +
Relative_timing +
Control_conditions
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Experimental_design +
Relative_timing +
Control_conditions
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Meta_genre +
Relative_timing +
Control_conditions
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Meta_genre +
Experimental_design +
Control_conditions
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Meta_genre +
Experimental_design +
Relative_timing
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Experimental_design +
Relative_timing +
Control_conditions
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
summary(mMULTI)
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Meta_genre +
Experimental_design +
Control_conditions
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
summary(mMULTI)
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Meta_genre +
Experimental_design +
Relative_timing +
Control_conditions
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
summary(mMULTI)
r2MULTI <- round(r2_ml(mMULTI), 4)
r2MULTI
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Meta_genre +
Experimental_design +
Relative_timing +
Control_conditions-1
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
summary(mMULTI)
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Meta_genre +
Experimental_design +
Relative_timing +
Control_conditions
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
summary(mMULTI)
mMULTI<- rma.mv(yi = lnRR,
V = VCV_final,
mods = ~   Lifestage_exposure +
Assay_type+
`Induced behaviour` +
Sex +
Meta_genre +
Experimental_design +
Relative_timing +
Control_conditions-1
,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db_final)
summary(mMULTI)
#| label: setup
#| include: false
pacman::p_load(
DT,
dtplyr,
here,
knitr,
tidyverse,
patchwork,
metafor,
orchaRd
)
#| label: load_and_clean_data
db <- readr::read_csv(here("data","db_lnRR.csv")) %>%
mutate(across(c(C_n, Ex_n, C_mean, Ex_mean, C_SE, Ex_SE, C_SD, Ex_SD), as.numeric))%>%
mutate(across(where(is.character), as.factor))
VCV <- metafor::vcalc(
vi = lnRR_var,
cluster = Cohort_ID, # The clustering variable (Study_ID + Ex_ID)
obs = ES_ID,         # The unique observation/effect size ID
rho = 0.5,           # Assumed correlation between outcomes from the same cohort
data = db
)
#| label: multilevel_meta_analysis
ma_all <- rma.mv(yi = lnRR,
V = VCV,
random = list(~1 | Study_ID,
~1 | Cohort_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db)
summary(ma_all)
#| label: i2_extraction
orchaRd::i2_ml(ma_all)
#| label: r2_extraction
r2 <- round(r2_ml(ma_all), 4)
r2
#| label: r2_extraction
r2 <- round(r2_ml(ma_all), 4)
r2
#| label: refit_model
ma_all <- rma.mv(yi = lnRR,
V = VCV,
random = list(~1 | Study_ID,
~1 | ES_ID,
~1 | Strain),
test = "t",
method = "REML",
sparse = TRUE,
data = db)
summary(ma_all)
#| label: i2_extraction2
orchaRd::i2_ml(ma_all)
#| label: orchard_plot
#| fig-width: 6
#| fig-height: 4
#| warning: false
orchard_plot(ma_all,
group = "Study_ID",
xlab = "log response ratio (lnRR)",
angle = 45) +
scale_x_discrete(labels = c("Overall effect"))
exp(0.2058)
